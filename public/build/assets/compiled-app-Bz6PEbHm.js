leantime.clientsController=function(){var r=function(){jQuery(".projectDateFrom, .projectDateTo").datepicker({dateFormat:leantime.i18n.__("language.dateformat"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader")})},n=function(){jQuery(".clientTabs").tabs()},d=function(){document.addEventListener("DOMContentLoaded",function(){jQuery("#allClientsTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")}},dom:'<"top">rt<"bottom"ilp><"clear">',searching:!1,displayLength:100})})};return{initDates:r,initClientTabs:n,initClientTable:d}}();leantime.canvasController=function(){var r="",n=function(i){r=i},d=function(){window.addEventListener("load",function(){document.querySelectorAll(".loading").forEach(function(i){i.style.display="none"}),document.querySelectorAll(".filterBar .row-fluid").forEach(function(i){i.style.opacity="1"})})},u=function(){jQuery(".addCanvasLink").nyroModal(),document.querySelectorAll(".editCanvasLink").forEach(function(i){i.addEventListener("click",function(){jQuery("#editCanvas").modal("show")})}),document.querySelectorAll(".cloneCanvasLink").forEach(function(i){i.addEventListener("click",function(){jQuery("#cloneCanvas").modal("show")})}),document.querySelectorAll(".mergeCanvasLink").forEach(function(i){i.addEventListener("click",function(){jQuery("#mergeCanvas").modal("show")})}),document.querySelectorAll(".importCanvasLink").forEach(function(i){i.addEventListener("click",function(){jQuery("#importCanvas").modal("show")})})},e=!1,t={sizes:{minW:700,minH:1e3},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(i){i.style.display=""}),e==!0&&(e=!1,location.reload())},afterShowCont:function(){window.htmx.process("#global-modal-content"),jQuery("."+r+"CanvasModal, #commentForm, #commentForm .deleteComment, ."+r+"CanvasMilestone .deleteMilestone").nyroModal(t)},beforeClose:function(){location.reload()}},titleFromIframe:!0},m=function(){jQuery("."+r+"CanvasModal, #commentForm, #commentForm .deleteComment, ."+r+"CanvasMilestone .deleteMilestone").nyroModal(t)},s=function(i){jQuery.nmManual(i,t)},a=function(i){if(i=="existing"){document.querySelectorAll("#newMilestone, #milestoneSelectors").forEach(function(S){S.style.display="none"});var o=document.getElementById("existingMilestone");o&&(o.style.display=""),m()}if(i=="new"){var f=document.getElementById("newMilestone");f&&(f.style.display=""),document.querySelectorAll("#existingMilestone, #milestoneSelectors").forEach(function(S){S.style.display="none"}),m()}if(i=="hide"){document.querySelectorAll("#newMilestone, #existingMilestone").forEach(function(S){S.style.display="none"});var T=document.getElementById("milestoneSelectors");T&&(T.style.display="")}},l=function(){e=!0},c=function(){document.body.addEventListener("click",function(i){var o=i.target.closest(".userDropdown .dropdown-menu a");if(o){var f=o.getAttribute("data-value").split("_");if(o.getAttribute("data-label"),f.length==3){var T=f[0],S=f[1];f[2],fetch(leantime.appUrl+"/api/"+r+"canvas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:T,author:S})}).then(function(){var w=document.querySelector("#userDropdownMenuLink"+T+" span.text span#userImage"+T+" img");w&&w.setAttribute("src",leantime.appUrl+"/api/users?profileImage="+S),leantime.toast.show({message:leantime.i18n.__("short_notifications.user_updated"),style:"success"})})}}})},h=function(){document.body.addEventListener("click",function(i){var o=i.target.closest(".statusDropdown .dropdown-menu a");if(o){var f=o.getAttribute("data-value").split("/"),T=o.getAttribute("data-label");if(f.length==2){var S=f[0],w=f[1],D=o.getAttribute("class");fetch(leantime.appUrl+"/api/"+r+"canvas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:S,status:w})}).then(function(){var y=document.querySelector("#statusDropdownMenuLink"+S+" span.text");y&&(y.textContent=T);var C=document.getElementById("statusDropdownMenuLink"+S);C&&(C.className=D+" dropdown-toggle f-left status "),leantime.toast.show({message:leantime.i18n.__("short_notifications.status_updated")})})}}})},p=function(){document.body.addEventListener("click",function(i){var o=i.target.closest(".relatesDropdown .dropdown-menu a");if(o){var f=o.getAttribute("data-value").split("/"),T=o.getAttribute("data-label");if(f.length==2){var S=f[0],w=f[1],D=o.getAttribute("class");fetch(leantime.appUrl+"/api/"+r+"canvas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:S,relates:w})}).then(function(){var y=document.querySelector("#relatesDropdownMenuLink"+S+" span.text");y&&(y.textContent=T);var C=document.getElementById("relatesDropdownMenuLink"+S);C&&(C.className=D+" dropdown-toggle f-left relates "),leantime.toast.show({message:leantime.i18n.__("short_notifications.relates_updated")})})}}})},v=function(i,o){o=o||{};var f=i,T=!1,S=function(){return{sizes:{minW:700,minH:1e3},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(L){L.style.display=""}),T&&(T=!1,location.reload())},afterShowCont:function(){window.htmx.process("#global-modal-content"),jQuery("."+f+"CanvasModal, #commentForm, #commentForm .deleteComment, ."+f+"CanvasMilestone .deleteMilestone").nyroModal(S())},beforeClose:function(){location.reload()}},titleFromIframe:!0}},w=function(){jQuery("."+f+"CanvasModal, #commentForm, #commentForm .deleteComment, ."+f+"CanvasMilestone .deleteMilestone").nyroModal(S())},D;o.rowSelectors&&o.rowSelectors.length>0?D=function(){o.rowSelectors.forEach(function(L){var H=0;document.querySelectorAll("#"+L+" div.contentInner").forEach(function(b){b.offsetHeight>H&&(H=b.offsetHeight+35)}),document.querySelectorAll("#"+L+" .column .contentInner").forEach(function(b){b.style.height=H+"px"})})}:o.nbRows&&o.nbRows>0?D=function(){var L=o.nbRows,H=["firstRow","secondRow","thirdRow","fourthRow"],b=document.documentElement.offsetHeight-320-20*L;L===2&&(b-=25);for(var E=0;E<L&&E<H.length;E++){var F="#"+H[E],W=b/L;L>=3&&(W=b*.333),document.querySelectorAll(F+" div.contentInner").forEach(function(X){X.offsetHeight>W&&(W=X.offsetHeight+50)}),document.querySelectorAll(F+" .column .contentInner").forEach(function(X){X.style.height=W+"px"})}}:D=function(){};var y={setCloseModal:function(){T=!0},toggleMilestoneSelectors:function(L){if(L=="existing"){document.querySelectorAll("#newMilestone, #milestoneSelectors").forEach(function(F){F.style.display="none"});var H=document.getElementById("existingMilestone");H&&(H.style.display=""),w()}if(L=="new"){var b=document.getElementById("newMilestone");b&&(b.style.display=""),document.querySelectorAll("#existingMilestone, #milestoneSelectors").forEach(function(F){F.style.display="none"}),w()}if(L=="hide"){document.querySelectorAll("#newMilestone, #existingMilestone").forEach(function(F){F.style.display="none"});var E=document.getElementById("milestoneSelectors");E&&(E.style.display="")}},openModalManually:function(L){jQuery.nmManual(L,S)},initUserDropdown:c,initStatusDropdown:h,initRelatesDropdown:p,setRowHeights:D};if(o.extras)for(var C in o.extras)o.extras.hasOwnProperty(C)&&(y[C]=o.extras[C]);return y};return{setCanvasName:n,initFilterBar:d,initCanvasLinks:u,initUserDropdown:c,initStatusDropdown:h,initRelatesDropdown:p,setCloseModal:l,toggleMilestoneSelectors:a,openModalManually:s,createController:v}}();leantime.cpCanvasController=leantime.canvasController.createController("cp",{nbRows:4});leantime.dbmCanvasController=leantime.canvasController.createController("dbm",{nbRows:3});leantime.eaCanvasController=leantime.canvasController.createController("ea",{nbRows:2});leantime.emCanvasController=leantime.canvasController.createController("em",{nbRows:4});var I=I||{};window.SNAKE=I;I.addEventListener=function(){if(window.addEventListener)return function(r,n,d,u){r.addEventListener(n,d,u)};if(window.attachEvent)return function(r,n,d){r.attachEvent("on"+n,d)}}();I.removeEventListener=function(){if(window.removeEventListener)return function(r,n,d,u){r.removeEventListener(n,d,u)};if(window.detachEvent)return function(r,n,d){r.detachEvent("on"+n,d)}}();I.Snake=I.Snake||function(){var r=[],n=function(){this.elm=null,this.elmStyle=null,this.row=-1,this.col=-1,this.xPos=-1e3,this.yPos=-1e3,this.next=null,this.prev=null};function d(u){var e=0,t=0,m;for(m in u)u[m].elm.currentStyle?t=parseFloat(u[m].elm.style["z-index"],10):window.getComputedStyle&&(t=parseFloat(document.defaultView.getComputedStyle(u[m].elm,null).getPropertyValue("z-index"),10)),!isNaN(t)&&t>e&&(e=t);return e+1}return function(u){if(!u||!u.playingBoard)return;localStorage.jsSnakeHighScore===void 0&&localStorage.setItem("jsSnakeHighScore",0);var e=this,t=u.playingBoard,m=5,s=1,a=-1,l=!0,c=!0,h=-1,p=[0,1,0,-1],v=[-1,0,1,0],i=[],o=[],f=80,T=!1,S=!1,w=document.getElementById("selectMode");w&&w.addEventListener("change",function(H){H=H||{};var b=H.target?parseInt(H.target.value):75;(isNaN(b)||b<25)&&(b=75),f=b,setTimeout(function(){document.getElementById("game-area").focus()},10)}),e.snakeBody={},e.snakeBody.b0=new n,e.snakeBody.b0.row=u.startRow||1,e.snakeBody.b0.col=u.startCol||1,e.snakeBody.b0.xPos=e.snakeBody.b0.row*t.getBlockWidth(),e.snakeBody.b0.yPos=e.snakeBody.b0.col*t.getBlockHeight(),e.snakeBody.b0.elm=D(),e.snakeBody.b0.elmStyle=e.snakeBody.b0.elm.style,t.getBoardContainer().appendChild(e.snakeBody.b0.elm),e.snakeBody.b0.elm.style.left=e.snakeBody.b0.xPos+"px",e.snakeBody.b0.elm.style.top=e.snakeBody.b0.yPos+"px",e.snakeBody.b0.next=e.snakeBody.b0,e.snakeBody.b0.prev=e.snakeBody.b0,e.snakeLength=1,e.snakeHead=e.snakeBody.b0,e.snakeTail=e.snakeBody.b0,e.snakeHead.elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),e.snakeHead.elm.id="snake-snakehead-alive",e.snakeHead.elm.className+=" snake-snakebody-alive";function D(){var H=document.createElement("div");return H.className="snake-snakebody-block",H.style.left="-1000px",H.style.top="-1000px",H.style.width=t.getBlockWidth()+"px",H.style.height=t.getBlockHeight()+"px",H}function y(H){for(var b,E=D(),F=1;F<H;F++)b=new n,b.elm=E.cloneNode(!0),b.elmStyle=b.elm.style,t.getBoardContainer().appendChild(b.elm),r[r.length]=b;b=new n,b.elm=E,t.getBoardContainer().appendChild(b.elm),r[r.length]=b}function C(){var H=localStorage.jsSnakeHighScore;e.snakeLength>H&&(alert("Congratulations! You have beaten your previous high score, which was "+H+"."),localStorage.setItem("jsSnakeHighScore",e.snakeLength))}function L(H){C(),e.snakeHead.elm.style.zIndex=d(e.snakeBody),e.snakeHead.elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-alive\b/,""),e.snakeHead.elm.className+=" snake-snakebody-dead",T=!0,H()}e.setPaused=function(H){S=H},e.getPaused=function(){return S},e.handleArrowKeys=function(H){if(T||S&&!u.premoveOnPause)return;e.snakeLength;let b=-1;switch(H){case 37:case 65:b=3;break;case 38:case 87:b=0;break;case 39:case 68:b=1;break;case 40:case 83:b=2;break}h!==s&&(a=b),(Math.abs(b-s)!==2&&(l||S)||c)&&(h=b,l=!1,c=!1)},e.go=function(){var H=e.snakeHead,b=e.snakeTail,E=t.grid;if(S===!0){setTimeout(function(){e.go()},f);return}if(e.snakeTail=b.prev,e.snakeHead=b,E[b.row]&&E[b.row][b.col]&&(E[b.row][b.col]=0),h!==-1&&(s=h,a!==-1&&(h=a,a=-1)),l=!0,b.col=H.col+p[s],b.row=H.row+v[s],b.xPos=H.xPos+i[s],b.yPos=H.yPos+o[s],b.elmStyle||(b.elmStyle=b.elm.style),b.elmStyle.left=b.xPos+"px",b.elmStyle.top=b.yPos+"px",e.snakeLength>1&&(b.elm.id="snake-snakehead-alive",H.elm.id=""),E[b.row][b.col]===0)E[b.row][b.col]=1,setTimeout(function(){e.go()},f);else if(E[b.row][b.col]>0)e.handleDeath();else if(E[b.row][b.col]===t.getGridFoodValue()){if(E[b.row][b.col]=1,!e.eatFood()){e.handleWin();return}setTimeout(function(){e.go()},f)}},e.eatFood=function(){r.length<=m&&y(m*2);for(var H=r.splice(0,m),b=H.length,E,F=e.snakeTail;b--;)E="b"+e.snakeLength++,e.snakeBody[E]=H[b],e.snakeBody[E].prev=F,e.snakeBody[E].elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),e.snakeBody[E].elm.className+=" snake-snakebody-alive",F.next=e.snakeBody[E],F=e.snakeBody[E];if(e.snakeTail=e.snakeBody[E],e.snakeTail.next=e.snakeHead,e.snakeHead.prev=e.snakeTail,!t.foodEaten())return!1;var W=document.getElementById("selectMode"),X=W.options[W.selectedIndex];return X.text.localeCompare("Rush")==0&&(f>30?f-=5:f=30),!0},e.handleDeath=function(){var H=document.getElementById("selectMode").value;f=parseInt(H),L(t.handleDeath)},e.handleWin=function(){L(t.handleWin)},e.rebirth=function(){T=!1,l=!0,c=!0,a=-1},e.reset=function(){if(T!==!1){for(var H=[],b=e.snakeHead.next,E;b!==e.snakeHead;)E=b.next,b.prev=null,b.next=null,H.push(b),b=E;e.snakeHead.next=e.snakeHead,e.snakeHead.prev=e.snakeHead,e.snakeTail=e.snakeHead,e.snakeLength=1;for(var F=0;F<H.length;F++)H[F].elm.style.left="-1000px",H[F].elm.style.top="-1000px",H[F].elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),H[F].elm.className+=" snake-snakebody-alive";r.concat(H),e.snakeHead.elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),e.snakeHead.elm.className+=" snake-snakebody-alive",e.snakeHead.elm.id="snake-snakehead-alive",e.snakeHead.row=u.startRow||1,e.snakeHead.col=u.startCol||1,e.snakeHead.xPos=e.snakeHead.row*t.getBlockWidth(),e.snakeHead.yPos=e.snakeHead.col*t.getBlockHeight(),e.snakeHead.elm.style.left=e.snakeHead.xPos+"px",e.snakeHead.elm.style.top=e.snakeHead.yPos+"px"}},y(m*2),i[0]=0,i[1]=t.getBlockWidth(),i[2]=0,i[3]=-1*t.getBlockWidth(),o[0]=-1*t.getBlockHeight(),o[1]=0,o[2]=t.getBlockHeight(),o[3]=0}}();I.Food=I.Food||function(){var r=0;function n(d,u){return Math.floor(Math.random()*(u+1-d))+d}return function(d){if(!(!d||!d.playingBoard)){var u=this,e=d.playingBoard,t,m,s=r++,a=document.createElement("div");a.setAttribute("id","snake-food-"+s),a.className="snake-food-block",a.style.width=e.getBlockWidth()+"px",a.style.height=e.getBlockHeight()+"px",a.style.left="-1000px",a.style.top="-1000px",e.getBoardContainer().appendChild(a),u.getFoodElement=function(){return a},u.randomlyPlaceFood=function(){e.grid[t]&&e.grid[t][m]===e.getGridFoodValue()&&(e.grid[t][m]=0);for(var l=0,c=0,h=0,p=e.grid.length-1,v=e.grid[0].length-1;e.grid[l][c]!==0;)if(l=n(1,p),c=n(1,v),h++,h>2e4)return!1;return e.grid[l][c]=e.getGridFoodValue(),t=l,m=c,a.style.top=l*e.getBlockHeight()+"px",a.style.left=c*e.getBlockWidth()+"px",!0}}}}();I.Board=I.Board||function(){var r=0;function n(e){var t=0,m=0,s;for(s in e)e[s].elm.currentStyle?m=parseFloat(e[s].elm.style["z-index"],10):window.getComputedStyle&&(m=parseFloat(document.defaultView.getComputedStyle(e[s].elm,null).getPropertyValue("z-index"),10)),!isNaN(m)&&m>t&&(t=m);return t+1}function d(){var e=0;return typeof window.innerWidth=="number"?e=window.innerWidth:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?e=document.documentElement.clientWidth:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e=document.body.clientWidth),e}function u(){var e=0;return typeof window.innerHeight=="number"?e=window.innerHeight:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?e=document.documentElement.clientHeight:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e=document.body.clientHeight),e}return function(e){var t=this,m=r++,s=e||{},a=250,l=250,c=20,h=20,p=-1,v,i,o=1,f,T=!1,S,w,D,y,C,L,H,b,E;t.grid=[];function F(){w=document.createElement("div"),w.setAttribute("id","playingField"),w.className="snake-playing-field",I.addEventListener(w,"click",function(){S.focus()},!1),E=document.createElement("div"),E.className="snake-pause-screen",E.innerHTML="<div style='padding:10px;'>[Paused]<p/>Press [space] to unpause.</div>",D=document.createElement("div"),D.className="snake-panel-component",D.innerHTML="<a href='http://patorjk.com/blog/software/' class='snake-link'>more patorjk.com apps</a> - <a href='https://github.com/patorjk/JavaScript-Snake' class='snake-link'>source code</a> - <a href='https://www.youtube.com/channel/UCpcCLm9y6CsjHUrCvJHYHUA' class='snake-link'>pat's youtube</a>",y=document.createElement("div"),y.className="snake-panel-component",y.innerHTML="Length: 1",C=document.createElement("div"),C.className="snake-panel-component",C.innerHTML="Highscore: "+(localStorage.jsSnakeHighScore||0),L=V(),H=ce(),b=ue(),I.addEventListener(S,"keyup",function(g){if(!g)var g=window.event;return g.cancelBubble=!0,g.stopPropagation&&g.stopPropagation(),g.preventDefault&&g.preventDefault(),!1},!1),S.className="snake-game-container",E.style.zIndex=1e4,S.appendChild(E),S.appendChild(w),S.appendChild(D),S.appendChild(y),S.appendChild(C),S.appendChild(L),S.appendChild(H),S.appendChild(b),i=new I.Snake({playingBoard:t,startRow:2,startCol:2,premoveOnPause:s.premoveOnPause}),v=new I.Food({playingBoard:t}),L.style.zIndex=1e3}function W(){return a*t.getBlockWidth()}function X(){return l*t.getBlockHeight()}function V(){var _=document.createElement("div");_.id="sbWelcome"+m,_.className="snake-welcome-dialog";var g=document.createElement("div"),k="";s.fullScreen&&(k="On Windows, press F11 to play in Full Screen mode."),g.innerHTML="JavaScript Snake<p></p>Use the <strong>arrow keys</strong> on your keyboard to play the game. "+k+"<p></p>";var Q=document.createElement("button");Q.appendChild(document.createTextNode("Play Game"));var x=function(){I.removeEventListener(window,"keyup",M,!1),_.style.display="none",t.setBoardState(1),t.getBoardContainer().focus()},M=function(A){if(!A)var A=window.event;var P=A.which?A.which:A.keyCode;(P===32||P===13)&&x()};return I.addEventListener(window,"keyup",M,!1),I.addEventListener(Q,"click",x,!1),_.appendChild(g),_.appendChild(Q),_}function ie(_,g,k){var Q=document.createElement("div");Q.id=g+m,Q.className=k;var x=document.createElement("div");x.innerHTML="JavaScript Snake<p></p>"+_+"<p></p>";var M=document.createElement("button");M.appendChild(document.createTextNode("Play Again?"));var q=function(){Q.style.display="none",t.resetBoard(),t.setBoardState(1),t.getBoardContainer().focus()},A=function(R){if(!(o!==0||Q.style.display!=="block")){if(!R)var R=window.event;var U=R.which?R.which:R.keyCode;(U===32||U===13)&&q()}};return I.addEventListener(window,"keyup",A,!0),I.addEventListener(M,"click",q,!1),Q.appendChild(x),Q.appendChild(M),Q}function ce(){return ie("You died :(","sbTryAgain","snake-try-again-dialog")}function ue(){return ie("You win! :D","sbWin","snake-win-dialog")}function j(_){var g=Math.max(n(i.snakeBody),n({tmp:{elm:v.getFoodElement()}}));S.removeChild(_),S.appendChild(_),_.style.zIndex=g,_.style.display="block",t.setBoardState(0)}t.setPaused=function(_){T=_,i.setPaused(_),T?E.style.display="block":E.style.display="none"},t.getPaused=function(){return T},t.resetBoard=function(){I.removeEventListener(S,"keydown",f,!1),i.reset(),y.innerHTML="Length: 1",t.setupPlayingField()},t.getBoardState=function(){return o},t.setBoardState=function(_){o=_},t.getGridFoodValue=function(){return p},t.getPlayingFieldElement=function(){return w},t.setBoardContainer=function(_){typeof _=="string"&&(_=document.getElementById(_)),_!==S&&(S=_,w=null,t.setupPlayingField())},t.getBoardContainer=function(){return S},t.getBlockWidth=function(){return c},t.getBlockHeight=function(){return h},t.setupPlayingField=function(){w||F();var _,g,k,Q;s.fullScreen===!0?(k=0,Q=0,_=d()-20,g=u()-20):(k=s.top,Q=s.left,_=s.width,g=s.height);var x=t.getBlockWidth()*2+_%t.getBlockWidth(),M=Math.min(W()-x,_-x),q=t.getBlockHeight()*3+g%t.getBlockHeight(),A=Math.min(X()-q,g-q);S.style.left=Q+"px",S.style.top=k+"px",S.style.width=_+"px",S.style.height=g+"px",w.style.left=t.getBlockWidth()+"px",w.style.top=t.getBlockHeight()+"px",w.style.width=M+"px",w.style.height=A+"px";var P=q-t.getBlockHeight(),R=t.getBlockHeight()+A+Math.round((P-30)/2)+"px";D.style.top=R,D.style.width="450px",D.style.left=Math.round(_/2)-Math.round(450/2)+"px",y.style.top=R,y.style.left="30px",C.style.top=R,C.style.left=_-140+"px",_<700?D.style.display="none":D.style.display="block",t.grid=[];for(var U=M/t.getBlockWidth()+2,O=A/t.getBlockHeight()+2,B=0;B<O;B++){t.grid[B]=[];for(var N=0;N<U;N++)N===0||B===0||N===U-1||B===O-1?t.grid[B][N]=1:t.grid[B][N]=0}v.randomlyPlaceFood(),f=function(z){if(!z)var z=window.event;var Y=z.which?z.which:z.keyCode;if(t.getBoardState()===1){if(!(Y>=37&&Y<=40)&&!(Y===87||Y===65||Y===83||Y===68))return;I.removeEventListener(S,"keydown",f,!1),f=function(K){if(!K)var K=window.event;var $=K.which?K.which:K.keyCode;return $===32&&t.getBoardState()!=0&&t.setPaused(!t.getPaused()),i.handleArrowKeys($),K.cancelBubble=!0,K.stopPropagation&&K.stopPropagation(),K.preventDefault&&K.preventDefault(),!1},I.addEventListener(S,"keydown",f,!1),i.rebirth(),i.handleArrowKeys(Y),t.setBoardState(2),i.go()}return z.cancelBubble=!0,z.stopPropagation&&z.stopPropagation(),z.preventDefault&&z.preventDefault(),!1},I.addEventListener(S,"keydown",f,!1)},t.foodEaten=function(){return y.innerHTML="Length: "+i.snakeLength,i.snakeLength>localStorage.jsSnakeHighScore&&(localStorage.setItem("jsSnakeHighScore",i.snakeLength),C.innerHTML="Highscore: "+localStorage.jsSnakeHighScore),!!v.randomlyPlaceFood()},t.handleDeath=function(){j(H)},t.handleWin=function(){j(b)},s.fullScreen=typeof s.fullScreen>"u"?!1:s.fullScreen,s.top=typeof s.top>"u"?0:s.top,s.left=typeof s.left>"u"?0:s.left,s.width=typeof s.width>"u"?400:s.width,s.height=typeof s.height>"u"?400:s.height,s.premoveOnPause=typeof s.premoveOnPause>"u"?!1:s.premoveOnPause,s.fullScreen&&I.addEventListener(window,"resize",function(){t.setupPlayingField()},!1),t.setBoardState(0),s.boardContainer&&t.setBoardContainer(s.boardContainer)}}();leantime.goalCanvasController=leantime.canvasController.createController("goal",{extras:{initProgressChart:function(r,n,d){var u={type:"doughnut",data:{datasets:[{data:[n,d],backgroundColor:[leantime.dashboardController.chartColors.green,leantime.dashboardController.chartColors.grey],label:leantime.i18n.__("label.project_done")}],labels:[n+"%"]},options:{maintainAspectRatio:!0,responsive:!0,plugins:{legend:{position:"none"},title:{display:!1,text:"Complete"}},animation:{animateScale:!0,animateRotate:!0}}},e=document.getElementById(r).getContext("2d");new Chart(e,u)}}});leantime.ideasController=function(){var r=!1,n=function(){return{sizes:{minW:700,minH:1e3},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(v){v.style.display=""}),r==!0&&(r=!1,location.reload())},afterShowCont:function(){jQuery(".ideaModal, #commentForm, #commentForm .deleteComment, .leanCanvasMilestone .deleteMilestone").nyroModal(n())}}}},d=function(){jQuery(".ideaModal, #commentForm, #commentForm .deleteComment, .leanCanvasMilestone .deleteMilestone").nyroModal(n())},u=function(v){jQuery.nmManual(v,n)},e=function(){var v=document.querySelector("#ideaMason");if(!v)return;var i=new Packery(v,{itemSelector:".ticketBox",columnWidth:260,isResizable:!0});imagesLoaded(v).on("progress",function(){i.layout()});var o=v.querySelectorAll(".ticketBox");o.forEach(function(S){var w=new Draggabilly(S);w.on("dragStart",function(){S.classList.add("tilt"),f(S)}),w.on("dragEnd",function(){S.classList.remove("tilt"),S._moveHandler&&(document.removeEventListener("mousemove",S._moveHandler),delete S._moveHandler)}),i.bindDraggabillyEvents(w)});function f(S){var w=S.getBoundingClientRect().left,D=function(y){y.pageX>=w?(S.classList.add("right"),S.classList.remove("left")):(S.classList.add("left"),S.classList.remove("right")),w=y.pageX};document.addEventListener("mousemove",D),S._moveHandler=D}i.on("dragItemPositioned",T);function T(){var S=[],w=i.getItemElements();w.forEach(function(D,y){var C=y+1,L=D.getAttribute("data-value");S.push({id:L,sortIndex:C})}),fetch(leantime.appUrl+"/api/ideas",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({action:"ideaSort",payload:JSON.stringify(S)})})}},t=function(){},m=function(){document.querySelectorAll(".mainIdeaContent img").forEach(function(v){var i=document.createElement("a");i.href=v.getAttribute("src"),i.className="imageModal",v.parentElement.insertBefore(i,v),i.appendChild(v)}),jQuery(".imageModal").nyroModal()},s=function(v){if(v=="existing"){var i=document.querySelector("#newMilestone"),o=document.querySelector("#milestoneSelectors"),f=document.querySelector("#existingMilestone");i&&(i.style.display="none"),o&&(o.style.display="none"),f&&(f.style.display=""),d()}if(v=="new"){var i=document.querySelector("#newMilestone"),f=document.querySelector("#existingMilestone"),o=document.querySelector("#milestoneSelectors");i&&(i.style.display=""),f&&(f.style.display="none"),o&&(o.style.display="none"),d()}if(v=="hide"){var i=document.querySelector("#newMilestone"),f=document.querySelector("#existingMilestone"),o=document.querySelector("#milestoneSelectors");i&&(i.style.display="none"),f&&(f.style.display="none"),o&&(o.style.display="")}},a=function(){r=!0},l=function(){document.body.addEventListener("click",function(v){var i=v.target.closest(".userDropdown .dropdown-menu a");if(i){var o=i.getAttribute("data-value").split("_");if(i.getAttribute("data-label"),o.length==3){var f=o[0],T=o[1];o[2],fetch(leantime.appUrl+"/api/ideas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:f,author:T})}).then(function(){var S=document.querySelector("#userDropdownMenuLink"+f+" span.text span#userImage"+f+" img");S&&S.setAttribute("src",leantime.appUrl+"/api/users?profileImage="+T),leantime.toast.show({message:leantime.i18n.__("short_notifications.user_updated"),style:"success"})})}}})},c=function(){document.body.addEventListener("click",function(v){var i=v.target.closest(".statusDropdown .dropdown-menu a");if(i){var o=i.getAttribute("data-value").split("_"),f=i.getAttribute("data-label");if(o.length==3){var T=o[0],S=o[1],w=o[2];fetch(leantime.appUrl+"/api/ideas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:T,box:S})}).then(function(){var D=document.querySelector("#statusDropdownMenuLink"+T+" span.text");D&&(D.textContent=f);var y=document.querySelector("#statusDropdownMenuLink"+T);y&&(y.className=w+" dropdown-toggle f-left status"),leantime.toast.show({message:leantime.i18n.__("short_notifications.status_updated"),style:"success"})})}}})},h=function(){var v=document.documentElement.scrollHeight-320;document.querySelectorAll("#sortableIdeaKanban .column .contentInner").forEach(function(i){i.style.height=v+"px"})},p=function(v){document.querySelectorAll("#sortableIdeaKanban .ticketBox").forEach(function(f){f.addEventListener("mouseenter",function(){this.style.background="var(--kanban-card-hover)"}),f.addEventListener("mouseleave",function(){this.style.background="var(--kanban-card-bg)"})});function i(f){var T=f.querySelectorAll(":scope > .moveable"),S=[];return T.forEach(function(w){if(w.id){var D=w.id.indexOf("_");D!==-1&&S.push(w.id.substring(0,D)+"[]="+w.id.substring(D+1))}}),S.join("&")}document.querySelectorAll("#sortableIdeaKanban .contentInner").forEach(function(f){f._sortableInstance&&f._sortableInstance.destroy(),f._sortableInstance=new Sortable(f,{group:"idea-kanban",draggable:".moveable",ghostClass:"ui-state-highlight",filter:".portlet-toggle",animation:150,onStart:function(T){T.item.classList.add("tilt"),o(T.item)},onEnd:function(T){T.item.classList.remove("tilt"),T.item._moveHandler&&(document.removeEventListener("mousemove",T.item._moveHandler),delete T.item._moveHandler);for(var S={action:"statusUpdate",payload:{}},w=0;w<v.length;w++){var D=document.querySelector(".contentInner.status_"+v[w]);D&&(S.payload[v[w]]=i(D))}fetch(leantime.appUrl+"/api/ideas",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams(S)})}})});function o(f){var T=f.getBoundingClientRect().left,S=function(w){w.pageX>=T?(f.classList.add("right"),f.classList.remove("left")):(f.classList.add("left"),f.classList.remove("right")),T=w.pageX};document.addEventListener("mousemove",S),f._moveHandler=S}document.querySelectorAll(".portlet").forEach(function(f){var T=f.querySelector(".portlet-header");if(T){var S=document.createElement("span");S.className="portlet-toggle",T.prepend(S)}}),document.querySelectorAll(".portlet-toggle").forEach(function(f){f.addEventListener("click",function(){this.classList.toggle("expanded");var T=this.closest(".portlet").querySelector(".portlet-content");T&&(T.style.display=T.style.display==="none"?"":"none")})})};return{setCloseModal:a,toggleMilestoneSelectors:s,openModalManually:u,initMasonryWall:e,initBoardControlModal:t,initWallImageModals:m,initUserDropdown:l,initStatusDropdown:c,setKanbanHeights:h,initIdeaKanban:p}}();leantime.insightsCanvasController=leantime.canvasController.createController("insights",{nbRows:1});leantime.lbmCanvasController=leantime.canvasController.createController("lbm",{nbRows:2});leantime.leanCanvasController=leantime.canvasController.createController("lean",{nbRows:3});leantime.minempathyCanvasController=leantime.canvasController.createController("minempathy",{nbRows:3});leantime.obmCanvasController=leantime.canvasController.createController("obm",{nbRows:3});leantime.projectsController=function(){function r(){document.querySelectorAll("#sortableTicketKanban .column").forEach(function(w){var D=w.querySelectorAll(".moveable").length,y=w.querySelector(".count");y&&(y.textContent=D)})}var n=function(){jQuery(".projectDateFrom, .projectDateTo").datepicker({dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader")})},d=function(){jQuery(".projectTabs").tabs()},u=function(){var w={sizes:{minW:450,minH:350},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(D){D.style.display=""}),n(),jQuery(".duplicateProjectModal, .formModal").nyroModal(w)},beforeClose:function(){location.reload()}}};jQuery(".duplicateProjectModal").nyroModal(w)},e=function(w){jQuery("#progressbar").progressbar({value:w})},t=function(){document.addEventListener("DOMContentLoaded",function(){jQuery("#allProjectsTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")}},dom:'<"top">rt<"bottom"ilp><"clear">',searching:!1,displayLength:100})})},m=function(w){var D=1,y=typeof w=="string"?document.querySelector(w):w;y.querySelectorAll("input.sorter").forEach(function(C){C.value=D,D++}),y._sortableInstance&&y._sortableInstance.destroy(),y._sortableInstance=new Sortable(y,{animation:150,onEnd:function(){D=1,y.querySelectorAll("input.sorter").forEach(function(C){C.value=D,D++})}})},s=function(){document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("#todosettings select.colorChosen").forEach(function(w){new SlimSelect({select:w,settings:{searchHighlight:!1}})})})},a=function(w){var D=document.querySelector("#todostatus-"+w);D&&D.parentElement&&D.parentElement.remove()},l=function(w){var D=-1;document.querySelectorAll("#todosettings ul .statusList").forEach(function(E){var F=E.querySelector(".labelKey");if(F){var W=F.value;parseInt(W)>=parseInt(D)&&(D=W)}});var y=parseInt(D)+1,C=document.querySelector(".newStatusTpl"),L=C.innerHTML.replaceAll("XXNEWKEYXX",y),H=document.querySelector("#todoStatusList");H.insertAdjacentHTML("beforeend","<li>"+L+"</li>"),document.querySelectorAll("#todosettings select.colorChosen").forEach(function(E){E.slim&&E.slim.destroy()}),leantime.projectsController.initSelectFields();var b=document.querySelector("#todoStatusList");b&&b._sortableInstance&&b._sortableInstance.destroy(),leantime.projectsController.initTodoStatusSortable("#todoStatusList")},c=null,h=function(w){if(p(),w.files&&w.files[0]){var D=new FileReader,y=document.querySelector("#projectAvatar");D.onload=function(C){c=new Croppie(y,{enableExif:!0,viewport:{width:200,height:200,type:"rectangle"},boundary:{width:250,height:250}}),c.bind({url:C.currentTarget.result});var L=document.querySelector("#previousImage");L&&(L.style.display="none")},D.readAsDataURL(w.files[0])}},p=function(){document.querySelector("#profileImg"),c&&(c.destroy(),c=null);var w=document.querySelector("#previousImage");w&&(w.style.display="")},v=function(){var w=document.querySelector("#save-picture");w&&w.classList.add("running");var D=document.querySelector("#profileImg");D&&D.setAttribute("src",leantime.appUrl+"/images/loaders/loader28.gif"),c.result({type:"blob",circle:!1}).then(function(y){var C=new FormData;C.append("file",y),fetch(leantime.appUrl+"/api/projects",{method:"POST",body:C,credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(L){w&&w.classList.remove("running"),location.reload()}).catch(function(L){console.log(L)})})},i=function(w,D,y){function C(L){return String(L).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}document.addEventListener("DOMContentLoaded",function(){if(y===!1)var L=new Gantt("#gantt",w,{header_height:55,column_width:20,step:24,view_modes:["Day","Week","Month"],bar_height:40,static_progress_indicator:!0,bar_corner_radius:10,arrow_curve:10,padding:20,view_mode:"Month",date_format:leantime.i18n.__("language.momentJSDate"),language:"en",additional_rows:5,custom_popup_html:function(b){b._end;var E='<div class="details-container" style="min-width:600px;"> ';return b.projectName!==void 0&&(E+="<h3><b>"+b.name+"</b></h3>"),E+="<h4>"+C(b.name)+"</a></h4><br /> ",E+="</div>",E},on_click:function(b){},on_date_change:function(b,E,F){var W=b.id.split("-");let X=0,V="";W.length>1?W[0]=="ticket"?(X=W[1],V="ticket"):W[0]=="pgm"&&(X=W[1],V="project"):X=W,V=="ticket"?leantime.ticketsRepository.updateMilestoneDates(X,E,F,b._index+1):fetch(leantime.appUrl+"/api/projects",{method:"PATCH",body:new URLSearchParams({id:X,start:E,end:F,sortIndex:b._index+1}),credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}})},on_sort_change:function(b){for(var E={action:"ganttSort",payload:{}},F=0;F<b.length;F++)E.payload[b[F].id]=b[F]._index+1;fetch(leantime.appUrl+"/api/projects",{method:"POST",body:new URLSearchParams(o(E)),credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}})},on_progress_change:function(b,E){},on_view_change:function(b){leantime.usersRepository.updateUserViewSettings("projectGantt",b)},on_popup_show:function(b){}});else var L=new Gantt("#gantt",w,{readonlyGantt:!0,resizing:!1,progress:!1,is_draggable:!1,custom_popup_html:function(E){task._end;var F='<div class="details-container" style="min-width:600px;"> ';return task.projectName!==void 0&&(F+="<h3><b>"+E.name+"</b></h3>"),F+="<h4>"+C(E.name)+"</a></h4><br /> ",F+="</div>",F},on_click:function(E){},on_date_change:function(E,F,W){},on_progress_change:function(E,F){},on_view_change:function(E){leantime.usersRepository.updateUserViewSettings("projectGantt",E)}});var H=document.querySelector("#ganttTimeControl");H&&H.addEventListener("click",function(b){var E=b.target.closest("a");if(E){var F=E.getAttribute("data-value");L.change_view_mode(F),H.querySelectorAll("a").forEach(function(X){X.classList.remove("active")}),E.classList.add("active");var W=E.textContent;document.querySelectorAll(".viewText").forEach(function(X){X.textContent=W})}}),L.change_view_mode(D)})};function o(w,D){var y={};for(var C in w)if(w.hasOwnProperty(C)){var L=D?D+"["+C+"]":C;typeof w[C]=="object"&&w[C]!==null?Object.assign(y,o(w[C],L)):y[L]=w[C]}return y}var f=function(){document.addEventListener("DOMContentLoaded",function(){r();var w=document.querySelector(".filterBar .row-fluid");w&&(w.style.opacity="1");var D=document.documentElement.scrollHeight-250;document.querySelectorAll("#sortableProjectKanban .column .contentInner").forEach(function(y){y.offsetHeight>D&&(D=y.offsetHeight)}),D=D+50,document.querySelectorAll("#sortableProjectKanban .column .contentInner").forEach(function(y){y.style.minHeight=D+"px"})})},T=function(w){document.querySelectorAll("#sortableProjectKanban .projectBox").forEach(function(C){C.addEventListener("mouseenter",function(){this.style.background="var(--kanban-card-hover)"}),C.addEventListener("mouseleave",function(){this.style.background="var(--kanban-card-bg)"})});function D(C){var L=C.querySelectorAll(":scope > .moveable"),H=[];return L.forEach(function(b){if(b.id){var E=b.id.indexOf("_");E!==-1&&H.push(b.id.substring(0,E)+"[]="+b.id.substring(E+1))}}),H.join("&")}document.querySelectorAll("#sortableProjectKanban .contentInner").forEach(function(C){C._sortableInstance&&C._sortableInstance.destroy(),C._sortableInstance=new Sortable(C,{group:"project-kanban",draggable:".moveable",ghostClass:"ui-state-highlight",filter:".portlet-toggle, input, a, select, textarea",preventOnFilter:!1,animation:150,delay:25,delayOnTouchOnly:!0,onStart:function(L){L.item.classList.add("tilt"),y(L.item)},onEnd:function(L){L.item.classList.remove("tilt"),L.item._moveHandler&&(document.removeEventListener("mousemove",L.item._moveHandler),delete L.item._moveHandler),r();for(var H={action:"sortIndex",payload:{},handler:L.item.id},b=0;b<w.length;b++){var E=document.querySelector(".contentInner.status_"+w[b]);E&&(H.payload[w[b]]=D(E))}fetch(leantime.appUrl+"/api/projects",{method:"POST",body:new URLSearchParams(o(H)),credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}})}})});function y(C){var L=C.getBoundingClientRect().left,H=function(b){b.pageX>=L?(C.classList.add("right"),C.classList.remove("left")):(C.classList.add("left"),C.classList.remove("right")),L=b.pageX};document.addEventListener("mousemove",H),C._moveHandler=H}document.querySelectorAll(".portlet").forEach(function(C){C.classList.add("ui-widget","ui-widget-content","ui-helper-clearfix","ui-corner-all");var L=C.querySelector(".portlet-header");L&&(L.classList.add("ui-widget-header","ui-corner-all"),L.insertAdjacentHTML("afterbegin","<span class='ui-icon ui-icon-minusthick portlet-toggle'></span>"))}),document.querySelectorAll(".portlet-toggle").forEach(function(C){C.addEventListener("click",function(){this.classList.toggle("ui-icon-minusthick"),this.classList.toggle("ui-icon-plusthick");var L=this.closest(".portlet").querySelector(".portlet-content");L&&(L.style.display=L.style.display==="none"?"":"none")})})},S=function(w,D){D.classList.add("go"),D.classList.contains("isFavorite")?leantime.reactionsController.removeReaction("project",w,"favorite",function(){var y=D.querySelector("i");y&&(y.classList.remove("fa-solid"),y.classList.add("fa-regular")),D.classList.remove("isFavorite")}):leantime.reactionsController.addReactions("project",w,"favorite",function(){var y=D.querySelector("i");y&&(y.classList.remove("fa-regular"),y.classList.add("fa-solid")),D.classList.add("isFavorite")})};return{initDates:n,initProjectTabs:d,initProgressBar:e,initProjectTable:t,initDuplicateProjectModal:u,initTodoStatusSortable:m,initSelectFields:s,removeStatus:a,addToDoStatus:l,saveCroppie:v,clearCroppie:p,readURL:h,initGanttChart:i,setUpKanbanColumns:f,initProjectsKanban:T,favoriteProject:S}}();leantime.retrosCanvasController=leantime.canvasController.createController("retros",{nbRows:1});leantime.risksCanvasController=leantime.canvasController.createController("risks",{nbRows:2});leantime.sbCanvasController=leantime.canvasController.createController("sb",{rowSelectors:["stakeholderRow","financialsRow","culturechangeRow"]});leantime.smCanvasController=leantime.canvasController.createController("sm");leantime.sqCanvasController=leantime.canvasController.createController("sq");leantime.swotCanvasController=leantime.canvasController.createController("swot",{nbRows:2});leantime.kanbanController=function(){var r=function(p){var v=p.closest(".quickaddContainer"),i=v.querySelector("[data-quickadd-form]"),o=i.querySelector("[data-quickadd-input]"),f=v.querySelector(".quickAddLink"),T=i.classList.contains("active");T?(i.classList.remove("active"),i.style.display="none",i.dataset.submitting="false",f.style.display="",f.setAttribute("aria-expanded","false")):(i.classList.add("active"),i.style.display="block",i.dataset.submitting="false",f.style.display="none",f.setAttribute("aria-expanded","true"),o.focus())},n=function(){document.addEventListener("keydown",function(p){var v=p.target;if(v.matches("[data-quickadd-input]")){var i=v.closest("[data-quickadd-form]");if(i.dataset.submitting==="true"){p.preventDefault();return}var o=i.querySelector("[data-stay-open-input]");if(p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),i.dataset.submitting="true",o.value="0",i.submit()),p.key==="Enter"&&p.shiftKey&&(p.preventDefault(),i.dataset.submitting="true",o.value="1",i.submit()),p.key==="Escape"){p.preventDefault();var f=i.closest(".quickaddContainer"),T=f.querySelector(".quickAddLink");r(T),v.value=""}}})},d=function(){document.addEventListener("click",function(p){var v=document.querySelectorAll("[data-quickadd-form].active");v.forEach(function(i){var o=i.closest(".quickaddContainer"),f=o.querySelector(".quickAddLink"),T=i.querySelector("[data-quickadd-input]"),S=i.contains(p.target)||f.contains(p.target);if(i.dataset.submitting!=="true")if(!S&&T.value.trim()!==""){var w=i.querySelector("[data-stay-open-input]");w.value="0",i.dataset.submitting="true",i.submit()}else S||r(f)})})},u=function(p){var v=p.querySelectorAll(".column .contentInner");if(v.length!==0){v.forEach(function(o){o.style.minHeight="",o.style.height=""});var i=0;v.forEach(function(o){var f=o.offsetHeight;f>i&&(i=f)}),i>0&&v.forEach(function(o){o.style.minHeight=i+"px"})}},e=function(p){var v=p.querySelectorAll(".column .contentInner");v.forEach(function(i){i.style.minHeight="",i.style.height=""})},t=function(){requestAnimationFrame(function(){requestAnimationFrame(function(){var p=document.querySelectorAll(".kanban-swimlane-content:not(.collapsed)");p.forEach(function(v){u(v)})})})},m=function(p){var v=document.getElementById("swimlane-row-"+p),i=document.querySelector('.kanban-swimlane-sidebar[data-swimlane-id="'+p+'"]'),o=document.getElementById("swimlane-content-"+p);if(!v||!i||!o){console.error("Swimlane elements not found for ID:",p);return}var f=i.getAttribute("aria-expanded")==="true",T=!f;i.setAttribute("aria-expanded",T.toString());var S=i.querySelector(".kanban-lane-chevron i");S&&(S.className=T?"fa fa-chevron-down":"fa fa-chevron-right"),v.setAttribute("data-expanded",T.toString()),T?(o.classList.remove("collapsed"),u(o)):(o.classList.add("collapsed"),u(o)),fetch(leantime.appUrl+"/api/submenu",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({submenu:"swimlane_"+p,state:T?"open":"closed"})})},s=function(){document.addEventListener("keydown",function(p){var v=p.target.closest("[data-swimlane-id]");if(v){var i=v.getAttribute("data-swimlane-id");if((p.key==="Enter"||p.key===" ")&&(p.preventDefault(),m(i)),p.key==="ArrowDown"||p.key==="ArrowUp"){p.preventDefault();var o=Array.from(document.querySelectorAll("[data-swimlane-id]")),f=o.indexOf(v);p.key==="ArrowDown"&&f<o.length-1?o[f+1].focus():p.key==="ArrowUp"&&f>0&&o[f-1].focus()}}})},a=function(){if(!(typeof tippy>"u")){var p={allowHTML:!0,placement:"top",arrow:!0,theme:"light-border",trigger:"mouseenter focus",delay:[500,0]},v=[".status-segment[data-tippy-content]",".time-indicator[data-tippy-content]",".kanban-lane-count[data-tippy-content]",".tshirt-icon[data-tippy-content]",".thermometer-icon[data-tippy-content]",".user-avatar[data-tippy-content]",".type-icon[data-tippy-content]",".sprint-icon[data-tippy-content]",".milestone-icon[data-tippy-content]",".swimlane-header-label[data-tippy-content]"];v.forEach(function(i){var o=document.querySelectorAll(i);o.length>0&&tippy(o,p)})}},l=function(){"ontouchstart"in window&&document.querySelectorAll(".widgettitle").forEach(function(p){p.addEventListener("click",function(v){v.target.closest(".dropdown-toggle, .dropdown-menu")||this.classList.toggle("count-visible")})})},c=function(){var p=document.querySelectorAll(".kanban-swimlane-content.collapsed");p.forEach(function(v){u(v)})},h=function(){var p=document.querySelectorAll(".kanban-swimlane-row");if(p.length!==0&&!(window.innerWidth<=768)){var v=120,i=function(){p.forEach(function(o){var f=o.querySelector(".kanban-swimlane-sidebar"),T=o.querySelector(".kanban-swimlane-sidebar-inner"),S=o.querySelector(".kanban-swimlane-sentinel");if(!(!f||!T||!S)){var w=S.getBoundingClientRect(),D=f.getBoundingClientRect(),y=w.top<v&&D.bottom>v+100;if(y){var C=v-D.top,L=D.height-T.offsetHeight-12;C=Math.min(C,Math.max(0,L)),f.classList.add("is-sticky"),T.style.transform="translateY("+C+"px)"}else f.classList.remove("is-sticky"),T.style.transform=""}})};window.addEventListener("scroll",i,{passive:!0}),i()}};return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){n(),d(),s(),a(),h(),l(),c(),t()}):(n(),d(),s(),a(),h(),l(),c(),t()),{toggleQuickAdd:r,initQuickAddKeyboard:n,initClickOutsideSave:d,toggleSwimlane:m,initSwimlaneKeyboard:s,initProgressBarTooltips:a,equalizeColumnHeights:u,resetColumnHeights:e,initCollapsedColumnHeights:c,initExpandedColumnHeights:t,initStickySwimlaneSidebars:h,initMobileColumnCountToggle:l}}();leantime.timesheetsController=function(){var r=function(d){document.addEventListener("DOMContentLoaded",function(){var u=document.querySelector("#allTimesheetsTable");if(u){var e=jQuery("#allTimesheetsTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")},buttons:{colvis:leantime.i18n.__("datatables.buttons.colvis"),csv:leantime.i18n.__("datatables.buttons.download")}},dom:'<"top">rt<"bottom"ilp><"clear">',searching:!1,stateSave:!0,displayLength:100}),t=new jQuery.fn.dataTable.Buttons(e,{buttons:[{extend:"csvHtml5",title:leantime.i18n.__("label.filename_fileexport"),charset:"utf-8",bom:!0,exportOptions:{format:{body:function(s,a,l,c){return typeof c.dataset.order<"u"&&(s=c.dataset.order),s}}}},{extend:"colvis",columns:":not(.noVis)"}]}),m=document.querySelector("#tableButtons");m&&m.appendChild(t.container()[0]),jQuery("#allTimesheetsTable").on("column-visibility.dt",function(s,a,l,c){e.draw(!1)})}})},n=function(){var d={sizes:{minW:700,minH:1e3},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(u){u.style.display=""})},afterShowCont:function(){jQuery(".editTimeModal").nyroModal(d)},beforeClose:function(){location.reload()}},titleFromIframe:!0};jQuery(".editTimeModal").nyroModal(d)};return{initTimesheetsTable:r,initEditTimeModal:n}}();leantime.valueCanvasController=leantime.canvasController.createController("value",{nbRows:3});leantime.wikiController=function(){var r=function(n,d){jQuery(n).jstree({core:{expand_selected_onload:!0,themes:{dots:!1}},state:{key:"tree_state"},types:{default:{icon:"far fa-file-alt"}},plugins:["wholerow","types","state"]}),jQuery(n).on("ready.jstree",function(u,e){jQuery(this).jstree("deselect_all"),jQuery(this).jstree("select_node","treenode_"+d,!0),jQuery(this).jstree("save_state")}),jQuery(n).on("activate_node.jstree",function(u,e){jQuery(this).jstree("save_state"),!(e==null||e.node==null||e.node.id==null)&&(window.location.href=e.node.a_attr.href)})};return{initTree:r}}();(function(){var r={duration:3200,close:"",location:"default",style:"success",size:"medium"},n={success:{bg:"var(--green)",color:"#fff",border:"var(--green)"},error:{bg:"var(--red)",color:"#fff",border:"var(--red)"},warning:{bg:"var(--yellow)",color:"#333",border:"var(--yellow)"},notice:{bg:"var(--accent1)",color:"#fff",border:"var(--accent1)"},default:{bg:"var(--secondary-background)",color:"var(--primary-font-color)",border:"var(--main-border-color)"}},d=!1;function u(){if(!d){d=!0;var a=document.createElement("style");a.textContent="#growls-default {  position: fixed; top: 70px; right: 20px; z-index: 100060;  display: flex; flex-direction: column; gap: 8px;  pointer-events: none; max-width: 380px;}.lt-toast {  pointer-events: auto; padding: 12px 36px 12px 16px; border-radius: var(--box-radius, 8px);  box-shadow: var(--regular-shadow, 0 2px 8px rgba(0,0,0,.15)); font-size: var(--font-size-s, 13px);  line-height: 1.4; position: relative; overflow: hidden;  opacity: 0; transform: translateX(30px);  transition: opacity .25s ease, transform .25s ease;}.lt-toast.lt-toast-visible {  opacity: 1; transform: translateX(0);}.lt-toast.lt-toast-outgoing {  opacity: 0; transform: translateX(30px);}.lt-toast-close {  position: absolute; top: 8px; right: 10px; cursor: pointer;  font-size: 18px; line-height: 1; opacity: .7;}.lt-toast-close:hover { opacity: 1; }.lt-toast-title {  font-weight: 600; margin-bottom: 2px;}.lt-toast-message { word-break: break-word; }",document.head.appendChild(a)}}function e(a){var l="growls-"+a,c=document.getElementById(l);return c||(c=document.createElement("div"),c.id=l,document.body.appendChild(c)),c}function t(a){u(),a=a||{};var l={};for(var c in r)l[c]=r[c];for(var h in a)l[h]=a[h];var p=n[l.style]||n.default,v=e(l.location),i=document.createElement("div");i.className="lt-toast",i.style.background=p.bg,i.style.color=p.color,i.style.borderLeft="4px solid "+p.border,i.innerHTML='<div class="lt-toast-close">'+l.close+"</div>"+(l.title?'<div class="lt-toast-title">'+l.title+"</div>":"")+'<div class="lt-toast-message">'+(l.message||"")+"</div>",v.appendChild(i);var o=i.querySelector(".lt-toast-close");o.addEventListener("click",function(w){w.stopPropagation(),S(i)}),i.addEventListener("contextmenu",function(w){w.preventDefault(),S(i)});var f=null;i.addEventListener("mouseenter",function(){f&&(clearTimeout(f),f=null)}),i.addEventListener("mouseleave",function(){T()}),i.offsetHeight,i.classList.add("lt-toast-visible");function T(){f=setTimeout(function(){S(i)},l.duration)}function S(w){f&&(clearTimeout(f),f=null),w.classList.remove("lt-toast-visible"),w.classList.add("lt-toast-outgoing"),w.addEventListener("transitionend",function(){w.parentNode&&w.parentNode.removeChild(w)}),setTimeout(function(){w.parentNode&&w.parentNode.removeChild(w)},500)}T()}var m=window.leantime||(window.leantime={});m.toast={show:t};var s=function(a){return t(a)};s.error=function(a){return a=a||{},a.style="error",a.title=a.title||"Error!",t(a)},s.notice=function(a){return a=a||{},a.style="notice",a.title=a.title||"Notice!",t(a)},s.warning=function(a){return a=a||{},a.style="warning",a.title=a.title||"Warning!",t(a)},window._growlShim=s})();window.leantime=window.leantime||{};window.leantime.companyColor=(document.querySelector("meta[name=theme-color]")||{}).content||null;window.leantime.colorScheme=(document.querySelector("meta[name=color-scheme]")||{}).content||null;window.leantime.theme=(document.querySelector("meta[name=theme]")||{}).content||null;window.leantime.appUrl=(document.querySelector("meta[name=identifier-URL]")||{}).content||null;window.leantime.version=(document.querySelector("meta[name=leantime-version]")||{}).content||null;var J=window.leantime;J.replaceSVGColors=function(){J.companyColor!="#1b75bb"&&document.querySelectorAll("svg > *").forEach(function(r){r.getAttribute("fill")=="#1b75bb"&&r.setAttribute("fill",J.companyColor)})};J.handleAsyncResponse=function(r){r!==void 0&&r.result!==void 0&&r.result.html!==void 0&&document.body.insertAdjacentHTML("beforeend",r.result.html)};document.addEventListener("DOMContentLoaded",function(){J.replaceSVGColors(),document.querySelectorAll(".confetti").forEach(function(d){d.addEventListener("click",function(){confetti.start()})}),tippy("[data-tippy-content]");var r=document.querySelector(".login-alert .alert");if(r&&r.textContent!==""){var n=document.querySelector(".login-alert");n&&(n.style.display="")}document.addEventListener("scroll",function(){document.documentElement.dataset.scroll=window.scrollY})});htmx.onLoad(function(r){tippy("[data-tippy-content]"),J.replaceSVGColors()});window.addEventListener("HTMX.ShowNotification",function(r){fetch(J.appUrl+"/notifications/getLatestGrowl",{credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(n){return n.text()}).then(function(n){var d=JSON.parse(n);d.notification&&d.notification!=="undefined"&&J.toast.show({message:d.notification,style:d.notificationType})})});document.addEventListener("click",function(r){var n=r.target.closest('[data-toggle="dropdown"]');if(document.querySelectorAll(".dropdown.open, .btn-group.open, .inlineDropDownContainer.open, .open > .dropdown-menu").forEach(function(u){var e=u.classList.contains("dropdown-menu")?u.parentElement:u;(!n||!e.contains(n))&&e.classList.remove("open")}),n){r.preventDefault(),r.stopPropagation();var d=n.closest(".dropdown, .btn-group, .inlineDropDownContainer")||n.parentElement;d&&d.classList.toggle("open")}});document.addEventListener("keydown",function(r){r.key==="Escape"&&document.querySelectorAll(".dropdown.open, .btn-group.open, .inlineDropDownContainer.open").forEach(function(n){n.classList.remove("open")})});(function(){var r=document.createElement("style");r.textContent=".modal.in {  display: block !important; position: fixed; top: 0; left: 0; right: 0; bottom: 0;  z-index: 100050; overflow-x: hidden; overflow-y: auto;}.modal .modal-dialog {  position: relative; margin: 60px auto; max-width: 600px;}.modal .modal-dialog.modal-lg { max-width: 900px; }.modal .modal-content {  background: var(--secondary-background, #fff); border-radius: var(--box-radius, 8px);  box-shadow: var(--large-shadow, 0 4px 20px rgba(0,0,0,.2)); padding: 20px;}.modal .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }.modal .modal-header .close { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--primary-font-color); }.modal .modal-body { margin-bottom: 15px; }.modal .modal-footer { display: flex; justify-content: flex-end; gap: 8px; }",document.head.appendChild(r);var n=null;function d(e){e&&(e.style.display="block",e.offsetHeight,e.classList.add("in"),document.body.classList.add("modal-open"),n||(n=document.createElement("div"),n.className="modal-backdrop fade in",n.style.cssText="display:block;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:100049;",document.body.appendChild(n),n.addEventListener("click",function(){var t=document.querySelector(".modal.in");t&&u(t)})))}function u(e){e&&(e.classList.remove("in"),e.style.display="none",document.body.classList.remove("modal-open"),n&&n.parentNode&&(n.parentNode.removeChild(n),n=null))}document.addEventListener("click",function(e){var t=e.target.closest('[data-dismiss="modal"]');if(t){var m=t.closest(".modal");m&&u(m)}}),document.addEventListener("keydown",function(e){if(e.key==="Escape"){var t=document.querySelector(".modal.in");t&&u(t)}}),typeof jQuery<"u"&&(jQuery.fn.modal=function(e){return this.each(function(){e==="show"?d(this):e==="hide"?u(this):e==="toggle"&&(this.classList.contains("in")?u(this):d(this))}),this}),window.leantime=window.leantime||{},leantime.bootstrapModal={show:d,hide:u}})();(function(){function r(n,d){d=d||{};var u=n.querySelectorAll(":scope > ul > li > a"),e=[];if(u.forEach(function(m){var s=m.getAttribute("href");if(s&&s.charAt(0)==="#"){var a=n.querySelector(s);a&&e.push(a)}}),e.length!==0){var t=d.active||0;(typeof t!="number"||t<0||t>=e.length)&&(t=0),e.forEach(function(m,s){m.style.display=s===t?"":"none"}),u.forEach(function(m,s){s===t?m.parentElement.classList.add("ui-tabs-active","ui-state-active","active"):m.parentElement.classList.remove("ui-tabs-active","ui-state-active","active")}),u.forEach(function(m,s){m.addEventListener("click",function(a){a.preventDefault(),e.forEach(function(l){l.style.display="none"}),u.forEach(function(l){l.parentElement.classList.remove("ui-tabs-active","ui-state-active","active")}),e[s]&&(e[s].style.display=""),m.parentElement.classList.add("ui-tabs-active","ui-state-active","active")})}),d.create&&d.create.call(n,{},{tab:u[t],panel:e[t]})}}typeof jQuery<"u"&&(jQuery.fn.tabs=function(n){return this.each(function(){r(this,n)}),this})})();(function(){typeof jQuery>"u"||(jQuery.fn.chosen=function(r){return this.each(function(){var n=this;if(n.tagName==="SELECT"){if(n._slimSelect){try{n._slimSelect.destroy()}catch{}n._slimSelect=null}if(r!=="destroy"&&typeof SlimSelect<"u")try{n._slimSelect=new SlimSelect({select:n,showSearch:n.options&&n.options.length>8,allowDeselect:!n.hasAttribute("required")})}catch{}}}),this})})();leantime.snippets=function(){var r=function(a){var l=document.getElementById(a);l.select(),l.setSelectionRange(0,99999),navigator.clipboard.writeText(l.value),leantime.toast.show({message:leantime.i18n.__("short_notifications.url_copied"),style:"success"})},n=function(a){navigator.clipboard.writeText(a),leantime.toast.show({message:leantime.i18n.__("short_notifications.url_copied"),style:"success"})},d=function(){document.querySelectorAll(".confetti").forEach(function(a){a.addEventListener("click",function(){confetti.start()})})},u=function(a){var l=document.getElementById("accordion_toggle_"+a),c=l?l.querySelector("i.fa"):null,h="accordion_content-"+a,p="closed",v=document.getElementById("accordion_content-"+a);c&&c.classList.contains("fa-angle-right")?(c.classList.remove("fa-angle-right"),c.classList.add("fa-angle-down"),v&&(v.style.display=""),p="open"):c&&(c.classList.remove("fa-angle-down"),c.classList.add("fa-angle-right"),v&&(v.style.display="none"),p="closed");var i=new FormData;i.append("submenu",h),i.append("state",p),fetch(leantime.appUrl+"/api/submenu",{method:"PATCH",body:i,credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"}})},e=function(a){var l=document.getElementById("themeStyleSheet"),c=l.getAttribute("href");a=="light"?(c=c.replace("dark.css","light.css"),l.setAttribute("href",c)):a=="dark"&&(c=c.replace("light.css","dark.css"),l.setAttribute("href",c))},t=function(a){var l=document.getElementById("themeStyleSheet"),c=l.getAttribute("href");a=="minimal"?(c=c.replace("default","minimal"),l.setAttribute("href",c)):a=="default"&&(c=c.replace("minimal","default"),l.setAttribute("href",c))},m=function(a){document.getElementById("fontStyleSetter").innerHTML=":root { --primary-font-family: '"+a+"', 'Helvetica Neue', Helvetica, sans-serif; }"},s=function(a,l){document.getElementById("colorSchemeSetter").innerHTML=":root { --accent1: "+a+"; --accent2: "+l+"}"};return{copyUrl:r,copyToClipboard:n,initConfettiClick:d,accordionToggle:u,toggleTheme:e,toggleFont:m,toggleColors:s,toggleBg:t}}();leantime.modals=function(){var r=!1;function n(){return document.getElementById("global-modal")}function d(){return document.getElementById("global-modal-content")}function u(){return document.getElementById("global-modal-box")}function e(){var y=document.getElementById("modal-blur-overlay");return y||(y=document.createElement("div"),y.id="modal-blur-overlay",y.addEventListener("click",function(){leantime.modals.closeModal()}),document.body.appendChild(y)),y}function t(){e().classList.add("active");var y=document.querySelector(".mainwrapper");y&&y.setAttribute("inert","")}function m(){e().classList.remove("active");var y=document.querySelector(".mainwrapper");y&&y.removeAttribute("inert")}function s(y){return/showTicket|ideaDialog|articleDialog/.test(y)}function a(){var y=d();y&&(y.innerHTML='<div style="display:flex;justify-content:center;align-items:center;padding:60px 40px;"><span class="tw:loading tw:loading-spinner tw:loading-lg"></span></div>')}function l(y){for(var C=y.querySelectorAll("script"),L=0;L<C.length;L++){for(var H=C[L],b=document.createElement("script"),E=0;E<H.attributes.length;E++)b.setAttribute(H.attributes[E].name,H.attributes[E].value);b.textContent=H.textContent,H.parentNode.replaceChild(b,H)}}function c(y){if(/<html[\s>]/i.test(y)||/<!DOCTYPE/i.test(y)){var C=new DOMParser().parseFromString(y,"text/html"),L=C.querySelector(".primaryContent");return L?L.innerHTML:C.body?C.body.innerHTML:y}return y}function h(y){y.querySelectorAll(".showDialogOnLoad").forEach(function(C){C.style.display=""}),window.htmx&&window.htmx.process(y),window.tippy&&tippy(y.querySelectorAll("[data-tippy-content]")),window.leantime&&window.leantime.tiptapController&&typeof window.leantime.tiptapController.initEditors=="function"&&window.leantime.tiptapController.initEditors(y)}function p(y){var C=y.headers.get("HX-Trigger");if(C&&C.indexOf("HTMX.closemodal")!==-1)return C.indexOf("HTMX.ShowNotification")!==-1&&window.dispatchEvent(new CustomEvent("HTMX.ShowNotification")),f(),Promise.resolve(null);var L=y.headers.get("HX-Redirect");return L?(f(),window.location.href=L,Promise.resolve(null)):y.text()}function v(){var y=d();if(y&&window.leantime&&window.leantime.tiptapController&&window.leantime.tiptapController.registry)try{window.leantime.tiptapController.registry.destroyWithin(y)}catch{}}function i(y){if(y!==null){var C=d();C&&(v(),C.innerHTML=c(y),l(C),h(C))}}function o(y){var C=n(),L=u();if(C){s(y)?(L.style.maxWidth="1024px",L.style.width="95vw",L.style.minHeight="80vh"):(L.style.maxWidth="48rem",L.style.width="",L.style.minHeight=""),a(),C.open||(t(),C.show()),r=!0;var H=leantime.appUrl.replace(/\/$/,""),b=y.indexOf("http")===0?y:H+y;fetch(b,{credentials:"include",headers:{"is-modal":"true","X-Requested-With":"XMLHttpRequest"}}).then(p).then(i).catch(function(E){console.error("modalManager: load error",E);var F=d();F&&(F.innerHTML='<div style="padding:24px;text-align:center;"><p>Could not load content.</p></div>')})}}function f(){var y=n();if(y&&r){r=!1,v(),m();try{history.pushState("",document.title,window.location.pathname+window.location.search)}catch{}if(y.open&&y.close(),typeof window.globalModalCallback=="function"){var C=window.globalModalCallback;window.globalModalCallback=null,C()}else location.reload()}}var T=function(){var y=window.location.hash.substring(1);if(y){var C=y.split("/");C.length>2&&C[1]!=="tab"&&o(y)}},S=function(){f()},w=function(y){typeof y=="function"&&(window.globalModalCallback=y)},D=function(y){var C=leantime.appUrl.replace(/\/$/,""),L=y;y.indexOf(C)===0&&(L=y.substring(C.length)),o(L)};return{openModal:T,setCustomModalCallback:w,closeModal:S,openByUrl:D,renderContent:i}}();document.addEventListener("DOMContentLoaded",function(){leantime.modals.openModal(),document.addEventListener("click",function(n){var d=n.target.closest('a[href^="#/"], a.formModal, a.ticketModal');if(d){var u=d.getAttribute("href");if(u){if(u.indexOf("#/")===0){n.preventDefault(),n.stopPropagation(),window.globalModalCallback=function(){location.reload()};var e=u.substring(1);try{history.pushState("",document.title,window.location.pathname+window.location.search+u)}catch{}leantime.modals.openByUrl(e)}else if(d.classList.contains("formModal")||d.classList.contains("ticketModal")){if(u.indexOf("javascript:")===0)return;n.preventDefault(),n.stopPropagation(),window.globalModalCallback=function(){location.reload()},leantime.modals.openByUrl(u)}}}},!0);var r=document.getElementById("global-modal");r&&(r.addEventListener("keydown",function(n){n.key==="Escape"&&(n.preventDefault(),leantime.modals.closeModal())}),r.addEventListener("cancel",function(n){n.preventDefault(),leantime.modals.closeModal()}),r.addEventListener("close",function(){leantime.modals.closeModal()})),document.addEventListener("submit",function(n){var d=n.target;if(!(!d||!d.closest||!d.closest("#global-modal-content"))&&d.getAttribute("method")!=="dialog"&&!(d.hasAttribute("hx-post")||d.hasAttribute("hx-get")||d.hasAttribute("hx-put")||d.hasAttribute("hx-delete"))){n.preventDefault();var u=(d.getAttribute("method")||"GET").toUpperCase(),e=d.getAttribute("action")||window.location.href;document.getElementById("global-modal-content");var t={method:u,credentials:"include",headers:{"is-modal":"true","X-Requested-With":"XMLHttpRequest"}};if(u==="POST")t.body=new FormData(d);else{var m=new URLSearchParams(new FormData(d));e+=(e.indexOf("?")===-1?"?":"&")+m.toString()}fetch(e,t).then(function(s){var a=s.headers.get("HX-Trigger");if(a&&a.indexOf("HTMX.closemodal")!==-1)return a.indexOf("HTMX.ShowNotification")!==-1&&window.dispatchEvent(new CustomEvent("HTMX.ShowNotification")),leantime.modals.closeModal(),null;var l=s.headers.get("HX-Redirect");return l?(leantime.modals.closeModal(),window.location.href=l,null):s.text()}).then(function(s){leantime.modals.renderContent(s)}).catch(function(s){console.error("modalManager: form submit error",s)})}},!0)});window.addEventListener("hashchange",function(){leantime.modals.openModal()});window.addEventListener("closeModal",function(){leantime.modals.closeModal()});document.addEventListener("HTMX.closemodal",function(){leantime.modals.closeModal()});leantime.modals.nmManual=function(r,n){typeof n=="function"&&(n=n()),n&&n.callbacks&&typeof n.callbacks.beforeClose=="function"&&(window.globalModalCallback=n.callbacks.beforeClose),leantime.modals.openByUrl(r)};leantime.modals.nmTop=function(){return{close:function(){leantime.modals.closeModal()},elts:{cont:document.getElementById("global-modal-box"),bg:document.querySelector("#global-modal .tw\\:modal-backdrop"),load:document.querySelector("#global-modal .tw\\:loading"),all:document.getElementById("global-modal")}}};leantime.modals.initNyroModal=function(r,n){r instanceof HTMLElement&&(r=[r]),Array.prototype.forEach.call(r,function(d){if(!d.dataset.modalManagerInit){d.dataset.modalManagerInit="true",n&&n.callbacks&&(d._modalManagerOpts=n);var u=d.getAttribute("href");u&&d.addEventListener("click",function(e){if(e.preventDefault(),e.stopPropagation(),n&&n.callbacks&&typeof n.callbacks.beforeClose=="function"&&(window.globalModalCallback=n.callbacks.beforeClose),u.indexOf("#")===0){var t=u.substring(1);try{history.pushState("",document.title,window.location.pathname+window.location.search+u)}catch{}leantime.modals.openByUrl(t)}else leantime.modals.openByUrl(u)})}})};typeof jQuery<"u"&&(jQuery.nmManual=leantime.modals.nmManual,jQuery.nmTop=leantime.modals.nmTop,jQuery.fn.nyroModal=function(r){return leantime.modals.initNyroModal(this.toArray(),r),this});leantime.dateController=function(){function r(u){var e=leantime.i18n.__("language.dayNames").split(",");leantime.i18n.__("language.dayNamesShort").split(",");var t=leantime.i18n.__("language.dayNamesMin").split(","),m=leantime.i18n.__("language.monthNames").split(","),s=leantime.i18n.__("language.monthNamesShort").split(","),a=parseInt(leantime.i18n.__("language.firstDayOfWeek"),10)||0;return{dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","flatpickr"),locale:{firstDayOfWeek:a,weekdays:{shorthand:t,longhand:e},months:{shorthand:s,longhand:m}},allowInput:!0,onChange:u?function(l,c,h){u.call(h.input,c,h)}:void 0}}var n=function(u,e,t){var m=typeof u=="string"?document.querySelector(u):u,s=typeof e=="string"?document.querySelector(e):e;if(!(!m||!s)&&!(m.hasAttribute("readonly")||s.hasAttribute("readonly"))){var a=r();a.onChange=function(p){p.length>0&&(h.set("minDate",p[0]),s.value||h.setDate(p[0],!0))};var l=r();l.onChange=function(p){p.length>0&&c.set("maxDate",p[0])};var c=flatpickr(m,a),h=flatpickr(s,l)}},d=function(u,e){var t=typeof u=="string"?document.querySelectorAll(u):u?[u]:[];t.forEach(function(m){if(m&&!m.hasAttribute("readonly")){var s=(m.value||"").trim(),a=s&&!/\d/.test(s);a&&(m.setAttribute("placeholder",s),m.value=""),flatpickr(m,r(e))}})};return{initDateRangePicker:n,initDatePicker:d,getBaseDatePickerConfig:r}}();(function(){if(!(typeof jQuery>"u")){var r=new WeakMap;jQuery.datepicker=jQuery.datepicker||{},jQuery.datepicker.setDefaults=function(){},jQuery.datepicker.parseDate=function(n,d){if(!d)return null;var u=leantime.dateHelper.getFormatFromSettings("dateformat","flatpickr");return flatpickr.parseDate(d,u)},jQuery.datepicker.formatDate=function(n,d){if(!d)return"";var u=leantime.dateHelper.getFormatFromSettings("dateformat","flatpickr");return flatpickr.formatDate(d,u)},jQuery.fn.datepicker,jQuery.fn.datepicker=function(n,d){return this.each(function(){var u=this;if(typeof n=="string"){var e=r.get(u);if(!e)return;if(n==="option"||n==="setDate")if(d==="minDate"||n==="setDate"){var t=arguments.length>2?arguments[2]:d;n==="setDate"?e.setDate(t,!0):e.set("minDate",t)}else d==="maxDate"&&e.set("maxDate",arguments[2]);return}if(!u.hasAttribute("readonly")){var m=leantime.dateController.getBaseDatePickerConfig();n&&n.onSelect&&(m.onChange=function(a,l,c){n.onSelect.call(u,l,c)});var s=flatpickr(u,m);r.set(u,s)}})}}})();leantime.dateHelper=function(){var r={jquery:{},luxon:{},flatpickr:{}};r.jquery={d:"dd",D:"D",j:"d",l:"DD",N:"",S:"",w:"",z:"o",W:"",F:"MM",m:"mm",M:"M",n:"m",t:"",L:"",o:"yy",Y:"yy",y:"y",a:"",A:"",B:"",g:"",G:"",h:"",H:"",i:"",s:"",u:"",e:"",I:"",O:"",P:"",T:"",Z:"",c:"",r:"",U:"@"},r.flatpickr={d:"d",D:"D",j:"j",l:"l",N:"",S:"",w:"w",z:"",W:"W",F:"F",m:"m",M:"M",n:"n",t:"",L:"",o:"Y",Y:"Y",y:"y",a:"K",A:"K",B:"",g:"G",G:"H",h:"h",H:"H",i:"i",s:"S",u:"",e:"",I:"",O:"",P:"",T:"",Z:"Z",c:"",r:"",U:"U"},r.luxon={d:"dd",D:"ccc",j:"d",l:"cccc",N:"c",S:"",w:"c",z:"o",W:"WW",F:"MMMM",m:"LL",M:"LLL",n:"L",t:"",L:"",o:"kk",Y:"yyyy",y:"yy",a:"a",A:"a",B:"",g:"h",G:"H",h:"hh",H:"HH",i:"mm",s:"ss",u:"SSS",v:"SSS",e:"z",I:"",O:"ZZ",P:"ZZ",T:"ZZZ",Z:"",c:"",r:"",U:"X"};var n=function(u,e){let t=r[e],m="";return u.split("").forEach(function(s){t[s]!==void 0?m=m+""+t[s]:m=m+""+s}),m},d=function(u,e){let t=leantime.i18n.__("language."+u);return n(t,e)};return{mapFormat:n,getFormatFromSettings:d}}();leantime.authController=function(){var r=function(n){typeof n===void 0&&(n="body"),jQuery(n).find("input").not(".filterBar input").prop("readonly",!0),jQuery(n).find("input").not(".filterBar input").prop("disabled",!0),jQuery(n).find("select").not(".filterBar select, .mainSprintSelector").prop("readonly",!0),jQuery(n).find("select").not(".filterBar select, .mainSprintSelector").prop("disabled",!0),jQuery(n).find("textarea").not(".filterBar textarea").prop("disabled",!0),jQuery(n).find("a.delete").remove(),jQuery(n).find(".quickAddLink").hide(),jQuery(n).find(".tiptap-editor").length&&window.leantime&&window.leantime.tiptapController&&jQuery(n).find(".tiptap-editor").each(function(){var d=leantime.tiptapController.registry.get(this);d&&d.setEditable(!1)}),jQuery(n).find(".tiptap-toolbar").hide(),jQuery(n).find(".ticketDropdown a").removeAttr("data-toggle"),jQuery("#mainToggler").hide(),jQuery(".commentBox").hide(),jQuery(".deleteComment, .replyButton").hide(),jQuery(n).find(".dropdown i").removeClass("fa-caret-down")};return{makeInputReadonly:r}}();leantime.commentsController=function(){var r=function(){jQuery(".commentBox").show(),jQuery("#comments .replies .commentBox").hide(),jQuery(".deleteComment, .replyButton").show(),jQuery(".commentReply .tiptap-wrapper").each(function(){var d=jQuery(this).find(".tiptap-editor")[0];if(d&&window.leantime&&window.leantime.tiptapController){var u=leantime.tiptapController.registry.get(d);u&&u.setEditable(!0)}}),jQuery(".commentReply .tiptap-toolbar").show(),jQuery(".commenterFields input").prop("readonly",!1),jQuery(".commenterFields input").prop("disabled",!1),jQuery(".commenterFields textarea").prop("readonly",!1),jQuery(".commenterFields textarea").prop("disabled",!1)},n=function(d){d==0?jQuery("#mainToggler").hide():jQuery("#mainToggler").show(),window.leantime&&window.leantime.tiptapController&&window.leantime.tiptapController.registry&&jQuery(".commentBox .tiptap-editor").each(function(){leantime.tiptapController.registry.destroy(this)}),jQuery(".commentBox .tiptap-wrapper").remove(),jQuery(".commentBox textarea").remove(),jQuery(".commentBox").hide("fast",function(){}),jQuery("#comment"+d+" .commentReply").prepend('<textarea rows="5" cols="75" name="text" class="tiptapSimple"></textarea>'),window.leantime&&window.leantime.tiptapController&&leantime.tiptapController.initSimpleEditor(),jQuery("#comment"+d).show("fast"),jQuery("#father").val(d)};return{enableCommenterForms:r,toggleCommentBoxes:n}}();leantime.ticketsController=function(){function r(){let j=[];jQuery(".sortableTicketList").each(function(_){jQuery(this).find(".column").each(function(g){j[g]===void 0&&(j[g]=0);var k=jQuery(this).find(".moveable").length;j[g]+=k})}),jQuery(".widgettitle .count").each(function(_){jQuery(this).text(j[_])})}function n(){jQuery(".kanban-swimlane-row").each(function(){var j=jQuery(this),_=j.attr("id");if(_){_.replace("swimlane-row-","");var g=j.find(".kanban-swimlane-content"),k=g.find(".moveable").length,Q=j.find(".kanban-swimlane-sidebar");Q.find(".kanban-lane-count").text(k);var x=Q.attr("aria-label")||"",M=x.replace(/\d+ tasks/,k+" tasks");Q.attr("aria-label",M)}}),d()}function d(){jQuery(".kanban-swimlane-row").each(function(){var j=jQuery(this),_=j.find(".kanban-swimlane-content"),g=j.find(".micro-progress-bar .progress-segments");if(g.length){var k={},Q=0;_.find(".contentInner").each(function(){var M=jQuery(this),q=M.attr("class")||"",A=q.match(/status_(-?\d+)/);if(A){var P=A[1],R=M.find(".moveable").length;R>0&&(k[P]=R,Q+=R)}});var x=g.find(".status-segment");if(Q===0){x.css("flex","0 1 0%").find(".segment-count").text(""),x.attr("data-tippy-content","");return}x.each(function(){var M=jQuery(this),q=M.attr("class");if(q){var A=q.match(/status-(-?\d+)/);if(A){var P=A[1],R=k[P]||0,U=R/Q*100;M.css("flex",U+" 1 0%");var O=M.find(".segment-count");O.length&&O.text(R>0?R:"");var B=M.attr("data-tippy-content")||"",N=B.match(/^([^:]+):/),ee=N?N[1]:"Status "+P;M.attr("data-tippy-content",R>0?ee+": "+R:"")}}})}})}var u=function(j,_){var g=jQuery("#ticket_"+j);if(!g.length){console.warn("Card not found for ticket ID:",j);return}var k=g.closest(".contentInner"),Q=k.attr("class")||"",x=Q.match(/status_(\d+)/);if(!x){console.warn("Could not determine status for ticket:",j),location.reload();return}var M=x[1],q=jQuery("#kanboard-"+_+" .contentInner.status_"+M);if(!q.length){console.warn("Target swimlane not found:",_,M),location.reload();return}k[0]!==q[0]&&(g.addClass("card-moving-out"),setTimeout(function(){g.detach().appendTo(q),g.removeClass("card-moving-out").addClass("card-moving-in"),r(),n(),q.sortable&&q.sortable("refresh"),setTimeout(function(){g.removeClass("card-moving-in")},300)},200))},e=function(j,_){var g=jQuery(j).val();leantime.ticketsRepository.updateRemainingHours(_,g,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.remaining_hours_updated"),style:"success"})})},t=function(j,_){var g=jQuery(j).val();leantime.ticketsRepository.updatePlannedHours(_,g,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.planned_hours_updated"),style:"success"})})},m=function(){jQuery(".filterBar").toggle()},s=function(j,_,g){function k(Q){return String(Q).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}jQuery(document).ready(function(){if(g===!1)var Q=new Gantt("#gantt",j,{header_height:55,column_width:20,step:24,view_modes:["Day","Week","Month"],bar_height:40,static_progress_indicator:!0,bar_corner_radius:10,arrow_curve:10,padding:20,view_mode:"Month",date_format:leantime.i18n.__("language.momentJSDate"),language:leantime.i18n.__("language.code").slice(0,2),additional_rows:5,custom_popup_html:function(x){var M=x._end,q=jQuery.datepicker.formatDate(leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),new Date(M)),A='<div class="details-container" style="min-width:600px;"> ';return x.projectName!==void 0&&(A+="<h3><b>"+x.projectName+"</b></h3>"),A+="<small>"+x.type+" #"+x.id+" </small>",x.type==="milestone"?A+='<h4><a href="#/tickets/editMilestone/'+x.id+'" >'+k(x.name)+"</a></h4><br /> <p>"+leantime.i18n.__("text.expected_to_finish_by")+" <strong>"+q+"</strong><br /> "+Math.round(x.progress)+'%</p> <a href="#/tickets/editMilestone/'+x.id+'" ><span class="fa fa-map"></span> '+leantime.i18n.__("links.edit_milestone")+'</a> | <a href="'+leantime.appUrl+"/tickets/showKanban?milestone="+x.id+'"><span class="fa-pushpin"></span> '+leantime.i18n.__("links.view_todos")+"</a> ":A+='<h4><a href="#/tickets/showTicket/'+x.id+'">'+k(x.name)+'</a></h4><br /> <a href="#/tickets/showTicket/'+x.id+'"><span class="fa fa-thumb-tack"></span> '+leantime.i18n.__("links.edit_todo")+"</a> ",A+="</div>",A},on_click:function(x){},on_date_change:function(x,M,q){leantime.ticketsRepository.updateMilestoneDates(x.id,M,q,x._index+1)},on_sort_change:function(x){for(var M={action:"ganttSort",payload:{}},q=0;q<x.length;q++)M.payload[x[q].id]=x[q]._index+1;jQuery.ajax({type:"POST",url:leantime.appUrl+"/api/tickets",data:M})},on_progress_change:function(x,M){},on_view_change:function(x){leantime.usersRepository.updateUserViewSettings("roadmap",x)},on_popup_show:function(x){}});else var Q=new Gantt("#gantt",j,{readonlyGantt:!0,resizing:!1,progress:!1,is_draggable:!1,custom_popup_html:function(M){var q=M._end,A=jQuery.datepicker.formatDate(leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),new Date(q)),P='<div class="details-container" style="min-width:600px;"> ';return M.projectName!==void 0&&(P+="<h3><b>"+M.projectName+"</b></h3>"),P+="<small>"+M.type+" #"+M.id+" </small>",M.type==="milestone"?P+="<h4>"+k(M.name)+"</h4><br /> <p>"+leantime.i18n.__("text.expected_to_finish_by")+" <strong>"+A+"</strong><br /> "+Math.round(M.progress)+'%</p> <a href="'+leantime.appUrl+"/tickets/showKanban?milestone="+M.id+'"><span class="fa-pushpin"></span> '+leantime.i18n.__("links.view_todos")+"</a> ":P+='<h4><a href="#/tickets/showTicket/'+M.id+'">'+k(M.name)+'</a></h4><br /> <a href="#/tickets/showTicket/'+M.id+'"><span class="fa fa-thumb-tack"></span> '+leantime.i18n.__("links.edit_todo")+"</a> ",P+="</div>",P},on_click:function(M){},on_date_change:function(M,q,A){},on_progress_change:function(M,q){},on_view_change:function(M){leantime.usersRepository.updateUserViewSettings("roadmap",M)}});jQuery("#ganttTimeControl").on("click","a",function(){var x=jQuery(this),M=x.attr("data-value");Q.change_view_mode(M),x.parent().parent().find("a").removeClass("active"),x.addClass("active");var q=x.text();jQuery(".viewText").text(q)}),Q.change_view_mode(_)})},a=function(){Date.prototype.addDays=function(Q){return this.setDate(this.getDate()+Q),this},jQuery.datepicker.setDefaults({beforeShow:function(Q){if(jQuery(Q).attr("readonly"))return!1}});var j=leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),_=jQuery("#sprintStart").datepicker({numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){g.datepicker("option","minDate",k(this));var Q=k(this).addDays(13);g.datepicker("setDate",Q)}),g=jQuery("#sprintEnd").datepicker({defaultDate:"+1w",numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){_.datepicker("option","maxDate",k(this))});function k(Q){var x;try{x=jQuery.datepicker.parseDate(j,Q.value)}catch(M){x=null,console.log(M)}return x}},l=function(){var j=leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),_=jQuery("#milestoneEditFrom").datepicker({numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){g.datepicker("option","minDate",k(this))}),g=jQuery("#milestoneEditTo").datepicker({defaultDate:"+1w",numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){_.datepicker("option","maxDate",k(this))});function k(Q){var x;try{x=jQuery.datepicker.parseDate(j,Q.value)}catch(M){x=null,console.log(M)}return x}},c=function(){var j=leantime.dateHelper.getFormatFromSettings("dateformat","jquery");jQuery(".milestoneEditFromAsync").datepicker({numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){var g=jQuery(this).val(),k=jQuery(this).attr("data-id"),Q=jQuery(".toDateTicket-"+k);Q.datepicker("option","minDate",_(this)),jQuery(".toDateTicket-"+k).val(),leantime.ticketsRepository.updateEditFromDates(k,g,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.date_updated"),style:"success"})})}),jQuery(".milestoneEditToAsync").datepicker({defaultDate:"+1w",numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){var g=jQuery(this).attr("data-id"),k=jQuery(".fromDateTicket-"+g);k.datepicker("option","maxDate",_(this));var Q=jQuery(this).val();jQuery(".fromDateTicket-"+g).val(),leantime.ticketsRepository.updateEditToDates(g,Q,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.date_updated"),style:"success"})})});function _(g){var k;try{k=jQuery.datepicker.parseDate(j,g.value)}catch(Q){k=null,console.log(Q)}return k}},h=function(){jQuery('[data-toggle="tooltip"]').tooltip()},p=function(){var j={"0.5":"< 2min",1:"XS",2:"S",3:"M",5:"L",8:"XL",13:"XXL"};jQuery(".effortDropdown .dropdown-menu a").unbind().on("click",function(){var _=jQuery(this).attr("data-value").split("_");if(_.length===2){var g=_[0],k=_[1];jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:g,storypoints:k}}).done(function(){jQuery("#effortDropdownMenuLink"+g+" span.text").text(j[k]),jQuery.growl({message:leantime.i18n.__("short_notifications.effort_updated"),style:"success"}),leantime.kanbanGroupBy==="storypoints"&&u(g,k)})}else console.log("Ticket Controller: Effort data value not set correctly")})},v=function(){var j={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Lowest"};jQuery(".priorityDropdown .dropdown-menu a").unbind().on("click",function(){var _=jQuery(this).attr("data-value").split("_");if(_.length===2){var g=_[0],k=_[1];jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:g,priority:k}}).done(function(){jQuery("#priorityDropdownMenuLink"+g+" span.text").text(j[k]),jQuery("#priorityDropdownMenuLink"+g).removeClass("priority-bg-1 priority-bg-2 priority-bg-3 priority-bg-4 priority-bg-5"),jQuery("#priorityDropdownMenuLink"+g).addClass("priority-bg-"+k),jQuery("#priorityDropdownMenuLink"+g).parents(".ticketBox").removeClass("priority-border-1 priority-border-2 priority-border-3 priority-border-4 priority-border-5"),jQuery("#priorityDropdownMenuLink"+g).parents(".ticketBox").addClass("priority-border-"+k),jQuery.growl({message:leantime.i18n.__("short_notifications.priority_updated"),style:"success"}),leantime.kanbanGroupBy==="priority"&&u(g,k)})}else console.log("Ticket Controller: Priority data value not set correctly")})},i=function(){jQuery(".milestoneDropdown .dropdown-menu a").unbind().on("click",function(){var j=jQuery(this).attr("data-value").split("_"),_=jQuery(this).attr("data-label");if(j.length===3){var g=j[0],k=j[1],Q=j[2];jQuery("#milestoneDropdownMenuLink"+g+" span.text").append(" ..."),jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:g,milestoneid:k}}).done(function(){jQuery("#milestoneDropdownMenuLink"+g+" span.text").text(_),jQuery("#milestoneDropdownMenuLink"+g).css("backgroundColor",Q),jQuery.growl({message:leantime.i18n.__("short_notifications.milestone_updated"),style:"success"}),leantime.kanbanGroupBy==="milestoneid"&&u(g,k)})}})},o=function(){jQuery(".statusDropdown .dropdown-menu a").unbind().on("click",function(){var j=jQuery(this).attr("data-value").split("_"),_=jQuery(this).attr("data-label");if(j.length==3){var g=j[0],k=j[1],Q=j[2];jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:g,status:k}}).done(function(x){jQuery("#statusDropdownMenuLink"+g+" span.text").text(_),jQuery("#statusDropdownMenuLink"+g).removeClass().addClass(Q+" dropdown-toggle f-left status "),jQuery.growl({message:leantime.i18n.__("short_notifications.status_updated"),style:"success"}),leantime.handleAsyncResponse(x)})}})},f=function(){jQuery(".userDropdown .dropdown-menu a").unbind().on("click",function(){var j=jQuery(this).attr("data-value").split("_"),_=jQuery(this).attr("data-label");if(j.length===3){var g=j[0],k=j[1];j[2],jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:g,editorId:k}}).done(function(){jQuery("#userDropdownMenuLink"+g+" span.text span#userImage"+g+" img").attr("src",leantime.appUrl+"/api/users?profileImage="+k),jQuery("#userDropdownMenuLink"+g+" span.text span#user"+g).text(_),jQuery.growl({message:leantime.i18n.__("short_notifications.user_updated"),style:"success"}),leantime.kanbanGroupBy==="editorId"&&u(g,k)})}})},T=function(){jQuery(".asyncInputUpdate").on("change",function(){var j=jQuery(this).attr("data-label").split("-");if(j.length==2){var _=j[0],g=j[1],k=jQuery(this).val();jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:g,[_]:k}}).done(function(){jQuery.growl({message:leantime.i18n.__("notifications.subtask_saved"),style:"success"})})}})},S=function(){jQuery(".sprintDropdown .dropdown-menu a").unbind().on("click",function(){var j=jQuery(this).attr("data-value").split("_"),_=jQuery(this).attr("data-label");if(j.length==2){var g=j[0],k=j[1];jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:g,sprint:k}}).done(function(){jQuery("#sprintDropdownMenuLink"+g+" span.text").text(_),jQuery.growl({message:leantime.i18n.__("short_notifications.sprint_updated"),style:"success"}),leantime.kanbanGroupBy==="sprint"&&u(g,k)})}})},w=function(){var j=["#821219","#BB1B25","#75BB1B","#4B7811","#fdab3d","#1bbbb1","#006d9f","#124F7D","#082236","#5F0F40","#bb1b75","#F26CA7","#BB611B","#aaaaaa","#4c4c4c"];jQuery("input.simpleColorPicker").simpleColorPicker({colors:j,onChangeColor:function(g){jQuery(this).css("background",g),jQuery(this).css("color","#fff")}});var _=jQuery("input.simpleColorPicker").val();_!=""&&jQuery("input.simpleColorPicker").css("background",_)},D=function(){jQuery(".date-picker-form-control .reset-button").on("click",function(){const j=jQuery(this).attr("data-id");jQuery("#due-date-picker-"+j).val(leantime.i18n.__("text.anytime")),leantime.ticketsRepository.updateDueDates(j,null,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.duedate_updated"),style:"success"})})}),leantime.dateController.initDatePicker(".quickDueDates, .duedates",function(j,_){var g=_.currentDay,k=_.currentMonth,Q=_.currentYear,x=new Date(Q,k,g),M=jQuery.datepicker.formatDate(leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),x),q=jQuery(this).attr("data-id");leantime.ticketsRepository.updateDueDates(q,M,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.duedate_updated"),style:"success"})})})},y=function(j,_,g,k){var Q=document.getElementById(k).getContext("2d");new Chart(Q,{type:"line",data:{labels:j,datasets:[{label:leantime.i18n.__("label.booked_hours"),backgroundColor:"rgba(201,48,44, 0.5)",borderColor:"rgb(201,48,44)",data:_},{label:leantime.i18n.__("label.planned_hours"),backgroundColor:"rgba(54, 162, 235, 0.5)",borderColor:"rgb(54, 162, 235)",data:g}]},options:{scales:{x:{display:!0,title:{display:!0,text:leantime.i18n.__("label.booked_hours")},type:"time",time:{unit:"day"}},y:{display:!0,title:{display:!0,text:leantime.i18n.__("label.planned_hours")},ticks:{beginAtZero:!0}}}}})},C=function(){jQuery(document).ready(function(){let j=new URL(window.location.href),_=j.searchParams.get("tab"),g=0;_&&(g=jQuery(".ticketTabs").find('a[href="#'+_+'"]').parent().index()),jQuery(".ticketTabs").tabs({create:function(k,Q){jQuery(".ticketTabs").css("visibility","visible")},activate:function(k,Q){j=new URL(window.location.href),j.searchParams.set("tab",Q.newPanel[0].id),window.history.replaceState(null,null,j)},load:function(){},enable:function(){},active:g})})},L=function(j){jQuery("#ticketSearch").on("submit",function(_){_.preventDefault();var g=jQuery("#projectIdInput").val(),k=jQuery("#userSelect").val(),Q=jQuery("#milestoneSelect").val(),x=jQuery("#termInput").val(),M=jQuery("#sprintSelect").val(),q=jQuery("#typeSelect").val(),A=jQuery("#prioritySelect").val(),P=jQuery("#statusSelect").val(),R=jQuery("#sortBySelect").val(),U=jQuery("input[name='groupBy']:checked").val(),O=jQuery("input[name='showTasks']:checked").val(),B="?search=true";g!=""&&g!=null&&(B=B+"&projectId="+g),k!=""&&k!=null&&(B=B+"&users="+k),Q!=""&&Q!=null&&(B=B+"&milestone="+Q),x!=""&&x!=null&&(B=B+"&term="+x),M!=""&&M!=null&&(B=B+"&sprint="+M),q!=""&&q!=null&&(B=B+"&type="+q),A!=""&&A!=null&&(B=B+"&priority="+A),P!=""&&P!=null&&(B=B+"&status="+P),R!=""&&R!=null&&(B=B+"&sort="+R),U!=""&&U!=null&&(B=B+"&groupBy="+U),O!=""&&O!=null&&(B=B+"&showTasks="+O);var N=j+B;window.location.href=N})},H=function(j){var _=jQuery("#projectIdInput").val(),g=jQuery("#userSelect").val(),k=jQuery("#milestoneSelect").val(),Q=jQuery("#termInput").val(),x=jQuery("#sprintSelect").val(),M=jQuery("#typeSelect").val(),q=jQuery("#prioritySelect").val(),A=jQuery("#statusSelect").val(),P=jQuery("#sortBySelect").val(),R=jQuery("input[name='groupBy']:checked").val(),U="?search=true";_!=""&&_!=null&&(U=U+"&projectId="+_),g!=""&&g!=null&&(U=U+"&users="+g),k!=""&&k!=null&&(U=U+"&milestone="+k),Q!=""&&Q!=null&&(U=U+"&term="+Q),x!=""&&x!=null&&(U=U+"&sprint="+x),M!=""&&M!=null&&(U=U+"&type="+M),q!=""&&q!=null&&(U=U+"&priority="+q),A!=""&&A!=null&&(U=U+"&status="+A),P!=""&&P!=null&&(U=U+"&sort="+P),R!=""&&R!=null&&(U=U+"&groupBy="+R);var O=j+U;window.location.href=O},b=function(){jQuery(document).ready(function(){r(),n(),jQuery(".filterBar .row-fluid").css("opacity","1"),jQuery(".sortableTicketList").each(function(){let j=jQuery(this).attr("id");var _=jQuery(this).closest(".kanban-swimlane-row");if(_.length&&_.attr("data-expanded")==="false")return;let g=250;jQuery(this).find(".column .contentInner").each(function(){jQuery(this).height()>g&&(g=jQuery(this).height())}),jQuery("#"+j+" .column .contentInner").css("height",g)})})},E=function(j){var _=j;jQuery(".sortableTicketList.kanbanBoard .ticketBox").hover(function(){jQuery(this).css("background","var(--kanban-card-hover)")},function(){jQuery(this).css("background","var(--kanban-card-bg)")}),jQuery(".sortableTicketList").each(function(){var k=this;jQuery(k).find(".contentInner").sortable({connectWith:".contentInner",items:"> .moveable",tolerance:"intersect",placeholder:"ui-state-highlight",forcePlaceholderSize:!0,cancel:".portlet-toggle,:input,a,input",distance:10,start:function(Q,x){x.item.addClass("tilt"),g(x.item);var M=x.item.closest(".sortableTicketList.kanbanBoard");x.item.data("originalSwimlaneId",M.attr("id"))},stop:function(Q,x){x.item.removeClass("tilt"),jQuery("html").unbind("mousemove",x.item.data("move_handler")),x.item.removeData("move_handler"),r(),n(),jQuery(".sortableTicketList").find(".contentInner").each(function(){var G=jQuery(this),ge=G.find(".moveable").length>0;if(ge){G.removeClass("empty-column"),G.attr("data-empty-text","");var Qe=G.attr("aria-label")||"";G.attr("aria-label",Qe.replace("Empty column","")+" column items")}else G.addClass("empty-column"),G.attr("data-empty-text","Empty"),G.attr("aria-label","Empty column")});var M=x.item.closest(".sortableTicketList.kanbanBoard"),q=M.attr("id"),A=x.item.data("originalSwimlaneId");if(A&&q&&A!==q){var P=x.item[0].id.replace("ticket_",""),R=q.replace("kanboard-",""),U={milestoneid:"milestoneid",editorId:"editorId",priority:"priority",storypoints:"storypoints",sprint:"sprint",dueDate:"dateToFinish"},O=leantime.kanbanGroupBy,B=U[O];if(O==="dueDate"){var N=new Date;switch(N.setHours(12,0,0,0),R){case"0":var ee=new Date(N);ee.setDate(ee.getDate()-1),R=ee.toISOString().split("T")[0];break;case"1":var z=new Date(N),Y=6-z.getDay();Y<0&&(Y=0),z.setDate(z.getDate()+Y),R=z.toISOString().split("T")[0];break;case"2":var re=new Date(N),K=6-re.getDay()+7;re.setDate(re.getDate()+K),R=re.toISOString().split("T")[0];break;case"3":var $=new Date(N);$.setDate($.getDate()+21),R=$.toISOString().split("T")[0];break;case"4":R="";break}}if(B&&P){var te=jQuery("#ticket_"+P);if(O==="milestoneid"){var ae=jQuery("#swimlane-row-"+R+" .swimlane-header-label"),Le=ae.text()||leantime.i18n.__("label.no_milestone"),ye=te.find(".milestoneDropdown .dropdown-toggle .text");ye.length&&ye.text(Le);var me=te.find('.milestoneDropdown .dropdown-menu a[data-value^="'+P+"_"+R+'_"]'),ne="#b0b0b0";if(me.length&&R!=="0"&&R!==""){var he=me.attr("data-value");if(he){var ve=he.split("_");ve.length>=3&&(ne=ve.slice(2).join("_"))}if(!ne||ne==="#b0b0b0"){var be=me.attr("style");if(be){var we=be.match(/background-color:\s*([^;]+)/i);we&&(ne=we[1].trim())}}}te.find(".milestoneDropdown .dropdown-toggle").css("background-color",ne)}else if(O==="priority"){te.removeClass(function(G,ge){return(ge.match(/(^|\s)priority-border-\S+/g)||[]).join(" ")}).addClass("priority-border-"+R);var je={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Lowest"},le=jQuery("#priorityDropdownMenuLink"+P);le.length&&(le.find("span.text").text(je[R]||R),le.removeClass("priority-bg-1 priority-bg-2 priority-bg-3 priority-bg-4 priority-bg-5"),le.addClass("priority-bg-"+R))}else if(O==="editorId"){var fe=jQuery("#userDropdownMenuLink"+P);if(fe.length){fe.find("span.text span img").attr("src",leantime.appUrl+"/api/users?profileImage="+R);var ae=jQuery("#swimlane-row-"+R+" .swimlane-header-label"),De=ae.text()||leantime.i18n.__("label.not_assigned");fe.find("span.text span#user"+P).text(De)}}else if(O==="storypoints"){var Me={"0.5":"< 2min",1:"XS",2:"S",3:"M",5:"L",8:"XL",13:"XXL"},_e=jQuery("#effortDropdownMenuLink"+P);_e.length&&_e.find("span.text").text(Me[R]||R)}else if(O==="sprint"){var ke=jQuery("#sprintDropdownMenuLink"+P);if(ke.length){var ae=jQuery("#swimlane-row-"+R+" .swimlane-header-label"),Ee=ae.text()||leantime.i18n.__("label.backlog");ke.find("span.text").text(Ee)}}else if(O==="dueDate"){var se=te.find(".dues .fa-calendar").parent();if(se.length&&R){var pe=R.split("-"),He=pe[1]+"/"+pe[2]+"/"+pe[0];se.contents().filter(function(){return this.nodeType===3}).first().replaceWith(" "+He)}else se.length&&!R&&se.contents().filter(function(){return this.nodeType===3}).first().replaceWith(" No due date")}jQuery.growl({message:"To-Do Updated",style:"success"});var Se={id:P};Se[B]=R,jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:Se}).fail(function(){jQuery.growl({message:leantime.i18n.__("short_notifications.not_saved")||"Error updating ticket",style:"error"}),location.reload()})}}x.item.removeData("originalSwimlaneId");for(var Ce=x.item.closest(".sortableTicketList"),xe={action:"kanbanSort",payload:{},handler:x.item[0].id},oe=0;oe<_.length;oe++)Ce.find(".contentInner.status_"+_[oe]).length&&(xe.payload[_[oe]]=Ce.find(".contentInner.status_"+_[oe]).sortable("serialize"));jQuery.ajax({type:"POST",url:leantime.appUrl+"/api/tickets",data:xe}).done(function(G){leantime.handleAsyncResponse(G)})}})});function g(k){var Q=k.position().left,x=function(M){M.pageX+5>Q?(k.addClass("right"),k.removeClass("left")):M.pageX<Q+5?(k.addClass("left"),k.removeClass("right")):(k.removeClass("left"),k.removeClass("right")),Q=M.pageX};jQuery("html").bind("mousemove",x),k.data("move_handler",x)}jQuery(".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all").find(".portlet-header").addClass("ui-widget-header ui-corner-all").prepend("<span class='ui-icon ui-icon-minusthick portlet-toggle'></span>"),jQuery(".portlet-toggle").click(function(){var k=jQuery(this);k.toggleClass("ui-icon-minusthick ui-icon-plusthick"),k.closest(".portlet").find(".portlet-content").toggle()})},F=function(j){function _(g){return!isNaN(parseFloat(g))&&isFinite(g)}jQuery(document).ready(function(){var g=[],k=jQuery(".ticketTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")},buttons:{colvis:leantime.i18n.__("datatables.buttons.colvis"),csv:leantime.i18n.__("datatables.buttons.download")}},dom:'<"top">rt<"bottom">p<"clear">',searching:!1,stateSave:!0,displayLength:100,order:g,columnDefs:[{visible:!1,targets:10},{visible:!1,targets:11},{target:"no-sort",orderable:!1}],footerCallback:function(Q,x,M,q,A){var P=this.api(),R=P.column(10).data().reduce(function(B,N){return _(B)===!1&&(B=jQuery(B).val()),_(N)===!1&&(N=jQuery(N).val()),isNaN(B)&&(B=0),isNaN(N)&&(N=0),parseFloat(B)+parseFloat(N)},0),U=P.column(11).data().reduce(function(B,N){return _(B)===!1&&(B=jQuery(B).val()),_(N)===!1&&(N=jQuery(N).val()),isNaN(B)&&(B=0),isNaN(N)&&(N=0),parseFloat(B)+parseFloat(N)},0),O=P.column(12).data().reduce(function(B,N){return parseFloat(B)+parseFloat(N)},0);jQuery(P.column(9).footer()).html("Total"),jQuery(P.column(10).footer()).html(R),jQuery(P.column(11).footer()).html(U),jQuery(P.column(12).footer()).html(O)}});new jQuery.fn.dataTable.Buttons(k.table(0),{buttons:[{extend:"csvHtml5",title:leantime.i18n.__("label.filename_fileexport"),charset:"utf-8",bom:!0,exportOptions:{format:{body:function(Q,x,M,q){return typeof jQuery(q).data("order")<"u"&&(Q=jQuery(q).data("order")),Q}}}},{extend:"colvis",columns:":not(.noVis)"}]}).container().appendTo(jQuery("#tableButtons")),k.table(0).on("column-visibility",function(Q,x,M,q){for(var A=1;A<k.tables().context.length;A++)k.tables(A).column(M).visible(q);k.draw()}),jQuery(".ticketTable input").on("change",function(Q,x,M,q){jQuery(this).parent().attr("data-order",jQuery(this).val()),k.draw()})})},W=function(j){jQuery(document).ready(function(){var _=[];jQuery(".listStyleTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")},buttons:{colvis:leantime.i18n.__("datatables.buttons.colvis"),csv:leantime.i18n.__("datatables.buttons.download")}},dom:'<"top">rt<"bottom"<"center"p>><"clear">',searching:!1,stateSave:!0,displayLength:25,order:_,fnDrawCallback:function(g){g._iDisplayLength>g.fnRecordsDisplay()?jQuery(g.nTableWrapper).find(".dataTables_paginate").hide():jQuery(g.nTableWrapper).find(".dataTables_paginate").show()}})})},X=function(j){jQuery(document).ready(function(){var _=[],g=jQuery(".ticketTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")},buttons:{colvis:leantime.i18n.__("datatables.buttons.colvis"),csv:leantime.i18n.__("datatables.buttons.download")}},dom:'<"top">rt<"bottom"><"clear">',searching:!1,stateSave:!0,displayLength:100,order:_,columnDefs:[{visible:!1,targets:7},{visible:!1,targets:8},{target:"no-sort",orderable:!1}]});new jQuery.fn.dataTable.Buttons(g.table(0),{buttons:[{extend:"csvHtml5",title:leantime.i18n.__("label.filename_fileexport"),charset:"utf-8",bom:!0,exportOptions:{format:{body:function(k,Q,x,M){return typeof jQuery(M).data("order")<"u"&&(k=jQuery(M).data("order")),k}}}},{extend:"colvis",columns:":not(.noVis)"}]}).container().appendTo(jQuery("#tableButtons")),g.table(0).on("column-visibility",function(k,Q,x,M){for(var q=1;q<g.tables().context.length;q++)g.tables(q).column(x).visible(M);g.draw()}),jQuery(".ticketTable input").on("change",function(k,Q,x,M){jQuery(this).parent().attr("data-order",jQuery(this).val()),g.draw()})})},V=function(j,_){window.leantime&&window.leantime.tiptapController&&window.leantime.tiptapController.registry&&leantime.tiptapController.registry.destroyAll(),jQuery(".ticketRows").removeClass("active"),jQuery("#row-"+j).addClass("active"),jQuery(_).html("<div class='center'><img src='"+leantime.appUrl+"/dist/images/svg/loading-animation.svg' width='100px' /></div>");function g(k){jQuery(k).find("form").each(function(){jQuery(this).on("submit",function(Q){Q.preventDefault(),window.leantime&&window.leantime.tiptapController&&window.leantime.tiptapController.registry&&leantime.tiptapController.registry.destroyAll(),jQuery(k).html("<div class='center'><img src='"+leantime.appUrl+"/dist/images/svg/loading-animation.svg' width='100px'/></div>");var x=jQuery(this).serialize();jQuery.ajax({url:jQuery(this).attr("action"),data:x,type:"post",success:function(M){jQuery(k).html(M),g(k)},error:function(){}})})})}jQuery.get(leantime.appUrl+"/tickets/showTicket/"+j,function(k){jQuery(_).html(k),g(_)})},ie=function(){jQuery("#tags").tagsInput({autocomplete_url:leantime.appUrl+"/api/tags"}),jQuery("#tags_tag").on("focusout",function(){let j=jQuery(this).val();j!=""&&jQuery("#tags").addTag(j)})},ce=function(j,_){var g="Discussion on To-Do #"+_+`:
\r`+jQuery("#commentText-"+j).text();jQuery('li a[href*="timesheet"]').click(),jQuery("#timesheet #description").val(g)},ue=function(j){jQuery.nmManual(j,{stack:!0,sizes:{minW:500,minH:500}})};return{toggleFilterBar:m,initGanttChart:s,updateRemainingHours:e,updatePlannedHours:t,initTimeSheetChart:y,initTicketTabs:C,initTicketSearchSubmit:L,initTicketKanban:E,initTicketsTable:F,initEffortDropdown:p,initPriorityDropdown:v,initMilestoneDropdown:i,initStatusDropdown:o,initUserDropdown:f,initSprintDropdown:S,initToolTips:h,initTagsInput:ie,initMilestoneDatesAsyncUpdate:c,initAsyncInputChange:T,initDueDateTimePickers:D,setUpKanbanColumns:b,addCommentTimesheetContent:ce,initMilestoneTable:X,initMilestoneDates:l,initTicketsList:W,loadTicketToContainer:V,initTicketSearchUrlBuilder:H,initSprintDates:a,initSimpleColorPicker:w,openMilestoneModalManually:ue}}();var Z=window.leantime||(window.leantime={});Z.ticketsRepository=function(){var r=function(m,s,a,l){let c=Z.dateHelper.getFormatFromSettings("dateformat","luxon"),h=Z.dateHelper.getFormatFromSettings("timeformat","luxon"),p=luxon.DateTime.fromSQL(s).toFormat(c),v=luxon.DateTime.fromSQL(s).toFormat(h),i=luxon.DateTime.fromSQL(a).toFormat(c),o=luxon.DateTime.fromSQL(a).toFormat(h);fetch(Z.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:m,editFrom:p,editTo:i,timeFrom:v,timeTo:o,sortIndex:l})})},n=function(m,s,a){fetch(Z.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:m,hourRemaining:s})}).then(function(){a()})},d=function(m,s,a){fetch(Z.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:m,planHours:s})}).then(function(){a()})},u=function(m,s,a){fetch(Z.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:m,dateToFinish:s})}).then(function(){a()})},e=function(m,s,a){fetch(Z.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:m,editFrom:s})}).then(function(){a()})},t=function(m,s,a){fetch(Z.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:m,editTo:s})}).then(function(){a()})};return{updateMilestoneDates:r,updateRemainingHours:n,updatePlannedHours:d,updateDueDates:u,updateEditFromDates:e,updateEditToDates:t}}();leantime.dashboardController=function(){var r={};leantime.theme=="dark"?r={red:"rgb(201,48,44)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(90,182,90)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(56, 56, 56)"}:r={red:"rgb(201,48,44)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(90,182,90)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"};var n="",d=function(){var l=moment().startOf("week").add(5,"days"),c=document.querySelector("#dateToFinish");c&&(c.value=l.format("YYYY-MM-DD"))},u=function(l,c,h){var p={type:"doughnut",data:{datasets:[{data:[c,h],backgroundColor:[leantime.dashboardController.chartColors.green,leantime.dashboardController.chartColors.grey],label:leantime.i18n.__("label.project_done")}],labels:[c+"% Done",h+"% Open"]},options:{maintainAspectRatio:!1,responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!1,text:""}},animation:{animateScale:!0,animateRotate:!0}}},v=document.getElementById(l).getContext("2d");new Chart(v,p)},e=function(l,c,h){moment.locale(leantime.i18n.__("language.code"));var p={type:"line",data:{labels:l,datasets:[{label:leantime.i18n.__("label.ideal"),backgroundColor:leantime.dashboardController.chartColors.blue,borderColor:leantime.dashboardController.chartColors.blue,data:c,fill:!1,lineTension:0},{label:"Actual",backgroundColor:leantime.dashboardController.chartColors.red,borderColor:leantime.dashboardController.chartColors.red,data:h,fill:!1,lineTension:0}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!0},plugins:{legend:{position:"bottom"},title:{display:!1,text:"Line Chart"},tooltips:{mode:"index",intersect:!1}},scales:{x:{display:!0,title:{display:!0,text:leantime.i18n.__("label.date")},type:"time",time:{unit:"day"}},y:{display:!0,title:{display:!0,text:leantime.i18n.__("label.num_tickets")},ticks:{beginAtZero:!0}}}}},v=document.getElementById("sprintBurndown").getContext("2d");return n=new Chart(v,p),n},t=function(l,c,h,p,v){var i=document.getElementById(l);i&&i.addEventListener("click",function(o){v.data.datasets[0].data=h,v.data.datasets[1].data=p,v.options.scales.y.title.text=c,document.querySelectorAll(".chartButtons").forEach(function(f){f.classList.remove("active")}),i.classList.add("active"),v.update()})},m=function(l,c){moment.locale(leantime.i18n.__("language.code"));var h={type:"line",data:{labels:l,datasets:[{label:leantime.i18n.__("label.done_todos"),backgroundColor:leantime.dashboardController.chartColors.green,borderColor:leantime.dashboardController.chartColors.green,data:c.done.data,fill:!0,lineTension:0,pointRadius:0},{label:leantime.i18n.__("label.progress_todos"),backgroundColor:leantime.dashboardController.chartColors.yellow,borderColor:leantime.dashboardController.chartColors.yellow,data:c.progress.data,fill:!0,lineTension:0,pointRadius:0},{label:leantime.i18n.__("label.new_todos"),backgroundColor:leantime.dashboardController.chartColors.red,borderColor:leantime.dashboardController.chartColors.red,data:c.open.data,fill:!0,lineTension:0,pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!0},elements:{point:{pointStyle:"line",radius:"0"}},plugins:{tooltips:{mode:"index",intersect:!1},legend:{position:"bottom"},title:{display:!1,text:"Line Chart"}},scales:{x:{display:!0,title:{display:!0,text:leantime.i18n.__("label.date")},type:"time",time:{unit:"day"}},y:{display:!0,title:{display:!0,text:leantime.i18n.__("label.num_tickets")},ticks:{beginAtZero:!0},stacked:!0}}}},p=document.getElementById("backlogBurndown").getContext("2d");return n=new Chart(p,h),n},s=function(l,c,h,p){var v=document.getElementById(l);v&&v.addEventListener("click",function(i){p.data.datasets[0].data=c.done.data,p.data.datasets[1].data=c.progress.data,p.data.datasets[2].data=c.open.data,p.options.scales.y.title.text=h,document.querySelectorAll(".backlogChartButtons").forEach(function(o){o.classList.remove("active")}),v.classList.add("active"),p.update()})},a=function(){document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".duedates").forEach(function(l){leantime.dateController.initDatePicker(l,function(c){var h=c;h==""&&(this.value=leantime.i18n.__("text.anytime"));var p=moment(h,leantime.i18n.__("language.momentJSDate")).format("YYYY-MM-DD HH:mm:ss"),v=this.getAttribute("data-id"),i=p;leantime.ticketsRepository.updateDueDates(v,i,function(){leantime.toast.show({message:leantime.i18n.__("short_notifications.duedate_updated")})})})})})};return{chartColors:r,initBurndown:e,initChartButtonClick:t,initBacklogBurndown:m,initBacklogChartButtonClick:s,initProgressChart:u,prepareHiddenDueDate:d,initDueDateTimePickers:a}}();leantime.usersController=function(){var r=null,n=function(a){if(d(),a.files&&a.files[0]){var l=new FileReader,c=document.querySelector("#profileImg");l.onload=function(h){r=new Croppie(c,{enableExif:!0,viewport:{width:175,height:175,type:"circle"},boundary:{width:200,height:200}}),r.bind({url:h.currentTarget.result});var p=document.querySelector("#previousImage");p&&(p.style.display="none")},l.readAsDataURL(a.files[0])}},d=function(){r&&(r.destroy(),r=null);var a=document.querySelector("#previousImage");a&&(a.style.display="")},u=function(){var a=document.querySelector("#save-picture");a&&a.classList.add("running");var l=document.querySelector("#profileImg");l&&l.setAttribute("src",leantime.appUrl+"/images/loaders/loader28.gif"),r&&r.result({type:"blob",circle:!0}).then(function(c){leantime.usersService.saveUserPhoto(c)})},e=function(){document.addEventListener("DOMContentLoaded",function(){jQuery("#allUsersTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")}},dom:'<"top">rt<"bottom"ilp><"clear">',searching:!1,displayLength:100})})},t=function(){var a={sizes:{minW:400,minH:350},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(l){l.style.display=""}),jQuery(".userImportModal").nyroModal(a)}}};jQuery(".userImportModal").nyroModal(a)},m=function(){var a={sizes:{minW:900,minH:250},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(l){l.style.display=""}),jQuery(".userEditModal").nyroModal(a)},beforeClose:function(){location.reload()}}};jQuery(".userEditModal").nyroModal(a)},s=function(a){let l,c=document.getElementById(a),h=document.getElementById("pwStrength"),p=new RegExp("(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,})"),v=new RegExp("((?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{6,}))|((?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9])(?=.{8,}))");function i(o){p.test(o)?(h.style.backgroundColor="#107530",h.textContent=leantime.i18n.__("label.strong")):v.test(o)?(h.style.backgroundColor="#C5850D",h.textContent=leantime.i18n.__("label.medium")):(h.style.backgroundColor="#CC6B6B",h.textContent=leantime.i18n.__("label.weak"))}c.addEventListener("input",()=>{h.style.display="block",clearTimeout(l),l=setTimeout(()=>i(c.value),500),c.value.length!==0?h.style.display!="block":h.style.display="none"})};return{readURL:n,clearCroppie:d,saveCroppie:u,initUserTable:e,_initModals:t,checkPWStrength:s,initUserEditModal:m}}();leantime.usersRepository=function(){var r=function(d){var u=new FormData;u.append("file",d),fetch(leantime.appUrl+"/api/users",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"},body:u}).then(function(e){var t=document.querySelector("#save-picture");t&&t.classList.remove("running"),location.reload()}).catch(function(e){console.log(e)})},n=function(d,u){fetch(leantime.appUrl+"/api/users",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({patchViewSettings:d,value:u})})};return{saveUserPhoto:r,updateUserViewSettings:n}}();leantime.usersService=function(){var r=function(n){leantime.usersRepository.saveUserPhoto(n)};return{saveUserPhoto:r}}();leantime.reactionsController=function(){return{addReactions:function(d,u,e,t){fetch(leantime.appUrl+"/api/reactions",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"add",module:d,moduleId:u,reaction:e})}).then(function(){t()})},removeReaction:function(d,u,e,t){fetch(leantime.appUrl+"/api/reactions",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"remove",module:d,moduleId:u,reaction:e})}).then(function(){t()})}}}();leantime.helperController=function(){var r=function(c,h){h?leantime.helperRepository.updateUserModalSettings(c,!0):leantime.helperRepository.updateUserModalSettings(c,!1)},n=function(){return leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal(),leantime.tourFactory.startTour("myWorkDashboard")},d=function(){leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal()},u=function(){return leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal(),leantime.helperRepository.updateUserModalSettings("projectDashboard"),leantime.tourFactory.startTour("projectDashboard")},e=function(){return jQuery.nmTop()&&jQuery.nmTop().close(),leantime.helperRepository.updateUserModalSettings("kanbanBoard"),leantime.tourFactory.startTour("kanbanBoard")},t=function(){return jQuery.nmTop()&&jQuery.nmTop().close(),leantime.helperRepository.updateUserModalSettings("milestoneView"),leantime.tourFactory.startTour("milestoneView")},m=function(){return leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal(),leantime.helperRepository.updateUserModalSettings("goals"),leantime.tourFactory.startTour("goalsView")},s=function(){document.addEventListener("DOMContentLoaded",function(){var c={sizes:{minW:700,minH:250},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(h){h.style.display=""}),jQuery(".onboardingModal").nyroModal(c)},beforeClose:function(){location.reload()}}};jQuery(".onboardingModal").nyroModal(c),jQuery.nmManual(leantime.appUrl+"/help/firstLogin",c)})},a=function(c,h,p){document.addEventListener("DOMContentLoaded",function(){jQuery.nmManual(leantime.appUrl+"/help/showOnboardingDialog?module="+c,{sizes:{minW:h||200,minH:p||500},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){leantime.replaceSVGColors()},afterShowCont:function(){htmx.process("#global-modal-content")}}})})},l=function(c){leantime.helperRepository.updateUserModalSettings(c),leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal()};return{showHelperModal:a,hideAndKeepHidden:l,setDontShowAgain:r,closeModal:d,startMyWorkDashboardTour:n,startProjectDashboardTour:u,startKanbanTour:e,startMilestoneTour:t,startGoalTour:m,firstLoginModal:s}}();var de=window.leantime||(window.leantime={});de.helperRepository=function(){var r=function(u,e=!1){fetch(de.appUrl+"/api/users",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({settings:u,permanent:e?1:0,patchModalSettings:1})})},n=function(){fetch(de.appUrl+"/api/sessions",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({tourActive:1})})},d=function(){fetch(de.appUrl+"/api/sessions",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({tourActive:0})})};return{updateUserModalSettings:r,startingTour:n,stopTour:d}}();leantime.tourFactory=function(){var r=function(t){return new Shepherd.Tour({useModalOverlay:!0,defaultStepOptions:{classes:"shepherd-theme-arrows",scrollTo:!1,cancelIcon:{enabled:!0}},tourName:t})},n=function(t){leantime.helperRepository.updateUserModalSettings(t),typeof _paq<"u"&&_paq.push(["trackEvent","Tour","Completed",t])},d=function(t){return{myWorkDashboard:[{id:"welcome-step",title:" Welcome to the Dashboard Tour",text:"Let's start with a few basics to get you up to speed on the navigation and different elements inside Leantime."},{id:"top-nav-step",title:"Work Modes",text:"The top navigation shows you the current 'work mode' you're in. You can be inside a project, your personal work area, or in the company mode.",attachTo:{element:".work-modes",on:"bottom"}},{id:"menu-step",title:"Left Navigation",text:"The left navigation breaks down the current work mode and gives you access to different areas. Everything presented here is part of the currently selected work mode above.",attachTo:{element:".leftpanel",on:"right"}},{id:"my-menu",title:"My Profile Bar",text:"Here you'll find links to your account as well as notifications and latest news about Leantime.",attachTo:{element:".headmenu.pull-right",on:"bottom"}},{id:"dashboard-widgets",title:"Your Dashboard Widgets",text:"Your dashboard is broken up into various widgets showing you focused information about your work.",attachTo:{element:".primaryContent",on:"top"}},{id:"dashboard-widgets-dandd",title:"Customize Your Dashboard",text:"Widgets can be resized and moved around using the drag and drop functionality.",attachTo:{element:"#widget_wrapper_todos .grid-handler-top",on:"bottom"}},{id:"my-todo-widget",title:"My To-Dos",text:"The My To-Do widget shows you all the tasks that are currently assigned to you.",attachTo:{element:"#widget_wrapper_todos",on:"top"}},{id:"my-todo-widget2",title:"Group To-Dos",text:"You can use the dropdowns here to filter your tasks by project or group them by priority, status, project, or dates.",attachTo:{element:"#yourToDoContainer > .clear",on:"bottom"}},{id:"my-todo-widget4",title:"Sort To-Dos",text:"Each To-Do can be dragged and dropped to change its order. You can also drag and drop a task to the calendar to schedule it.",attachTo:{element:"#yourToDoContainer .sortable-item:first-child",on:"bottom"}},{id:"my-todo-widget-timer",title:"Start the Timer",text:"When you're ready to start working on a task, just click the start timer button.",attachTo:{element:"#yourToDoContainer .sortable-item:first-child .timerContainer",on:"bottom"}},{id:"my-todo-widget-complete",title:"Complete a Task",text:"Once a task is complete, you can mark it as done by clicking the status dropdown.",attachTo:{element:"#yourToDoContainer .sortable-item:first-child .statusDropdown",on:"bottom"}},{id:"my-todo-widget-add",title:"Add More Tasks",text:"You can add more tasks by clicking the plus button in each section, or by using the 3-dot menu next to each task.",attachTo:{element:"#yourToDoContainer .fa-circle-plus",on:"bottom"}},{id:"finish",title:"Congratulations!",text:"You've completed the My Work dashboard tour. Head to <a href='"+leantime.appUrl+"/dashboard/show'>your project</a> to learn more about project management in Leantime."}],projectDashboard:[{id:"left-nav",title:"Project Menu",text:"The project menu organizes your project into different sections: <strong>Data Room</strong> - to host all your files and information, <strong>Think</strong> - to strategize, ideate and define, <strong>Make</strong> - to manage goals, milestones and tasks.",attachTo:{element:".leftmenu ul",on:"left"}},{id:"project-selector",title:"Project Selector",text:"Use the project selector to jump between projects. The left menu shows everything related to your current project.",attachTo:{element:".bigProjectSelector",on:"bottom"}},{id:"project-checklist",title:"Checklist",text:"The project checklist is a quick reference to see if your project contains all the necessary information for successful execution.",attachTo:{element:"#progressForm",on:"bottom"}},{id:"project-status",title:"Quick Status Updates",text:"You can use status updates to quickly share the progress of your project with your team using red, yellow and green colors. The status will be visible across the application.",attachTo:{element:".project-updates",on:"left"}},{id:"project-progress",title:"Progress",text:"The project progress indicator shows you how much work you have completed. It accounts for various task sizes, team velocity, and project milestones.",attachTo:{element:".project-progress",on:"left"}},{id:"latest-tasks",title:"Latest Tasks",text:"The list of latest tasks shows you the most recent tasks added to your project and can be used as a project inbox.",attachTo:{element:".latest-todos",on:"left"}},{id:"teams",title:"Team",text:"The team box shows you the members of this project.",attachTo:{element:".team-container",on:"top"}},{id:"finished",title:"Congratulations!",text:"You've completed the project dashboard tour. Head to the <a href='"+leantime.appUrl+"/tickets/showKanban'>To-Dos</a> to learn more about the various ways to manage your tasks in Leantime."}],kanbanBoard:[{id:"kanban-overview",title:"Your Kanban Board",text:"This is your Kanban board. It helps you visualize your work and limit work-in-progress.",attachTo:{element:".kanban-board-wrapper",on:"top"}},{id:"kanban-columns",title:"Work Flow",text:"Tasks move from left to right as they progress. Drag and drop cards to update their status.",attachTo:{element:".column",on:"right"}},{id:"kanban-columns2",title:"Flexible Columns",text:"Using the 3-dot menu, you can add or remove columns and rename them.",attachTo:{element:".column .widgettitle .inlineDropDownContainer",on:"right"}},{id:"kanban-filter",title:"Filter Tasks",text:"You can filter your tasks by various fields like priority, status, project, or dates.",attachTo:{element:".filterWrapper > .btn",on:"bottom"}},{id:"kanban-group",title:"Swimlanes",text:"Additionally, you can group your tasks to create Kanban swimlanes. This helps you visualize your work by team members, priority, or milestones.",attachTo:{element:".filterWrapper > .btn-group",on:"bottom"}},{id:"kanban-sprints",title:"Sprints",text:"If you manage your work in sprints, you can use the dropdown here to select, create, and update sprints.",attachTo:{element:".pageheader .dropdown",on:"bottom"}},{id:"kanban-congrats",title:"Congratulations!",text:"This concludes the Kanban tour. Head to the <a href='"+leantime.appUrl+"/tickets/showKanban'>Milestones</a> to learn how to create and manage milestones in Leantime."}],milestoneView:[{id:"milestone-overview",title:"Milestones",text:"Milestones help you track major outcomes and project phases.",attachTo:{element:".gantt-wrapper",on:"top"}},{id:"milestone-drag",title:"Drag & Sort",text:"Each bar represents one milestone. You can drag them along the timeline, reorder, and resize them. Everything you do on this screen updates the timing of your milestones.",attachTo:{element:".gantt-wrapper",on:"top"}},{id:"milestone-filter",title:"Filter",text:"You can filter your milestones and also view tasks that are part of them.",attachTo:{element:".filterWrapper > .btn",on:"bottom"}},{id:"milestone-timeframes",title:"Timeframes",text:"You can change the timeframe of the timeline view to see more of the year or dive deep into a daily breakdown.",attachTo:{element:".col-md-4 .pull-right",on:"bottom"}},{id:"milestone-congrats",title:"Congratulations!",text:"This concludes the milestone tour. Head to the <a href='"+leantime.appUrl+"/goalcanvas/dashboard'>Goals</a> to learn how to create and manage goals in Leantime."}],goalsView:[{id:"goals-overview",title:"Goals",text:"Goals help you track measurable impact on your projects."},{id:"goal-parts",title:"Objectives & Metrics",text:"Each goal is made up of an Objective (what you're trying to accomplish) and a Metric (how you'll measure it).",attachTo:{element:".ticketBox",on:"top"}},{id:"goal-progress",title:"Goal Progress",text:"As you update your goal metrics, the progress bar will show you how far along you are.",attachTo:{element:".ticketBox > .row > .col-md-12 .progress",on:"bottom"}},{id:"milestone-connection",title:"Milestones & Goals",text:"You can connect goals to milestones to track the task-level progress of your goals. This helps identify gaps in your project plan.",attachTo:{element:".ticketBox.fixed",on:"bottom"}},{id:"milestone-congrats",title:"Congratulations!",text:"This concludes the goals tour. Milestones, Goals, and To-Dos are the basic building blocks in Leantime. Use them to break down your work into manageable chunks. Head to the <a href='"+leantime.appUrl+"/tickets/showKanban'>Kanban Board</a> to review your tasks."}]}[t]||[]},u=function(t){const m=r(t),s=d(t);return s.forEach((a,l)=>{const c=l===0,h=l===s.length-1,p=[];c||p.push({text:leantime.i18n.__("tour.back"),classes:"shepherd-button-secondary",action:m.back}),h?p.push({text:leantime.i18n.__("tour.finish"),action:function(){n(t),confetti(),m.complete()}}):p.push({text:leantime.i18n.__("tour.next"),action:m.next}),h||p.unshift({text:leantime.i18n.__("tour.cancel"),classes:"shepherd-button-secondary",action:m.cancel}),m.addStep({...a,buttons:p})}),m.on("complete",function(){n(t)}),m},e=function(t){const m=u(t);return m.start(),m};return{createTour:r,buildTour:u,startTour:e,getTourDefinition:d}}();leantime.confettiHelper=function(){var r=function(d){const e={...{particleCount:100,spread:70,origin:{y:.6},disableForReducedMotion:!0},...d};typeof confetti=="function"?confetti(e):console.error("Confetti library not loaded")},n=function(){r({particleCount:150,spread:90,origin:{y:.8},colors:["#26a69a","#00bcd4","#4caf50","#8bc34a","#cddc39"]}),setTimeout(function(){r({particleCount:80,spread:120,origin:{y:.7},colors:["#ff9800","#ff5722","#f44336","#e91e63","#9c27b0"]})},500)};return{triggerConfetti:r,celebrateSuccess:n}}();leantime.firstTaskController=function(){var r=function(){var n=document.querySelector("#firstTaskOnboarding");if(n){n.addEventListener("submit",function(u){u.preventDefault();var e=document.querySelector("#firstTask"),t=e.value.trim();if(t==="")return e.classList.add("error"),!1;e.classList.remove("error"),leantime.confettiHelper.celebrateSuccess(),setTimeout(function(){n.submit()},1500)});var d=document.querySelector("#firstTask");d&&d.addEventListener("input",function(){this.classList.remove("error")})}};return{initFirstTaskForm:r}}();document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){leantime.firstTaskController.initFirstTaskForm()}):leantime.firstTaskController.initFirstTaskForm();leantime.menuController=function(){var r=function(t){if(t!==""){var m=document.querySelector("#submenu-"+t),s=document.querySelector("#submenu-icon-"+t),a="";m&&(m.style.display==="none"||getComputedStyle(m).display==="none"?(m.style.display="block",s&&(s.classList.remove("fa-angle-right"),s.classList.add("fa-angle-down")),a="open"):(m.style.display="none",s&&(s.classList.remove("fa-angle-down"),s.classList.add("fa-angle-right")),a="closed"),fetch(leantime.appUrl+"/api/submenu",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({submenu:t,state:a})}))}},n=function(){document.addEventListener("click",function(l){l.target.closest(".projectselector.dropdown-menu")&&l.stopPropagation()});var t=document.querySelector(".projectSelectorTabs");if(t){var m=t.querySelectorAll("ul > li > a"),s=localStorage.getItem("currentMenuTab"),a=0;s&&m.forEach(function(l,c){l.getAttribute("href")==="#"+s&&(a=c)}),m.forEach(function(l,c){var h=l.getAttribute("href");if(!(!h||h.charAt(0)!=="#")){var p=document.querySelector(h);p&&(c===a?(p.style.display="",l.parentElement.classList.add("ui-tabs-active")):(p.style.display="none",l.parentElement.classList.remove("ui-tabs-active")),l.addEventListener("click",function(v){v.preventDefault(),m.forEach(function(o){var f=o.getAttribute("href");if(f&&f.charAt(0)==="#"){var T=document.querySelector(f);T&&(T.style.display="none")}o.parentElement.classList.remove("ui-tabs-active")}),p&&(p.style.display=""),l.parentElement.classList.add("ui-tabs-active");var i=h.replace("#","");localStorage.setItem("currentMenuTab",i)}))}})}},d=function(){if(window.innerWidth<576){var t=document.querySelector(".mainwrapper");t&&(t.classList.remove("menuopen"),t.classList.add("menuclosed"))}var m=document.querySelector(".barmenu");m&&m.addEventListener("click",function(){var s=document.querySelector(".mainwrapper");s&&(s.classList.contains("menuopen")?(s.classList.remove("menuopen"),s.classList.add("menuclosed"),leantime.menuRepository.updateUserMenuSettings("closed")):(s.classList.remove("menuclosed"),s.classList.add("menuopen"),leantime.menuRepository.updateUserMenuSettings("open")))})},u=function(t,m="",s){var a=document.querySelector("#"+s+"-toggler-"+t),l=document.querySelector("#"+s+"-projectSelectorlist-group-"+t);if(a)if(m==="closed"?(a.classList.remove("closed","open"),a.classList.add("open")):m==="open"&&(a.classList.remove("open","closed"),a.classList.add("closed")),a.classList.contains("open")){a.classList.remove("open"),a.classList.add("closed");var c=a.querySelector("i");c&&(c.classList.remove("fa-angle-down"),c.classList.add("fa-angle-right")),l&&(l.classList.add("closed"),l.classList.remove("open")),e(t,"closed",s)}else{a.classList.remove("closed"),a.classList.add("open");var c=a.querySelector("i");c&&(c.classList.remove("fa-angle-right"),c.classList.add("fa-angle-down")),l&&(l.classList.add("open"),l.classList.remove("closed")),e(t,"open",s)}};let e=function(t,m,s){fetch(leantime.appUrl+"/api/submenu",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({submenu:s+"-projectSelectorlist-group-"+t,state:m})})};return{toggleSubmenu:r,initProjectSelector:n,initLeftMenuHamburgerButton:d,updateGroupDropdownSetting:e,toggleProjectDropDownList:u}}();var Te=window.leantime||(window.leantime={});Te.menuRepository=function(){var r=function(n){fetch(Te.appUrl+"/api/sessions",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({menuState:n})})};return{updateUserMenuSettings:r}}();leantime.settingController=function(){var r,n=function(e){if(d(),e.files&&e.files[0]){var t=new FileReader,m=jQuery("#logoImg");t.onload=function(s){r=m.croppie({enableExif:!0,enforceBoundary:!1,viewport:{width:220,height:40,type:"square"},boundary:{width:400,height:200}}),r.croppie("bind",{url:s.currentTarget.result});var a=document.querySelector("#previousImage");a&&(a.style.display="none")},t.readAsDataURL(e.files[0])}},d=function(){jQuery("#logoImg").croppie("destroy");var e=document.querySelector("#previousImage");e&&(e.style.display="")},u=function(){var e=document.querySelector("#save-logo");e&&e.classList.add("running");var t=document.querySelector("#logoImg");t&&t.setAttribute("src",leantime.appUrl+"/images/loaders/loader28.gif"),r.croppie("result",{type:"blob",circle:!1,size:"original",quality:1}).then(function(m){leantime.settingService.saveLogo(m)})};return{readURL:n,clearCroppie:d,saveCroppie:u}}();leantime.settingRepository=function(){var r=function(n){var d=new FormData;d.append("file",n),fetch(leantime.appUrl+"/api/setting",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"},body:d}).then(function(u){var e=document.querySelector("#save-logo");e&&e.classList.remove("running"),location.reload()}).catch(function(u){console.log(u)})};return{saveLogo:r}}();leantime.settingService=function(){var r=function(n){leantime.settingRepository.saveLogo(n)};return{saveLogo:r}}();leantime.widgetController=function(){var r=[],n=function(a,l){let c=a.gridX||0,h=a.gridY||0,p=a.gridWidth||2,v=a.gridHeight||2;if(l.willItFit({x:c,y:h,width:p,height:v}))return{x:c,y:h};let i=Math.max(...l.engine.nodes.map(o=>o.y+o.h),0);for(let o=0;o<=i+1;o++)for(let f=0;f<=12-p;f++)if(l.willItFit({newX:f,newY:o,width:p,height:v}))return{x:f,y:o};return{x:0,y:i+1}};GridStack.renderCB=function(a,l){l.content&&typeof DOMPurify<"u"&&(a.innerHTML=DOMPurify.sanitize(l.content))};var d=function(){r=GridStack.init({margin:"8px 15px 15px 0px",handle:".grid-handler-top",minRow:2,cellHeight:"30px",float:!0,draggable:{handle:".grid-handler-top",appendTo:"body"},lazyLoad:!1,columnOpts:{breakpointForWindow:!0,breakpoints:[{w:700,c:1},{w:950,c:6}]}}),r.on("dragstop",function(l,c){u()}),r.on("resizestop",function(l,c){u()}),document.querySelectorAll(".grid-stack-item").forEach(function(l){var c=l.querySelector(".removeWidget");c&&c.addEventListener("click",function(){e(this.closest(".grid-stack-item"))});var h=l.querySelector(".fitContent");h&&h.addEventListener("click",function(){t(this.closest(".grid-stack-item"))})});var a=document.querySelector("#gridBoard");a&&(a.style.opacity="1")},u=function(){let a=r.save();a.sort((h,p)=>h.y===p.y?h.x-p.x:h.y-p.y);let l=null;arguments.length>0&&arguments[0].action==="toggleWidget"&&(l={widgetId:arguments[0].widgetId,visible:arguments[0].visible}),a.forEach(function(h){var p=document.createElement("div");p.innerHTML=h.content;var v=p.querySelector("[hx-get]");h.id=v?v.getAttribute("id"):null,h.widgetUrl=v?v.getAttribute("hx-get"):null,h.widgetTrigger=v?v.getAttribute("hx-trigger"):null,h.x==null&&(h.x=0),h.gridX=h.x,h.y==null&&(h.y=0),h.gridY=h.y,h.w==null&&(h.w=1),h.gridWidth=h.w,h.h==null&&(h.h=1),h.gridHeight=h.h,h.content=""});var c=new URLSearchParams;c.append("action","saveGrid"),a.forEach(function(h,p){Object.keys(h).forEach(function(v){var i=h[v];i!=null&&c.append("data["+p+"]["+v+"]",i)})}),l&&Object.keys(l).forEach(function(h){c.append("visibilityData["+h+"]",l[h])}),fetch(leantime.appUrl+"/widgets/widgetManager",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:c})},e=function(a){a.remove(),r.removeWidget(a,!0),u()},t=function(a){document.querySelector(".grid-stack").gridstack.resizeToContent(a,!1),u()},m=function(a,l,c){let h=document.querySelector(".grid-stack").gridstack,p=l.checked;if(n(c,h),p){const i=document.createElement("div");i.className="grid-stack-item";const o=document.createElement("div");o.className=`grid-stack-item-content tw:p-none ${c.widgetBackground=="default"?"maincontentinner":c.background}`,o.innerHTML=s(c),i.appendChild(o),h.el.appendChild(i),h.makeWidget(i,{x:c.gridX||0,y:c.gridY||50,w:c.gridWidth||2,h:c.gridHeight||2}),htmx.process(i),u({action:"toggleWidget",widgetId:a,visible:p})}else{var v=document.getElementById(a);v&&e(v.closest(".grid-stack-item"))}},s=function(a){return'<div class="widgetInner">        <div class="'+(a.widgetBackground=="default"?"tw:pb-l":"")+`">
            <div class="stickyHeader" style="padding:15px; height:50px;  width:100%;">
               <div class="grid-handler-top tw:h-[40px] tw:cursor-grab tw:float-left tw:mr-sm">
                    <i class="fa-solid fa-grip-vertical"></i>
                </div>
           `+(a.name!=""?'<h5 class="subtitle tw:pb-m tw:float-left tw:mr-sm">'+a.name+"</h5>":"")+`
            <div class="inlineDropDownContainer tw:float-right">
                <a href="javascript:void(0);" class="dropdown-toggle ticketDropDown editHeadline" data-toggle="dropdown">
                    <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="javascript:void(0)" class="fitContent"><i class="fa-solid fa-up-right-and-down-left-from-center"></i> Resize to fit content</a></li>
                        <li><a href="javascript:void(0)" class="removeWidget"><i class="fa fa-eye-slash"></i> Hide</a></li>
                </ul>
            </div>

        </div>
 <div class="widgetContent tw:px-l">
             <div hx-get="`+a.widgetUrl+'" hx-trigger="'+a.widgetTrigger+'" hx-target="this" hx-swap="innerHTML" id="'+a.id+`"></div>
        </div>
       </div>
        <div class="clear"></div>
    </div>
`};return{resizeWidget:t,removeWidget:e,saveGrid:u,initGrid:d,toggleWidgetVisibility:m}}();leantime.calendarController=function(){var r=function(e){var t=new Date;t.getDate(),t.getMonth(),t.getFullYear();var m=document.body.offsetHeight-260,s=document.querySelector("#calendar"),a=new FullCalendar.Calendar(s,{timeZone:leantime.i18n.__("usersettings.timezone"),height:m,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listDay"},titleFormat:{year:"numeric",month:"long"},dayHeaderFormat:{weekday:"short"},eventTimeFormat:leantime.dateHelper.getFormatFromSettings("timeformat","luxon"),direction:leantime.i18n.__("language.isRTL")=="false"?"ltr":"rtl",firstDay:parseInt(leantime.i18n.__("language.firstDayOfWeek"),10),locale:leantime.i18n.__("language.code"),buttonText:{today:leantime.i18n.__("buttons.today"),month:leantime.i18n.__("buttons.month"),week:leantime.i18n.__("buttons.week"),day:leantime.i18n.__("buttons.day")},selectable:!0,select:function(l){var c=prompt(leantime.i18n.__("label.event_title"));c&&a.addEvent({title:c,start:l.start,end:l.end,allDay:l.allDay}),a.unselect()},events:e,eventColor:"#0866c6"});a.render()},n=function(){document.addEventListener("DOMContentLoaded",function(){Date.prototype.addDays=function(l){return this.setDate(this.getDate()+l),this};var e=leantime.dateHelper.getFormatFromSettings("dateformat","flatpickr"),t=document.querySelector("#event_date_from"),m=document.querySelector("#event_date_to"),s=flatpickr(t,{dateFormat:e,locale:{firstDayOfWeek:parseInt(leantime.i18n.__("language.firstDayOfWeek"),10)},allowInput:!0,onOpen:function(l,c,h){if(h.element.hasAttribute("readonly"))return h.close(),!1},onChange:function(l,c){l.length>0&&a.set("minDate",l[0]),m.value===""&&a.setDate(l[0],!0)}}),a=flatpickr(m,{dateFormat:e,locale:{firstDayOfWeek:parseInt(leantime.i18n.__("language.firstDayOfWeek"),10)},allowInput:!0,onChange:function(l){l.length>0&&s.set("maxDate",l[0])}})})},d=function(){var e={sizes:{minW:400,minH:350},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){jQuery(".formModal").nyroModal(e)},beforeClose:function(){location.reload()}},titleFromIframe:!0};jQuery(".exportModal").nyroModal(e)},u=function(e,t){let m=document.querySelector(e),s=leantime.dateHelper.getFormatFromSettings("dateformat","luxon"),a=leantime.dateHelper.getFormatFromSettings("timeformat","luxon");const l=new FullCalendar.Calendar(m,{timeZone:leantime.i18n.__("usersettings.timezone"),height:"100%",stickyHeaderDates:!0,initialView:t,eventStartEditable:!0,dayHeaderFormat:s,eventTimeFormat:a,slotLabelFormat:a,views:{multiMonthOneMonth:{type:"multiMonth",duration:{months:1},multiMonthTitleFormat:{month:"long",year:"numeric"},dayHeaderFormat:{weekday:"short"}},timeGridWeek:{dayHeaders:!1},timeGridDay:{dayHeaders:!1},listWeek:{listDayFormat:{weekday:"long"},listDaySideFormat:leantime.dateHelper.getFormatFromSettings("dateformat","luxon")}},droppable:!0,eventSources,editable:!0,headerToolbar:!1,nowIndicator:!0,eventDrop:function(o){o.event.extendedProps.enitityType=="ticket"?fetch(leantime.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:o.event.extendedProps.enitityId,editFrom:luxon.DateTime.fromJSDate(o.event.start).toFormat(s),timeFrom:luxon.DateTime.fromJSDate(o.event.start).toFormat(a),editTo:luxon.DateTime.fromJSDate(o.event.end).toFormat(s),timeTo:luxon.DateTime.fromJSDate(o.event.end).toFormat(a)})}):o.event.extendedProps.enitityType=="event"&&fetch(leantime.appUrl+"/api/calendar",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:o.event.extendedProps.enitityId,dateFrom:o.event.startStr,dateTo:o.event.endStr})})},eventResize:function(o){o.event.extendedProps.enitityType=="ticket"?fetch(leantime.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:o.event.extendedProps.enitityId,editFrom:luxon.DateTime.fromJSDate(o.event.start).toFormat(s),timeFrom:luxon.DateTime.fromJSDate(o.event.start).toFormat(a),editTo:luxon.DateTime.fromJSDate(o.event.end).toFormat(s),timeTo:luxon.DateTime.fromJSDate(o.event.end).toFormat(a)})}):o.event.extendedProps.enitityType=="event"&&fetch(leantime.appUrl+"/api/calendar",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:o.event.extendedProps.enitityId,dateFrom:o.event.startStr,dateTo:o.event.endStr})})},eventReceive:function(o){fetch(leantime.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:o.event.id,editFrom:luxon.DateTime.fromJSDate(o.event.start).toFormat(s),timeFrom:luxon.DateTime.fromJSDate(o.event.start).toFormat(a),editTo:luxon.DateTime.fromJSDate(o.event.end).toFormat(s),timeTo:luxon.DateTime.fromJSDate(o.event.end).toFormat(a)})})},eventDragStart:function(o){},eventDidMount:function(o){o.event.title&&o.el.setAttribute("title",o.event.title),o.isDraggable===!1&&o.el.classList.add("locked"),o.event.extendedProps.location!=null&&o.event.extendedProps.location!=""&&o.event.extendedProps.location.indexOf("http")==0&&(o.el.setAttribute("href",o.event.extendedProps.location),o.el.setAttribute("target","_blank"))}});i(),l.scrollToTime(Date.now());var c=null;function h(o){o&&(c&&c.destroy(),c=new FullCalendar.Draggable(o,{itemSelector:".draggable-todo",eventData:function(f){let T=JSON.parse(f.dataset.event);return{id:T.id,title:T.title,color:T.color,enitityType:"ticket",duration:"01:00",url:T.url}}}),l.scrollToTime(Date.now()))}var p=document.querySelector("#yourToDoContainer");if(p&&p.querySelectorAll(".draggable-todo").length>0&&h(p),!c){var v=new MutationObserver(function(){if(c){v.disconnect();return}var o=document.querySelector("#yourToDoContainer");o&&o.querySelectorAll(".draggable-todo").length>0&&(h(o),v.disconnect())});v.observe(document.body,{childList:!0,subtree:!0})}document.body.addEventListener("htmx:afterSwap",function(o){var S;var f=((S=o.detail)==null?void 0:S.target)||o.target,T;f&&f.id==="yourToDoContainer"?T=f:f&&(T=f.querySelector("#yourToDoContainer")),T&&T.querySelectorAll(".draggable-todo").length>0&&h(T)});function i(){l.setOption("locale",leantime.i18n.__("language.code")),l.render();var o=m.querySelector(".fc-timegrid-axis"),f=m.querySelector(".fc-scroller"),T=m.closest(".minCalendar")?m.closest(".minCalendar").querySelector(".day-selector"):null;if(o&&T&&(T.style.paddingLeft=o.offsetWidth+"px",f)){var S=f.offsetWidth-f.clientWidth;S>0&&(T.style.paddingRight=S+"px")}l.scrollToTime(Date.now());var w=document.querySelector(".minCalendar .fc-prev-button");w&&w.addEventListener("click",function(){l.prev(),l.getCurrentData()});var D=document.querySelector(".minCalendar .fc-next-button");D&&D.addEventListener("click",function(){l.next()});var y=document.querySelector(".minCalendar .fc-today-button");y&&y.addEventListener("click",function(){l.today()}),document.querySelectorAll(".minCalendar .calendarViewSelect").forEach(function(C){C.addEventListener("click",function(L){console.log(this.dataset.value),l.changeView(this.dataset.value),fetch(leantime.appUrl+"/api/submenu",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({submenu:"dashboardCalendarView",state:this.dataset.value})})})}),document.querySelectorAll(".day-button").forEach(function(C){C.addEventListener("click",function(){var L=this.dataset.date;l.gotoDate(L),document.querySelectorAll(".day-button").forEach(function(H){H.classList.remove("active")}),this.classList.add("active")})})}return m};return{initCalendar:r,initEventDatepickers:n,initExportModal:d,initWidgetCalendar:u}}();
