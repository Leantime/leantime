(function(){function h(e){for(var i=e.state,r=i.selection,t=r.$from,l=t.depth;l>=0;l--){var s=t.node(l),d=s.type;if(d.name==="detailsSummary")return!0}return!1}var k={bold:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path><path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path></svg>',title:"Bold (Ctrl+B)",command:function(e){e.chain().focus().toggleBold().run()},isActive:function(e){return e.isActive("bold")}},italic:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="4" x2="10" y2="4"></line><line x1="14" y1="20" x2="5" y2="20"></line><line x1="15" y1="4" x2="9" y2="20"></line></svg>',title:"Italic (Ctrl+I)",command:function(e){e.chain().focus().toggleItalic().run()},isActive:function(e){return e.isActive("italic")}},strike:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><path d="M16 6C16 6 14.5 4 12 4C9.5 4 7 6 7 8.5C7 11 9 12 12 12"></path><path d="M8 18C8 18 9.5 20 12 20C14.5 20 17 18 17 15.5C17 13 15 12 12 12"></path></svg>',title:"Strikethrough",command:function(e){e.chain().focus().toggleStrike().run()},isActive:function(e){return e.isActive("strike")}},heading:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 4v16"></path><path d="M18 4v16"></path><path d="M6 12h12"></path></svg>',title:"Heading",command:function(e,i){h(e)||T(e,i)},isActive:function(e){return e.isActive("heading")},isDisabled:function(e){return h(e)}},quote:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V21z"></path><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3z"></path></svg>',title:"Quote",command:function(e){h(e)||e.chain().focus().toggleBlockquote().run()},isActive:function(e){return e.isActive("blockquote")},isDisabled:function(e){return h(e)}},bulletList:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="9" y1="6" x2="20" y2="6"></line><line x1="9" y1="12" x2="20" y2="12"></line><line x1="9" y1="18" x2="20" y2="18"></line><circle cx="4" cy="6" r="1" fill="currentColor"></circle><circle cx="4" cy="12" r="1" fill="currentColor"></circle><circle cx="4" cy="18" r="1" fill="currentColor"></circle></svg>',title:"Bullet List",command:function(e){h(e)||e.chain().focus().toggleBulletList().run()},isActive:function(e){return e.isActive("bulletList")},isDisabled:function(e){return h(e)}},orderedList:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="10" y1="6" x2="21" y2="6"></line><line x1="10" y1="12" x2="21" y2="12"></line><line x1="10" y1="18" x2="21" y2="18"></line><path d="M4 6h1v4"></path><path d="M4 10h2"></path><path d="M6 18H4c0-1 2-2 2-3s-1-1.5-2-1"></path></svg>',title:"Numbered List",command:function(e){h(e)||e.chain().focus().toggleOrderedList().run()},isActive:function(e){return e.isActive("orderedList")},isDisabled:function(e){return h(e)}},taskList:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="5" width="6" height="6" rx="1"></rect><path d="M5 11V8h2"></path><line x1="12" y1="8" x2="21" y2="8"></line><rect x="3" y="13" width="6" height="6" rx="1"></rect><path d="M5 16l1.5 1.5L9 14"></path><line x1="12" y1="16" x2="21" y2="16"></line></svg>',title:"Checklist",command:function(e){h(e)||e.chain().focus().toggleTaskList().run()},isActive:function(e){return e.isActive("taskList")},isDisabled:function(e){return h(e)}},link:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>',title:"Link (Ctrl+K)",command:function(e){if(e.isActive("link")){e.chain().focus().unsetLink().run();return}var i=e.state.selection,r=!i.empty;setTimeout(function(){var t=window.prompt("Enter URL:","https://");if(t!==null&&t&&t!=="https://")if(!/^https?:\/\//i.test(t)&&!/^mailto:/i.test(t)&&(t="https://"+t),r)e.chain().focus().setLink({href:t}).run();else{var l=window.prompt("Enter link text:",t);l&&e.chain().focus().insertContent(l).setTextSelection({from:e.state.selection.from-l.length,to:e.state.selection.from}).setLink({href:t}).run()}},10)},isActive:function(e){return e.isActive("link")}},image:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>',title:"Image",command:function(e,i){H(e,i)},isActive:function(){return!1}},table:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="3" y1="15" x2="21" y2="15"></line><line x1="9" y1="3" x2="9" y2="21"></line><line x1="15" y1="3" x2="15" y2="21"></line></svg>',title:"Table",command:function(e){e.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run()},isActive:function(e){return e.isActive("table")}},code:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>',title:"Code Block",command:function(e){e.chain().focus().toggleCodeBlock().run()},isActive:function(e){return e.isActive("codeBlock")}},undo:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path></svg>',title:"Undo (Ctrl+Z)",command:function(e){e.chain().focus().undo().run()},isActive:function(){return!1}},redo:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 7v6h-6"></path><path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"></path></svg>',title:"Redo (Ctrl+Shift+Z)",command:function(e){e.chain().focus().redo().run()},isActive:function(){return!1}},superscript:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m4 19 5-5"/><path d="m9 19-5-5"/><path d="M19 9h-4l3.5-4a1.5 1.5 0 0 0-3-1"/></svg>',title:"Superscript",command:function(e){e.chain().focus().toggleSuperscript().run()},isActive:function(e){return e.isActive("superscript")}},subscript:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m4 5 5 5"/><path d="m9 5-5 5"/><path d="M19 21h-4l3.5-4a1.5 1.5 0 0 0-3-1"/></svg>',title:"Subscript",command:function(e){e.chain().focus().toggleSubscript().run()},isActive:function(e){return e.isActive("subscript")}},alignLeft:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="15" y2="12"/><line x1="3" y1="18" x2="18" y2="18"/></svg>',title:"Align Left",command:function(e){e.chain().focus().setTextAlign("left").run()},isActive:function(e){return e.isActive({textAlign:"left"})}},alignCenter:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="6" y1="12" x2="18" y2="12"/><line x1="5" y1="18" x2="19" y2="18"/></svg>',title:"Align Center",command:function(e){e.chain().focus().setTextAlign("center").run()},isActive:function(e){return e.isActive({textAlign:"center"})}},alignRight:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="9" y1="12" x2="21" y2="12"/><line x1="6" y1="18" x2="21" y2="18"/></svg>',title:"Align Right",command:function(e){e.chain().focus().setTextAlign("right").run()},isActive:function(e){return e.isActive({textAlign:"right"})}},textColor:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 20h16"/><path d="m6 16 6-12 6 12"/><path d="M8 12h8"/></svg>',title:"Text Color",command:function(e,i){C(e,i)},isActive:function(){return!1}},highlight:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 11-6 6v3h9l3-3"/><path d="m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4"/></svg>',title:"Highlight",command:function(e,i){E(e,i)},isActive:function(e){return e.isActive("highlight")}},fontFamily:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><text x="4" y="17" font-size="14" font-family="serif" fill="currentColor" stroke="none">Aa</text></svg>',title:"Font Family",command:function(e,i){S(e,i)},isActive:function(){return!1}},fontSize:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 7V4h16v3"/><path d="M9 20h6"/><path d="M12 4v16"/></svg>',title:"Font Size",command:function(e,i){O(e,i)},isActive:function(){return!1}},more:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg>',title:"More options",command:function(e,i){B(e,i)},isActive:function(){return!1}}},M=[{key:"superscript",label:"Superscript",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m4 19 5-5"/><path d="m9 19-5-5"/><path d="M19 9h-4l3.5-4a1.5 1.5 0 0 0-3-1"/></svg>'},{key:"subscript",label:"Subscript",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m4 5 5 5"/><path d="m9 5-5 5"/><path d="M19 21h-4l3.5-4a1.5 1.5 0 0 0-3-1"/></svg>'},{type:"divider"},{key:"alignLeft",label:"Align Left",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="15" y2="12"/><line x1="3" y1="18" x2="18" y2="18"/></svg>'},{key:"alignCenter",label:"Align Center",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="6" y1="12" x2="18" y2="12"/><line x1="5" y1="18" x2="19" y2="18"/></svg>'},{key:"alignRight",label:"Align Right",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="9" y1="12" x2="21" y2="12"/><line x1="6" y1="18" x2="21" y2="18"/></svg>'},{type:"divider"},{key:"horizontalRule",label:"Horizontal Line",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/></svg>'},{key:"clearFormatting",label:"Clear Formatting",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7V4h16v3"/><path d="M9 20h6"/><path d="M12 4v16"/><line x1="2" y1="2" x2="22" y2="22" stroke-width="2"/></svg>'}];function x(){var e=document.querySelector(".tiptap-more-menu");e&&e.remove()}function B(e,i){x(),w(),m();var r=document.createElement("div");r.className="tiptap-more-menu";var t='<div class="tiptap-more-menu__list">';M.forEach(function(a){if(a.type==="divider")t+='<div class="tiptap-more-menu__divider"></div>';else{var u="",f=k[a.key];f&&f.isActive&&f.isActive(e)&&(u=" is-active"),t+='<button type="button" class="tiptap-more-menu__item'+u+'" data-command="'+a.key+'"><span class="tiptap-more-menu__icon">'+a.icon+'</span><span class="tiptap-more-menu__label">'+a.label+"</span>"+(a.hasSubmenu?'<span class="tiptap-more-menu__arrow">â€º</span>':"")+"</button>"}}),t+="</div>",r.innerHTML=t;var l=i.getBoundingClientRect(),s=window.pageYOffset||document.documentElement.scrollTop,d=window.pageXOffset||document.documentElement.scrollLeft,p=window.innerHeight;r.style.position="absolute",r.style.left=l.right+d-200+"px",r.style.zIndex="10001",document.body.appendChild(r);var n=r.getBoundingClientRect(),o=p-l.bottom,c=l.top;o<n.height+10&&c>n.height+10?r.style.top=l.top+s-n.height-4+"px":r.style.top=l.bottom+s+4+"px",n.left<10&&(r.style.left="10px"),r.querySelectorAll(".tiptap-more-menu__item").forEach(function(a){a.addEventListener("click",function(u){u.preventDefault(),u.stopPropagation();var f=a.getAttribute("data-command");if(f==="textColor"){x(),C(e,i);return}if(f==="highlight"){x(),E(e,i);return}if(f==="clearFormatting"){e.chain().focus().clearNodes().unsetAllMarks().run(),x();return}if(f==="horizontalRule"){e.chain().focus().setHorizontalRule().run(),x();return}var v=k[f];v&&v.command&&(v.command(e,a),x())})}),setTimeout(function(){document.addEventListener("click",function a(u){!r.contains(u.target)&&u.target!==i&&(x(),document.removeEventListener("click",a))})},10),document.addEventListener("keydown",function a(u){u.key==="Escape"&&(x(),document.removeEventListener("keydown",a))})}var L={complex:{position:"top",buttons:["bold","italic","strike","|","fontFamily","fontSize","textColor","highlight","|","heading","quote","|","bulletList","orderedList","taskList","|","link","image","|","table","code","|","more"],expandable:["table","code"]},simple:{position:"bottom",buttons:["bold","italic","|","link","image","|","bulletList","|","more"]},notes:{position:"top",buttons:["bold","italic","strike","|","fontFamily","fontSize","textColor","highlight","|","heading","quote","|","bulletList","orderedList","taskList","|","link","image","|","table","code","|","more"]}};function w(){var e=document.querySelector(".tiptap-color-popover");e&&e.remove()}function C(e,i){w();var r=[{name:"Default",value:null},{name:"Gray",value:"#6b7280"},{name:"Red",value:"#ef4444"},{name:"Orange",value:"#f97316"},{name:"Yellow",value:"#eab308"},{name:"Green",value:"#22c55e"},{name:"Blue",value:"#3b82f6"},{name:"Purple",value:"#a855f7"},{name:"Pink",value:"#ec4899"}],t=document.createElement("div");t.className="tiptap-color-popover";var l='<div class="tiptap-color-popover__grid">';r.forEach(function(n){var o=n.value?"background-color: "+n.value:"background: linear-gradient(135deg, #fff 45%, #ff0000 45%, #ff0000 55%, #fff 55%)";l+='<button type="button" class="tiptap-color-popover__btn" data-color="'+(n.value||"")+'" title="'+n.name+'" style="'+o+'"></button>'}),l+="</div>",t.innerHTML=l;var s=i.getBoundingClientRect(),d=window.pageYOffset||document.documentElement.scrollTop,p=window.pageXOffset||document.documentElement.scrollLeft;t.style.position="absolute",t.style.top=s.bottom+d+4+"px",t.style.left=s.left+p+"px",t.style.zIndex="10001",document.body.appendChild(t),t.querySelectorAll(".tiptap-color-popover__btn").forEach(function(n){n.addEventListener("click",function(){var o=n.getAttribute("data-color");o?e.chain().focus().setColor(o).run():e.chain().focus().unsetColor().run(),w()})}),setTimeout(function(){document.addEventListener("click",function n(o){!t.contains(o.target)&&o.target!==i&&(w(),document.removeEventListener("click",n))})},10),document.addEventListener("keydown",function n(o){o.key==="Escape"&&(w(),document.removeEventListener("keydown",n))})}function E(e,i){w();var r=[{name:"Remove",value:null},{name:"Yellow",value:"#fef08a"},{name:"Green",value:"#bbf7d0"},{name:"Blue",value:"#bfdbfe"},{name:"Purple",value:"#e9d5ff"},{name:"Pink",value:"#fbcfe8"},{name:"Orange",value:"#fed7aa"}],t=document.createElement("div");t.className="tiptap-color-popover";var l='<div class="tiptap-color-popover__grid">';r.forEach(function(n){var o=n.value?"background-color: "+n.value:"background: linear-gradient(135deg, #fff 45%, #ff0000 45%, #ff0000 55%, #fff 55%)";l+='<button type="button" class="tiptap-color-popover__btn" data-color="'+(n.value||"")+'" title="'+n.name+'" style="'+o+'"></button>'}),l+="</div>",t.innerHTML=l;var s=i.getBoundingClientRect(),d=window.pageYOffset||document.documentElement.scrollTop,p=window.pageXOffset||document.documentElement.scrollLeft;t.style.position="absolute",t.style.top=s.bottom+d+4+"px",t.style.left=s.left+p+"px",t.style.zIndex="10001",document.body.appendChild(t),t.querySelectorAll(".tiptap-color-popover__btn").forEach(function(n){n.addEventListener("click",function(){var o=n.getAttribute("data-color");o?e.chain().focus().toggleHighlight({color:o}).run():e.chain().focus().unsetHighlight().run(),w()})}),setTimeout(function(){document.addEventListener("click",function n(o){!t.contains(o.target)&&o.target!==i&&(w(),document.removeEventListener("click",n))})},10),document.addEventListener("keydown",function n(o){o.key==="Escape"&&(w(),document.removeEventListener("keydown",n))})}function m(){var e=document.querySelector(".tiptap-font-popover");e&&e.remove();var i=document.querySelector(".tiptap-heading-popover");i&&i.remove()}function T(e,i){m();var r=[{name:"Paragraph",level:0},{name:"Heading 1",level:1},{name:"Heading 2",level:2},{name:"Heading 3",level:3},{name:"Heading 4",level:4}],t=document.createElement("div");t.className="tiptap-heading-popover tiptap-font-popover";var l='<div class="tiptap-font-popover__list">';r.forEach(function(n){var o=n.level===0?!e.isActive("heading"):e.isActive("heading",{level:n.level}),c=o?" is-active":"",a=n.level===0?"14px":20-n.level*2+"px",u=n.level===0?"normal":"bold";l+='<button type="button" class="tiptap-font-popover__btn'+c+'" data-level="'+n.level+'" style="font-size: '+a+"; font-weight: "+u+';">'+n.name+"</button>"}),l+="</div>",t.innerHTML=l;var s=i.getBoundingClientRect(),d=window.pageYOffset||document.documentElement.scrollTop,p=window.pageXOffset||document.documentElement.scrollLeft;t.style.position="absolute",t.style.top=s.bottom+d+4+"px",t.style.left=s.left+p+"px",t.style.zIndex="10001",document.body.appendChild(t),t.querySelectorAll(".tiptap-font-popover__btn").forEach(function(n){n.addEventListener("click",function(){var o=parseInt(n.getAttribute("data-level"),10);if(o===0)e.chain().focus().setParagraph().run();else{var c=e.state,a=c.selection,u=a.$from,f=u.start(u.depth),v=u.end(u.depth);e.chain().focus().setTextSelection({from:f,to:v}).unsetMark("textStyle").toggleHeading({level:o}).run()}m()})}),setTimeout(function(){document.addEventListener("click",function n(o){!t.contains(o.target)&&o.target!==i&&(m(),document.removeEventListener("click",n))})},0)}function S(e,i){m();var r=[{name:"Default",value:null},{name:"Arial",value:"Arial, sans-serif"},{name:"Georgia",value:"Georgia, serif"},{name:"Times New Roman",value:'"Times New Roman", serif'},{name:"Courier New",value:'"Courier New", monospace'},{name:"Verdana",value:"Verdana, sans-serif"},{name:"Trebuchet MS",value:'"Trebuchet MS", sans-serif'},{name:"Comic Sans MS",value:'"Comic Sans MS", cursive'}],t=document.createElement("div");t.className="tiptap-font-popover";var l='<div class="tiptap-font-popover__list">';r.forEach(function(n){var o=n.value?"font-family: "+n.value:"";l+='<button type="button" class="tiptap-font-popover__btn" data-font="'+(n.value||"")+'" style="'+o+'">'+n.name+"</button>"}),l+="</div>",t.innerHTML=l;var s=i.getBoundingClientRect(),d=window.pageYOffset||document.documentElement.scrollTop,p=window.pageXOffset||document.documentElement.scrollLeft;t.style.position="absolute",t.style.top=s.bottom+d+4+"px",t.style.left=s.left+p+"px",t.style.zIndex="10001",document.body.appendChild(t),t.querySelectorAll(".tiptap-font-popover__btn").forEach(function(n){n.addEventListener("click",function(){var o=n.getAttribute("data-font");o?e.chain().focus().setFontFamily(o).run():e.chain().focus().unsetFontFamily().run(),m()})}),setTimeout(function(){document.addEventListener("click",function n(o){!t.contains(o.target)&&o.target!==i&&(m(),document.removeEventListener("click",n))})},10),document.addEventListener("keydown",function n(o){o.key==="Escape"&&(m(),document.removeEventListener("keydown",n))})}function O(e,i){m();var r=[{name:"Small",value:"12px"},{name:"Normal",value:null},{name:"14px",value:"14px"},{name:"16px",value:"16px"},{name:"18px",value:"18px"},{name:"20px",value:"20px"},{name:"24px",value:"24px"},{name:"28px",value:"28px"},{name:"32px",value:"32px"},{name:"36px",value:"36px"},{name:"48px",value:"48px"}],t=document.createElement("div");t.className="tiptap-font-popover";var l='<div class="tiptap-font-popover__list">';r.forEach(function(n){var o=n.value?"font-size: "+n.value:"";l+='<button type="button" class="tiptap-font-popover__btn" data-size="'+(n.value||"")+'" style="'+o+'">'+n.name+"</button>"}),l+="</div>",t.innerHTML=l;var s=i.getBoundingClientRect(),d=window.pageYOffset||document.documentElement.scrollTop,p=window.pageXOffset||document.documentElement.scrollLeft;t.style.position="absolute",t.style.top=s.bottom+d+4+"px",t.style.left=s.left+p+"px",t.style.zIndex="10001",document.body.appendChild(t),t.querySelectorAll(".tiptap-font-popover__btn").forEach(function(n){n.addEventListener("click",function(){var o=n.getAttribute("data-size");o?e.chain().focus().setFontSize(o).run():e.chain().focus().unsetFontSize().run(),m()})}),setTimeout(function(){document.addEventListener("click",function n(o){!t.contains(o.target)&&o.target!==i&&(m(),document.removeEventListener("click",n))})},10),document.addEventListener("keydown",function n(o){o.key==="Escape"&&(m(),document.removeEventListener("keydown",n))})}function b(){var e=document.querySelector(".tiptap-image-popover");e&&e.remove()}function H(e,i){b();var r=document.createElement("div");r.className="tiptap-image-popover";var t="",l="ticket",s=document.querySelector('input[name="id"], input[name="itemId"], input[name="ticketId"]');if(s&&s.value&&(t=s.value),window.location.href.indexOf("/wiki/")>-1||window.location.href.indexOf("/docs/")>-1){l="wiki";var d=document.querySelector('input[name="id"]');d&&(t=d.value)}window.location.href.indexOf("/projects/")>-1&&(l="project"),!t&&window.leantime&&window.leantime.currentProject&&(t=window.leantime.currentProject,l="project"),r.innerHTML='<div class="tiptap-image-popover__content"><div class="tiptap-image-popover__option tiptap-image-popover__upload"><input type="file" accept="image/*" class="tiptap-image-popover__file-input" /><span class="tiptap-image-popover__icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg></span><span>Upload image</span></div><div class="tiptap-image-popover__divider"></div><div class="tiptap-image-popover__url-section"><input type="text" placeholder="Or paste image URL..." class="tiptap-image-popover__url-input" /><button type="button" class="tiptap-image-popover__url-btn">Insert</button></div></div>';var p=i.getBoundingClientRect(),n=window.pageYOffset||document.documentElement.scrollTop,o=window.pageXOffset||document.documentElement.scrollLeft;r.style.position="absolute",r.style.top=p.bottom+n+4+"px",r.style.left=p.left+o+"px",r.style.zIndex="10001",document.body.appendChild(r);var c=r.querySelector(".tiptap-image-popover__file-input"),a=r.querySelector(".tiptap-image-popover__upload");a.addEventListener("click",function(){c.click()}),c.addEventListener("change",function(v){var y=v.target.files[0];if(y){a.innerHTML='<span class="tiptap-image-popover__loading">Uploading...</span>';var A=new FormData;A.append("file",y);var _=leantime.appUrl+"/api/files";l&&t&&(_+="?module="+l+"&moduleId="+t),fetch(_,{method:"POST",body:A,credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(g){if(!g.ok)throw new Error("Upload failed");return g.json()}).then(function(g){var z=leantime.appUrl+"/files/get?module="+g.module+"&encName="+g.encName+"&ext="+g.extension+"&realName="+g.realName;e.chain().focus().setImage({src:z,alt:g.realName}).run(),b()}).catch(function(g){console.error("Image upload failed:",g),a.innerHTML='<span style="color: var(--error-color)">Upload failed. Try again.</span>',setTimeout(function(){b()},2e3)})}});var u=r.querySelector(".tiptap-image-popover__url-input"),f=r.querySelector(".tiptap-image-popover__url-btn");f.addEventListener("click",function(){var v=u.value.trim();v&&(e.chain().focus().setImage({src:v}).run(),b())}),u.addEventListener("keypress",function(v){v.key==="Enter"&&f.click()}),setTimeout(function(){document.addEventListener("click",function v(y){!r.contains(y.target)&&y.target!==i&&(b(),document.removeEventListener("click",v))})},10),document.addEventListener("keydown",function v(y){y.key==="Escape"&&(b(),document.removeEventListener("keydown",v))}),setTimeout(function(){u.focus()},50)}function R(e,i){var r=L[i]||L.complex,t=document.createElement("div");t.className="tiptap-toolbar tiptap-toolbar--"+r.position,t.setAttribute("role","toolbar"),t.setAttribute("aria-label","Text formatting");var l=document.createElement("div");if(l.className="tiptap-toolbar__group",r.buttons.forEach(function(n){if(n==="|"){var o=document.createElement("div");o.className="tiptap-toolbar__separator",l.appendChild(o);return}var c=k[n];if(c){var a=document.createElement("button");a.type="button",a.className="tiptap-toolbar__button",a.setAttribute("data-command",n),a.setAttribute("title",c.title),a.setAttribute("aria-label",c.title),a.innerHTML=c.icon,a.addEventListener("click",function(u){u.preventDefault(),u.stopPropagation(),c.command(e,a)}),l.appendChild(a)}}),t.appendChild(l),window.leantime&&window.leantime.tiptapController){var s=window.leantime.tiptapController.getToolbarButtons();if(s&&s.size>0){var d=document.createElement("div");d.className="tiptap-toolbar__separator",l.appendChild(d),s.forEach(function(n,o){var c=document.createElement("button");c.type="button",c.className="tiptap-toolbar__button tiptap-toolbar__button--plugin",c.setAttribute("data-command",o),c.setAttribute("title",n.title||n.label||o),c.setAttribute("aria-label",n.title||n.label||o),c.innerHTML=n.icon||"<span>"+(n.label||o)+"</span>",c.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation(),n.action?n.action(e,c):n.command&&n.command(e,c)}),l.appendChild(c)})}}var p=function(){var n=t.querySelectorAll(".tiptap-toolbar__button");n.forEach(function(o){var c=o.getAttribute("data-command"),a=k[c];a&&(a.isActive&&(a.isActive(e)?(o.classList.add("is-active"),o.setAttribute("aria-pressed","true")):(o.classList.remove("is-active"),o.setAttribute("aria-pressed","false"))),a.isDisabled&&(a.isDisabled(e)?(o.classList.add("is-disabled"),o.setAttribute("aria-disabled","true")):(o.classList.remove("is-disabled"),o.setAttribute("aria-disabled","false"))))})};return e.on("selectionUpdate",p),e.on("transaction",p),setTimeout(p,0),{element:t,position:r.position,update:p,destroy:function(){e.off("selectionUpdate",p),e.off("transaction",p),t.parentNode&&t.parentNode.removeChild(t)}}}function j(e,i){var r=e.element.closest(".tiptap-wrapper");r||(r=e.element.parentElement),i.position==="top"?r.insertBefore(i.element,r.firstChild):r.appendChild(i.element)}window.leantime=window.leantime||{},window.leantime.tiptapToolbar={create:R,attach:j,buttons:k,configs:L,registerButton:function(e,i){k[e]=i},setConfig:function(e,i){L[e]=i}},console.log("[Tiptap] Toolbar extension loaded")})();
