import{j as S}from"./jquery-CED9k22g.js";import"./_commonjsHelpers-BosuxZz1.js";import"./jquery-Czc5UB_B.js";(function(d){var v=function(r,l){if(this.$element=d(r),this.type=this.$element.data("uploadtype")||(this.$element.find(".thumbnail").length>0?"image":"file"),this.$input=this.$element.find(":file"),this.$input.length!==0){this.name=this.$input.attr("name")||l.name,this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]'),this.$hidden.length===0&&(this.$hidden=d('<input type="hidden" />'),this.$element.prepend(this.$hidden)),this.$preview=this.$element.find(".fileupload-preview");var a=this.$preview.css("height");this.$preview.css("display")!="inline"&&a!="0px"&&a!="none"&&this.$preview.css("line-height",a),this.original={exists:this.$element.hasClass("fileupload-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()},this.$remove=this.$element.find('[data-dismiss="fileupload"]'),this.$element.find('[data-trigger="fileupload"]').on("click.fileupload",d.proxy(this.trigger,this)),this.listen()}};v.prototype={listen:function(){this.$input.on("change.fileupload",d.proxy(this.change,this)),d(this.$input[0].form).on("reset.fileupload",d.proxy(this.reset,this)),this.$remove&&this.$remove.on("click.fileupload",d.proxy(this.clear,this))},change:function(r,l){if(l!=="clear"){var a=r.target.files!==void 0?r.target.files[0]:r.target.value?{name:r.target.value.replace(/^.+\\/,"")}:null;if(!a){this.clear();return}if(this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name),this.type==="image"&&this.$preview.length>0&&(typeof a.type<"u"?a.type.match("image.*"):a.name.match("\\.(gif|png|jpe?g)$"))&&typeof FileReader<"u"){var g=new FileReader,c=this.$preview,y=this.$element;g.onload=function($){c.html('<img src="'+$.target.result+'" '+(c.css("max-height")!="none"?'style="max-height: '+c.css("max-height")+';"':"")+" />"),y.addClass("fileupload-exists").removeClass("fileupload-new")},g.readAsDataURL(a)}else this.$preview.text(a.name),this.$element.addClass("fileupload-exists").removeClass("fileupload-new")}},clear:function(r){if(this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name",""),navigator.userAgent.match(/msie/i)){var l=this.$input.clone(!0);this.$input.after(l),this.$input.remove(),this.$input=l}else this.$input.val("");this.$preview.html(""),this.$element.addClass("fileupload-new").removeClass("fileupload-exists"),r&&(this.$input.trigger("change",["clear"]),r.preventDefault())},reset:function(r){this.clear(),this.$hidden.val(this.original.hiddenVal),this.$preview.html(this.original.preview),this.original.exists?this.$element.addClass("fileupload-exists").removeClass("fileupload-new"):this.$element.addClass("fileupload-new").removeClass("fileupload-exists")},trigger:function(r){this.$input.trigger("click"),r.preventDefault()}},d.fn.fileupload=function(r){return this.each(function(){var l=d(this),a=l.data("fileupload");a||l.data("fileupload",a=new v(this,r)),typeof r=="string"&&a[r]()})},d.fn.fileupload.Constructor=v,d(document).on("click.fileupload.data-api",'[data-provides="fileupload"]',function(r){var l=d(this);if(!l.data("fileupload")){l.fileupload(l.data());var a=d(r.target).closest('[data-dismiss="fileupload"],[data-trigger="fileupload"]');a.length>0&&(a.trigger("click.fileupload"),r.preventDefault())}})})(window.jQuery);(function(){var d={allowedParents:{section:["root"],milestone:["section","milestone"],task:["section","milestone","task"],subtask:["task","subtask"]}};function v(e){return e&&e.dataset?e.dataset.itemType:null}function r(e){if(!e)return"root";if(e.dataset&&e.dataset.containerType)return e.dataset.containerType;if(e.dataset&&e.dataset.itemType)return e.dataset.itemType;var i=e.closest(".sortable-item");return i&&i.dataset.itemType||"root"}function l(e){return e&&e.dataset?e.dataset.project:null}function a(e,i){if(!e||!i)return!1;for(var u=i;u;){if(u===e)return!0;var h=u.parentElement?u.parentElement.closest(".sortable-item"):null;u=h}return!1}function g(e,i,u){var h=v(e),o=r(i);if(a(e,i))return!1;if(!u){var s=l(e),t=l(i);if(!t&&i&&i.parentElement){var f=i.parentElement.closest(".sortable-item");t=f?l(f):void 0}if(t!==void 0&&s!==t)return!1}var n=d.allowedParents[h];return!(!n||n.indexOf(o)===-1)}function c(e){var i=e.closest(".sortable-list[data-group-key]");return i?i.dataset.groupKey:null}function y(){var e=[],i="",u=document.getElementById("yourToDoContainer");u&&(i=u.dataset.groupBy||"");var h=[];i&&document.querySelectorAll(".sortable-item").forEach(function(t){var f=t.dataset.id,n=c(t),p=t.dataset.originalGroupKey;p&&n&&p!==n&&h.push({id:f,fromGroup:p,toGroup:n,groupBy:i})});function o(t,f,n){var p=t.querySelectorAll(":scope > .sortable-item");p.forEach(function(m,C){var w=m.dataset.id,E=c(m);e.push({id:w,parentId:f||null,parentType:r(m.parentElement),level:n,order:C,groupKey:E});var b=m.querySelector(":scope > .sortable-list");b&&o(b,w,n+1)})}if(document.querySelectorAll(".sortable-list").forEach(function(t){(!t.parentElement||!t.parentElement.closest(".sortable-list"))&&o(t,null,0)}),e.length>0){var s={};e.forEach(function(t,f){s[f]=JSON.stringify(t)}),h.length>0&&(h.forEach(function(t,f){s["groupChanges["+f+"]"]=JSON.stringify(t)}),s.groupBy=i),htmx.ajax("POST",leantime.appUrl+"/hx/widgets/myToDos/saveSorting",{target:"#htmx-indicator",swap:"none",values:s})}}function $(e){if(e){var i=e.classList.contains("sortable-list")?[e]:Array.from(e.querySelectorAll(".sortable-list"));e.classList.contains("sortable-list")&&i.indexOf(e)===-1&&i.push(e),i.forEach(function(u){u._sortableInstance&&u._sortableInstance.destroy(),u._sortableInstance=new Sortable(u,{group:"nested-sortable",animation:150,fallbackOnBody:!0,swapThreshold:.65,delay:150,delayOnTouchOnly:!0,draggable:".sortable-item",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",handle:".sortable-item",filter:".no-drag",forceFallback:!1,scroll:!0,scrollSensitivity:40,scrollSpeed:20,onStart:function(h){var o=h.item;document.querySelectorAll(".sortable-item").forEach(function(s){s.dataset.originalGroupKey||(s.dataset.originalGroupKey=c(s)||"")}),o.dataset.originalGroupKey=c(o)||"",o.dataset.startParentId=o.parentElement&&o.parentElement.id||""},onMove:function(h){var o=h.dragged,s=h.to;return g(o,s,!1)?(document.querySelectorAll(".highlight-drop-error").forEach(function(t){t.classList.remove("highlight-drop-error")}),document.querySelectorAll(".highlight-drop").forEach(function(t){t.classList.remove("highlight-drop")}),s.classList.add("highlight-drop"),!0):(s.classList.add("highlight-drop-error"),!1)},onEnd:function(h){var o=h.item;document.querySelectorAll(".highlight-drop, .highlight-drop-error").forEach(function(n){n.classList.remove("highlight-drop"),n.classList.remove("highlight-drop-error")}),document.querySelectorAll(".pomodoro-drop-target").forEach(function(n){n.classList.remove("pomodoro-drop-target")});var s=o.parentElement;if(!(!s||!s.classList.contains("sortable-list"))){if(!g(o,s,!0)){var t=document.getElementById(o.dataset.startParentId);t&&t.appendChild(o);var f="Nesting not allowed here";typeof leantime<"u"&&leantime.toast&&leantime.toast.show({message:f,style:"error"});return}setTimeout(function(){document.querySelectorAll(".sortable-list").forEach(function(n){if(n.querySelectorAll(":scope > .sortable-item").length===0){var p=n.parentElement;if(p&&p.classList.contains("sortable-item")){var m=p.querySelector(".accordion-toggle");m&&m.remove()}}})},300),y(),document.querySelectorAll(".sortable-item").forEach(function(n){delete n.dataset.originalGroupKey})}}})})}}var x=window.leantime||(window.leantime={});x.nestedSortable={init:$,saveSorting:y,isNestingAllowed:g}})();window.jQuery=S;window.$=S;
