leantime.clientsController=function(){var l=function(){jQuery(".projectDateFrom, .projectDateTo").datepicker({dateFormat:leantime.i18n.__("language.dateformat"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader")})},n=function(){jQuery(".clientTabs").tabs()},d=function(){document.addEventListener("DOMContentLoaded",function(){jQuery("#allClientsTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")}},dom:'<"top">rt<"bottom"ilp><"clear">',searching:!1,displayLength:100})})};return{initDates:l,initClientTabs:n,initClientTable:d}}();leantime.canvasController=function(){var l="",n=function(o){l=o},d=function(){window.addEventListener("load",function(){document.querySelectorAll(".loading").forEach(function(o){o.style.display="none"}),document.querySelectorAll(".filterBar .row-fluid").forEach(function(o){o.style.opacity="1"})})},c=function(){jQuery(".addCanvasLink").nyroModal(),document.querySelectorAll(".editCanvasLink").forEach(function(o){o.addEventListener("click",function(){jQuery("#editCanvas").modal("show")})}),document.querySelectorAll(".cloneCanvasLink").forEach(function(o){o.addEventListener("click",function(){jQuery("#cloneCanvas").modal("show")})}),document.querySelectorAll(".mergeCanvasLink").forEach(function(o){o.addEventListener("click",function(){jQuery("#mergeCanvas").modal("show")})}),document.querySelectorAll(".importCanvasLink").forEach(function(o){o.addEventListener("click",function(){jQuery("#importCanvas").modal("show")})})},e=!1,t={sizes:{minW:700,minH:1e3},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(o){o.style.display=""}),e==!0&&(e=!1,location.reload())},afterShowCont:function(){window.htmx.process("#global-modal-content"),jQuery("."+l+"CanvasModal, #commentForm, #commentForm .deleteComment, ."+l+"CanvasMilestone .deleteMilestone").nyroModal(t)},beforeClose:function(){location.reload()}},titleFromIframe:!0},f=function(){jQuery("."+l+"CanvasModal, #commentForm, #commentForm .deleteComment, ."+l+"CanvasMilestone .deleteMilestone").nyroModal(t)},s=function(o){jQuery.nmManual(o,t)},a=function(o){if(o=="existing"){document.querySelectorAll("#newMilestone, #milestoneSelectors").forEach(function(k){k.style.display="none"});var p=document.getElementById("existingMilestone");p&&(p.style.display=""),f()}if(o=="new"){var h=document.getElementById("newMilestone");h&&(h.style.display=""),document.querySelectorAll("#existingMilestone, #milestoneSelectors").forEach(function(k){k.style.display="none"}),f()}if(o=="hide"){document.querySelectorAll("#newMilestone, #existingMilestone").forEach(function(k){k.style.display="none"});var E=document.getElementById("milestoneSelectors");E&&(E.style.display="")}},r=function(){e=!0},u=function(){document.body.addEventListener("click",function(o){var p=o.target.closest(".userDropdown .dropdown-menu a");if(p){var h=p.getAttribute("data-value").split("_");if(p.getAttribute("data-label"),h.length==3){var E=h[0],k=h[1];h[2],fetch(leantime.appUrl+"/api/"+l+"canvas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:E,author:k})}).then(function(){var _=document.querySelector("#userDropdownMenuLink"+E+" span.text span#userImage"+E+" img");_&&_.setAttribute("src",leantime.appUrl+"/api/users?profileImage="+k),leantime.toast.show({message:leantime.i18n.__("short_notifications.user_updated"),style:"success"})})}}})},v=function(){document.body.addEventListener("click",function(o){var p=o.target.closest(".statusDropdown .dropdown-menu a");if(p){var h=p.getAttribute("data-value").split("/"),E=p.getAttribute("data-label");if(h.length==2){var k=h[0],_=h[1],L=p.getAttribute("class");fetch(leantime.appUrl+"/api/"+l+"canvas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:k,status:_})}).then(function(){var y=document.querySelector("#statusDropdownMenuLink"+k+" span.text");y&&(y.textContent=E);var C=document.getElementById("statusDropdownMenuLink"+k);C&&(C.className=L+" dropdown-toggle f-left status "),leantime.toast.show({message:leantime.i18n.__("short_notifications.status_updated")})})}}})},i=function(){document.body.addEventListener("click",function(o){var p=o.target.closest(".relatesDropdown .dropdown-menu a");if(p){var h=p.getAttribute("data-value").split("/"),E=p.getAttribute("data-label");if(h.length==2){var k=h[0],_=h[1],L=p.getAttribute("class");fetch(leantime.appUrl+"/api/"+l+"canvas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:k,relates:_})}).then(function(){var y=document.querySelector("#relatesDropdownMenuLink"+k+" span.text");y&&(y.textContent=E);var C=document.getElementById("relatesDropdownMenuLink"+k);C&&(C.className=L+" dropdown-toggle f-left relates "),leantime.toast.show({message:leantime.i18n.__("short_notifications.relates_updated")})})}}})},g=function(o,p){p=p||{};var h=o,E=!1,k=function(){return{sizes:{minW:700,minH:1e3},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(x){x.style.display=""}),E&&(E=!1,location.reload())},afterShowCont:function(){window.htmx.process("#global-modal-content"),jQuery("."+h+"CanvasModal, #commentForm, #commentForm .deleteComment, ."+h+"CanvasMilestone .deleteMilestone").nyroModal(k())},beforeClose:function(){location.reload()}},titleFromIframe:!0}},_=function(){jQuery("."+h+"CanvasModal, #commentForm, #commentForm .deleteComment, ."+h+"CanvasMilestone .deleteMilestone").nyroModal(k())},L;p.rowSelectors&&p.rowSelectors.length>0?L=function(){p.rowSelectors.forEach(function(x){var H=0;document.querySelectorAll("#"+x+" div.contentInner").forEach(function(b){b.offsetHeight>H&&(H=b.offsetHeight+35)}),document.querySelectorAll("#"+x+" .column .contentInner").forEach(function(b){b.style.height=H+"px"})})}:p.nbRows&&p.nbRows>0?L=function(){var x=p.nbRows,H=["firstRow","secondRow","thirdRow","fourthRow"],b=document.documentElement.offsetHeight-320-20*x;x===2&&(b-=25);for(var j=0;j<x&&j<H.length;j++){var R="#"+H[j],I=b/x;x>=3&&(I=b*.333),document.querySelectorAll(R+" div.contentInner").forEach(function(X){X.offsetHeight>I&&(I=X.offsetHeight+50)}),document.querySelectorAll(R+" .column .contentInner").forEach(function(X){X.style.height=I+"px"})}}:L=function(){};var y={setCloseModal:function(){E=!0},toggleMilestoneSelectors:function(x){if(x=="existing"){document.querySelectorAll("#newMilestone, #milestoneSelectors").forEach(function(R){R.style.display="none"});var H=document.getElementById("existingMilestone");H&&(H.style.display=""),_()}if(x=="new"){var b=document.getElementById("newMilestone");b&&(b.style.display=""),document.querySelectorAll("#existingMilestone, #milestoneSelectors").forEach(function(R){R.style.display="none"}),_()}if(x=="hide"){document.querySelectorAll("#newMilestone, #existingMilestone").forEach(function(R){R.style.display="none"});var j=document.getElementById("milestoneSelectors");j&&(j.style.display="")}},openModalManually:function(x){jQuery.nmManual(x,k)},initUserDropdown:u,initStatusDropdown:v,initRelatesDropdown:i,setRowHeights:L};if(p.extras)for(var C in p.extras)p.extras.hasOwnProperty(C)&&(y[C]=p.extras[C]);return y};return{setCanvasName:n,initFilterBar:d,initCanvasLinks:c,initUserDropdown:u,initStatusDropdown:v,initRelatesDropdown:i,setCloseModal:r,toggleMilestoneSelectors:a,openModalManually:s,createController:g}}();leantime.cpCanvasController=leantime.canvasController.createController("cp",{nbRows:4});leantime.dbmCanvasController=leantime.canvasController.createController("dbm",{nbRows:3});leantime.eaCanvasController=leantime.canvasController.createController("ea",{nbRows:2});leantime.emCanvasController=leantime.canvasController.createController("em",{nbRows:4});var O=O||{};window.SNAKE=O;O.addEventListener=function(){if(window.addEventListener)return function(l,n,d,c){l.addEventListener(n,d,c)};if(window.attachEvent)return function(l,n,d){l.attachEvent("on"+n,d)}}();O.removeEventListener=function(){if(window.removeEventListener)return function(l,n,d,c){l.removeEventListener(n,d,c)};if(window.detachEvent)return function(l,n,d){l.detachEvent("on"+n,d)}}();O.Snake=O.Snake||function(){var l=[],n=function(){this.elm=null,this.elmStyle=null,this.row=-1,this.col=-1,this.xPos=-1e3,this.yPos=-1e3,this.next=null,this.prev=null};function d(c){var e=0,t=0,f;for(f in c)c[f].elm.currentStyle?t=parseFloat(c[f].elm.style["z-index"],10):window.getComputedStyle&&(t=parseFloat(document.defaultView.getComputedStyle(c[f].elm,null).getPropertyValue("z-index"),10)),!isNaN(t)&&t>e&&(e=t);return e+1}return function(c){if(!c||!c.playingBoard)return;localStorage.jsSnakeHighScore===void 0&&localStorage.setItem("jsSnakeHighScore",0);var e=this,t=c.playingBoard,f=5,s=1,a=-1,r=!0,u=!0,v=-1,i=[0,1,0,-1],g=[-1,0,1,0],o=[],p=[],h=80,E=!1,k=!1,_=document.getElementById("selectMode");_&&_.addEventListener("change",function(H){H=H||{};var b=H.target?parseInt(H.target.value):75;(isNaN(b)||b<25)&&(b=75),h=b,setTimeout(function(){document.getElementById("game-area").focus()},10)}),e.snakeBody={},e.snakeBody.b0=new n,e.snakeBody.b0.row=c.startRow||1,e.snakeBody.b0.col=c.startCol||1,e.snakeBody.b0.xPos=e.snakeBody.b0.row*t.getBlockWidth(),e.snakeBody.b0.yPos=e.snakeBody.b0.col*t.getBlockHeight(),e.snakeBody.b0.elm=L(),e.snakeBody.b0.elmStyle=e.snakeBody.b0.elm.style,t.getBoardContainer().appendChild(e.snakeBody.b0.elm),e.snakeBody.b0.elm.style.left=e.snakeBody.b0.xPos+"px",e.snakeBody.b0.elm.style.top=e.snakeBody.b0.yPos+"px",e.snakeBody.b0.next=e.snakeBody.b0,e.snakeBody.b0.prev=e.snakeBody.b0,e.snakeLength=1,e.snakeHead=e.snakeBody.b0,e.snakeTail=e.snakeBody.b0,e.snakeHead.elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),e.snakeHead.elm.id="snake-snakehead-alive",e.snakeHead.elm.className+=" snake-snakebody-alive";function L(){var H=document.createElement("div");return H.className="snake-snakebody-block",H.style.left="-1000px",H.style.top="-1000px",H.style.width=t.getBlockWidth()+"px",H.style.height=t.getBlockHeight()+"px",H}function y(H){for(var b,j=L(),R=1;R<H;R++)b=new n,b.elm=j.cloneNode(!0),b.elmStyle=b.elm.style,t.getBoardContainer().appendChild(b.elm),l[l.length]=b;b=new n,b.elm=j,t.getBoardContainer().appendChild(b.elm),l[l.length]=b}function C(){var H=localStorage.jsSnakeHighScore;e.snakeLength>H&&(alert("Congratulations! You have beaten your previous high score, which was "+H+"."),localStorage.setItem("jsSnakeHighScore",e.snakeLength))}function x(H){C(),e.snakeHead.elm.style.zIndex=d(e.snakeBody),e.snakeHead.elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-alive\b/,""),e.snakeHead.elm.className+=" snake-snakebody-dead",E=!0,H()}e.setPaused=function(H){k=H},e.getPaused=function(){return k},e.handleArrowKeys=function(H){if(E||k&&!c.premoveOnPause)return;e.snakeLength;let b=-1;switch(H){case 37:case 65:b=3;break;case 38:case 87:b=0;break;case 39:case 68:b=1;break;case 40:case 83:b=2;break}v!==s&&(a=b),(Math.abs(b-s)!==2&&(r||k)||u)&&(v=b,r=!1,u=!1)},e.go=function(){var H=e.snakeHead,b=e.snakeTail,j=t.grid;if(k===!0){setTimeout(function(){e.go()},h);return}if(e.snakeTail=b.prev,e.snakeHead=b,j[b.row]&&j[b.row][b.col]&&(j[b.row][b.col]=0),v!==-1&&(s=v,a!==-1&&(v=a,a=-1)),r=!0,b.col=H.col+i[s],b.row=H.row+g[s],b.xPos=H.xPos+o[s],b.yPos=H.yPos+p[s],b.elmStyle||(b.elmStyle=b.elm.style),b.elmStyle.left=b.xPos+"px",b.elmStyle.top=b.yPos+"px",e.snakeLength>1&&(b.elm.id="snake-snakehead-alive",H.elm.id=""),j[b.row][b.col]===0)j[b.row][b.col]=1,setTimeout(function(){e.go()},h);else if(j[b.row][b.col]>0)e.handleDeath();else if(j[b.row][b.col]===t.getGridFoodValue()){if(j[b.row][b.col]=1,!e.eatFood()){e.handleWin();return}setTimeout(function(){e.go()},h)}},e.eatFood=function(){l.length<=f&&y(f*2);for(var H=l.splice(0,f),b=H.length,j,R=e.snakeTail;b--;)j="b"+e.snakeLength++,e.snakeBody[j]=H[b],e.snakeBody[j].prev=R,e.snakeBody[j].elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),e.snakeBody[j].elm.className+=" snake-snakebody-alive",R.next=e.snakeBody[j],R=e.snakeBody[j];if(e.snakeTail=e.snakeBody[j],e.snakeTail.next=e.snakeHead,e.snakeHead.prev=e.snakeTail,!t.foodEaten())return!1;var I=document.getElementById("selectMode"),X=I.options[I.selectedIndex];return X.text.localeCompare("Rush")==0&&(h>30?h-=5:h=30),!0},e.handleDeath=function(){var H=document.getElementById("selectMode").value;h=parseInt(H),x(t.handleDeath)},e.handleWin=function(){x(t.handleWin)},e.rebirth=function(){E=!1,r=!0,u=!0,a=-1},e.reset=function(){if(E!==!1){for(var H=[],b=e.snakeHead.next,j;b!==e.snakeHead;)j=b.next,b.prev=null,b.next=null,H.push(b),b=j;e.snakeHead.next=e.snakeHead,e.snakeHead.prev=e.snakeHead,e.snakeTail=e.snakeHead,e.snakeLength=1;for(var R=0;R<H.length;R++)H[R].elm.style.left="-1000px",H[R].elm.style.top="-1000px",H[R].elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),H[R].elm.className+=" snake-snakebody-alive";l.concat(H),e.snakeHead.elm.className=e.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,""),e.snakeHead.elm.className+=" snake-snakebody-alive",e.snakeHead.elm.id="snake-snakehead-alive",e.snakeHead.row=c.startRow||1,e.snakeHead.col=c.startCol||1,e.snakeHead.xPos=e.snakeHead.row*t.getBlockWidth(),e.snakeHead.yPos=e.snakeHead.col*t.getBlockHeight(),e.snakeHead.elm.style.left=e.snakeHead.xPos+"px",e.snakeHead.elm.style.top=e.snakeHead.yPos+"px"}},y(f*2),o[0]=0,o[1]=t.getBlockWidth(),o[2]=0,o[3]=-1*t.getBlockWidth(),p[0]=-1*t.getBlockHeight(),p[1]=0,p[2]=t.getBlockHeight(),p[3]=0}}();O.Food=O.Food||function(){var l=0;function n(d,c){return Math.floor(Math.random()*(c+1-d))+d}return function(d){if(!(!d||!d.playingBoard)){var c=this,e=d.playingBoard,t,f,s=l++,a=document.createElement("div");a.setAttribute("id","snake-food-"+s),a.className="snake-food-block",a.style.width=e.getBlockWidth()+"px",a.style.height=e.getBlockHeight()+"px",a.style.left="-1000px",a.style.top="-1000px",e.getBoardContainer().appendChild(a),c.getFoodElement=function(){return a},c.randomlyPlaceFood=function(){e.grid[t]&&e.grid[t][f]===e.getGridFoodValue()&&(e.grid[t][f]=0);for(var r=0,u=0,v=0,i=e.grid.length-1,g=e.grid[0].length-1;e.grid[r][u]!==0;)if(r=n(1,i),u=n(1,g),v++,v>2e4)return!1;return e.grid[r][u]=e.getGridFoodValue(),t=r,f=u,a.style.top=r*e.getBlockHeight()+"px",a.style.left=u*e.getBlockWidth()+"px",!0}}}}();O.Board=O.Board||function(){var l=0;function n(e){var t=0,f=0,s;for(s in e)e[s].elm.currentStyle?f=parseFloat(e[s].elm.style["z-index"],10):window.getComputedStyle&&(f=parseFloat(document.defaultView.getComputedStyle(e[s].elm,null).getPropertyValue("z-index"),10)),!isNaN(f)&&f>t&&(t=f);return t+1}function d(){var e=0;return typeof window.innerWidth=="number"?e=window.innerWidth:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?e=document.documentElement.clientWidth:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e=document.body.clientWidth),e}function c(){var e=0;return typeof window.innerHeight=="number"?e=window.innerHeight:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?e=document.documentElement.clientHeight:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e=document.body.clientHeight),e}return function(e){var t=this,f=l++,s=e||{},a=250,r=250,u=20,v=20,i=-1,g,o,p=1,h,E=!1,k,_,L,y,C,x,H,b,j;t.grid=[];function R(){_=document.createElement("div"),_.setAttribute("id","playingField"),_.className="snake-playing-field",O.addEventListener(_,"click",function(){k.focus()},!1),j=document.createElement("div"),j.className="snake-pause-screen",j.innerHTML="<div style='padding:10px;'>[Paused]<p/>Press [space] to unpause.</div>",L=document.createElement("div"),L.className="snake-panel-component",L.innerHTML="<a href='http://patorjk.com/blog/software/' class='snake-link'>more patorjk.com apps</a> - <a href='https://github.com/patorjk/JavaScript-Snake' class='snake-link'>source code</a> - <a href='https://www.youtube.com/channel/UCpcCLm9y6CsjHUrCvJHYHUA' class='snake-link'>pat's youtube</a>",y=document.createElement("div"),y.className="snake-panel-component",y.innerHTML="Length: 1",C=document.createElement("div"),C.className="snake-panel-component",C.innerHTML="Highscore: "+(localStorage.jsSnakeHighScore||0),x=ee(),H=de(),b=T(),O.addEventListener(k,"keyup",function(w){if(!w)var w=window.event;return w.cancelBubble=!0,w.stopPropagation&&w.stopPropagation(),w.preventDefault&&w.preventDefault(),!1},!1),k.className="snake-game-container",j.style.zIndex=1e4,k.appendChild(j),k.appendChild(_),k.appendChild(L),k.appendChild(y),k.appendChild(C),k.appendChild(x),k.appendChild(H),k.appendChild(b),o=new O.Snake({playingBoard:t,startRow:2,startCol:2,premoveOnPause:s.premoveOnPause}),g=new O.Food({playingBoard:t}),x.style.zIndex=1e3}function I(){return a*t.getBlockWidth()}function X(){return r*t.getBlockHeight()}function ee(){var m=document.createElement("div");m.id="sbWelcome"+f,m.className="snake-welcome-dialog";var w=document.createElement("div"),Q="";s.fullScreen&&(Q="On Windows, press F11 to play in Full Screen mode."),w.innerHTML="JavaScript Snake<p></p>Use the <strong>arrow keys</strong> on your keyboard to play the game. "+Q+"<p></p>";var S=document.createElement("button");S.appendChild(document.createTextNode("Play Game"));var M=function(){O.removeEventListener(window,"keyup",q,!1),m.style.display="none",t.setBoardState(1),t.getBoardContainer().focus()},q=function(B){if(!B)var B=window.event;var F=B.which?B.which:B.keyCode;(F===32||F===13)&&M()};return O.addEventListener(window,"keyup",q,!1),O.addEventListener(S,"click",M,!1),m.appendChild(w),m.appendChild(S),m}function oe(m,w,Q){var S=document.createElement("div");S.id=w+f,S.className=Q;var M=document.createElement("div");M.innerHTML="JavaScript Snake<p></p>"+m+"<p></p>";var q=document.createElement("button");q.appendChild(document.createTextNode("Play Again?"));var U=function(){S.style.display="none",t.resetBoard(),t.setBoardState(1),t.getBoardContainer().focus()},B=function(A){if(!(p!==0||S.style.display!=="block")){if(!A)var A=window.event;var W=A.which?A.which:A.keyCode;(W===32||W===13)&&U()}};return O.addEventListener(window,"keyup",B,!0),O.addEventListener(q,"click",U,!1),S.appendChild(M),S.appendChild(q),S}function de(){return oe("You died :(","sbTryAgain","snake-try-again-dialog")}function T(){return oe("You win! :D","sbWin","snake-win-dialog")}function D(m){var w=Math.max(n(o.snakeBody),n({tmp:{elm:g.getFoodElement()}}));k.removeChild(m),k.appendChild(m),m.style.zIndex=w,m.style.display="block",t.setBoardState(0)}t.setPaused=function(m){E=m,o.setPaused(m),E?j.style.display="block":j.style.display="none"},t.getPaused=function(){return E},t.resetBoard=function(){O.removeEventListener(k,"keydown",h,!1),o.reset(),y.innerHTML="Length: 1",t.setupPlayingField()},t.getBoardState=function(){return p},t.setBoardState=function(m){p=m},t.getGridFoodValue=function(){return i},t.getPlayingFieldElement=function(){return _},t.setBoardContainer=function(m){typeof m=="string"&&(m=document.getElementById(m)),m!==k&&(k=m,_=null,t.setupPlayingField())},t.getBoardContainer=function(){return k},t.getBlockWidth=function(){return u},t.getBlockHeight=function(){return v},t.setupPlayingField=function(){_||R();var m,w,Q,S;s.fullScreen===!0?(Q=0,S=0,m=d()-20,w=c()-20):(Q=s.top,S=s.left,m=s.width,w=s.height);var M=t.getBlockWidth()*2+m%t.getBlockWidth(),q=Math.min(I()-M,m-M),U=t.getBlockHeight()*3+w%t.getBlockHeight(),B=Math.min(X()-U,w-U);k.style.left=S+"px",k.style.top=Q+"px",k.style.width=m+"px",k.style.height=w+"px",_.style.left=t.getBlockWidth()+"px",_.style.top=t.getBlockHeight()+"px",_.style.width=q+"px",_.style.height=B+"px";var F=U-t.getBlockHeight(),A=t.getBlockHeight()+B+Math.round((F-30)/2)+"px";L.style.top=A,L.style.width="450px",L.style.left=Math.round(m/2)-Math.round(450/2)+"px",y.style.top=A,y.style.left="30px",C.style.top=A,C.style.left=m-140+"px",m<700?L.style.display="none":L.style.display="block",t.grid=[];for(var W=q/t.getBlockWidth()+2,P=B/t.getBlockHeight()+2,N=0;N<P;N++){t.grid[N]=[];for(var Y=0;Y<W;Y++)Y===0||N===0||Y===W-1||N===P-1?t.grid[N][Y]=1:t.grid[N][Y]=0}g.randomlyPlaceFood(),h=function(z){if(!z)var z=window.event;var G=z.which?z.which:z.keyCode;if(t.getBoardState()===1){if(!(G>=37&&G<=40)&&!(G===87||G===65||G===83||G===68))return;O.removeEventListener(k,"keydown",h,!1),h=function(K){if(!K)var K=window.event;var V=K.which?K.which:K.keyCode;return V===32&&t.getBoardState()!=0&&t.setPaused(!t.getPaused()),o.handleArrowKeys(V),K.cancelBubble=!0,K.stopPropagation&&K.stopPropagation(),K.preventDefault&&K.preventDefault(),!1},O.addEventListener(k,"keydown",h,!1),o.rebirth(),o.handleArrowKeys(G),t.setBoardState(2),o.go()}return z.cancelBubble=!0,z.stopPropagation&&z.stopPropagation(),z.preventDefault&&z.preventDefault(),!1},O.addEventListener(k,"keydown",h,!1)},t.foodEaten=function(){return y.innerHTML="Length: "+o.snakeLength,o.snakeLength>localStorage.jsSnakeHighScore&&(localStorage.setItem("jsSnakeHighScore",o.snakeLength),C.innerHTML="Highscore: "+localStorage.jsSnakeHighScore),!!g.randomlyPlaceFood()},t.handleDeath=function(){D(H)},t.handleWin=function(){D(b)},s.fullScreen=typeof s.fullScreen>"u"?!1:s.fullScreen,s.top=typeof s.top>"u"?0:s.top,s.left=typeof s.left>"u"?0:s.left,s.width=typeof s.width>"u"?400:s.width,s.height=typeof s.height>"u"?400:s.height,s.premoveOnPause=typeof s.premoveOnPause>"u"?!1:s.premoveOnPause,s.fullScreen&&O.addEventListener(window,"resize",function(){t.setupPlayingField()},!1),t.setBoardState(0),s.boardContainer&&t.setBoardContainer(s.boardContainer)}}();leantime.goalCanvasController=leantime.canvasController.createController("goal",{extras:{initProgressChart:function(l,n,d){var c={type:"doughnut",data:{datasets:[{data:[n,d],backgroundColor:[leantime.dashboardController.chartColors.green,leantime.dashboardController.chartColors.grey],label:leantime.i18n.__("label.project_done")}],labels:[n+"%"]},options:{maintainAspectRatio:!0,responsive:!0,plugins:{legend:{position:"none"},title:{display:!1,text:"Complete"}},animation:{animateScale:!0,animateRotate:!0}}},e=document.getElementById(l).getContext("2d");new Chart(e,c)}}});leantime.ideasController=function(){var l=!1,n=function(){return{sizes:{minW:700,minH:1e3},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(g){g.style.display=""}),l==!0&&(l=!1,location.reload())},afterShowCont:function(){jQuery(".ideaModal, #commentForm, #commentForm .deleteComment, .leanCanvasMilestone .deleteMilestone").nyroModal(n())}}}},d=function(){jQuery(".ideaModal, #commentForm, #commentForm .deleteComment, .leanCanvasMilestone .deleteMilestone").nyroModal(n())},c=function(g){jQuery.nmManual(g,n)},e=function(){var g=document.querySelector("#ideaMason");if(!g)return;var o=new Packery(g,{itemSelector:".ticketBox",columnWidth:260,isResizable:!0});imagesLoaded(g).on("progress",function(){o.layout()});var p=g.querySelectorAll(".ticketBox");p.forEach(function(k){var _=new Draggabilly(k);_.on("dragStart",function(){k.classList.add("tilt"),h(k)}),_.on("dragEnd",function(){k.classList.remove("tilt"),k._moveHandler&&(document.removeEventListener("mousemove",k._moveHandler),delete k._moveHandler)}),o.bindDraggabillyEvents(_)});function h(k){var _=k.getBoundingClientRect().left,L=function(y){y.pageX>=_?(k.classList.add("right"),k.classList.remove("left")):(k.classList.add("left"),k.classList.remove("right")),_=y.pageX};document.addEventListener("mousemove",L),k._moveHandler=L}o.on("dragItemPositioned",E);function E(){var k=[],_=o.getItemElements();_.forEach(function(L,y){var C=y+1,x=L.getAttribute("data-value");k.push({id:x,sortIndex:C})}),fetch(leantime.appUrl+"/api/ideas",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({action:"ideaSort",payload:JSON.stringify(k)})})}},t=function(){},f=function(){document.querySelectorAll(".mainIdeaContent img").forEach(function(g){var o=document.createElement("a");o.href=g.getAttribute("src"),o.className="imageModal",g.parentElement.insertBefore(o,g),o.appendChild(g)}),jQuery(".imageModal").nyroModal()},s=function(g){if(g=="existing"){var o=document.querySelector("#newMilestone"),p=document.querySelector("#milestoneSelectors"),h=document.querySelector("#existingMilestone");o&&(o.style.display="none"),p&&(p.style.display="none"),h&&(h.style.display=""),d()}if(g=="new"){var o=document.querySelector("#newMilestone"),h=document.querySelector("#existingMilestone"),p=document.querySelector("#milestoneSelectors");o&&(o.style.display=""),h&&(h.style.display="none"),p&&(p.style.display="none"),d()}if(g=="hide"){var o=document.querySelector("#newMilestone"),h=document.querySelector("#existingMilestone"),p=document.querySelector("#milestoneSelectors");o&&(o.style.display="none"),h&&(h.style.display="none"),p&&(p.style.display="")}},a=function(){l=!0},r=function(){document.body.addEventListener("click",function(g){var o=g.target.closest(".userDropdown .dropdown-menu a");if(o){var p=o.getAttribute("data-value").split("_");if(o.getAttribute("data-label"),p.length==3){var h=p[0],E=p[1];p[2],fetch(leantime.appUrl+"/api/ideas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:h,author:E})}).then(function(){var k=document.querySelector("#userDropdownMenuLink"+h+" span.text span#userImage"+h+" img");k&&k.setAttribute("src",leantime.appUrl+"/api/users?profileImage="+E),leantime.toast.show({message:leantime.i18n.__("short_notifications.user_updated"),style:"success"})})}}})},u=function(){document.body.addEventListener("click",function(g){var o=g.target.closest(".statusDropdown .dropdown-menu a");if(o){var p=o.getAttribute("data-value").split("_"),h=o.getAttribute("data-label");if(p.length==3){var E=p[0],k=p[1],_=p[2];fetch(leantime.appUrl+"/api/ideas",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:E,box:k})}).then(function(){var L=document.querySelector("#statusDropdownMenuLink"+E+" span.text");L&&(L.textContent=h);var y=document.querySelector("#statusDropdownMenuLink"+E);y&&(y.className=_+" dropdown-toggle f-left status"),leantime.toast.show({message:leantime.i18n.__("short_notifications.status_updated"),style:"success"})})}}})},v=function(){var g=document.documentElement.scrollHeight-320;document.querySelectorAll("#sortableIdeaKanban .column .contentInner").forEach(function(o){o.style.height=g+"px"})},i=function(g){document.querySelectorAll("#sortableIdeaKanban .ticketBox").forEach(function(h){h.addEventListener("mouseenter",function(){this.style.background="var(--kanban-card-hover)"}),h.addEventListener("mouseleave",function(){this.style.background="var(--kanban-card-bg)"})});function o(h){var E=h.querySelectorAll(":scope > .moveable"),k=[];return E.forEach(function(_){if(_.id){var L=_.id.indexOf("_");L!==-1&&k.push(_.id.substring(0,L)+"[]="+_.id.substring(L+1))}}),k.join("&")}document.querySelectorAll("#sortableIdeaKanban .contentInner").forEach(function(h){h._sortableInstance&&h._sortableInstance.destroy(),h._sortableInstance=new Sortable(h,{group:"idea-kanban",draggable:".moveable",ghostClass:"ui-state-highlight",filter:".portlet-toggle",animation:150,onStart:function(E){E.item.classList.add("tilt"),p(E.item)},onEnd:function(E){E.item.classList.remove("tilt"),E.item._moveHandler&&(document.removeEventListener("mousemove",E.item._moveHandler),delete E.item._moveHandler);for(var k={action:"statusUpdate",payload:{}},_=0;_<g.length;_++){var L=document.querySelector(".contentInner.status_"+g[_]);L&&(k.payload[g[_]]=o(L))}fetch(leantime.appUrl+"/api/ideas",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams(k)})}})});function p(h){var E=h.getBoundingClientRect().left,k=function(_){_.pageX>=E?(h.classList.add("right"),h.classList.remove("left")):(h.classList.add("left"),h.classList.remove("right")),E=_.pageX};document.addEventListener("mousemove",k),h._moveHandler=k}document.querySelectorAll(".portlet").forEach(function(h){var E=h.querySelector(".portlet-header");if(E){var k=document.createElement("span");k.className="portlet-toggle",E.prepend(k)}}),document.querySelectorAll(".portlet-toggle").forEach(function(h){h.addEventListener("click",function(){this.classList.toggle("expanded");var E=this.closest(".portlet").querySelector(".portlet-content");E&&(E.style.display=E.style.display==="none"?"":"none")})})};return{setCloseModal:a,toggleMilestoneSelectors:s,openModalManually:c,initMasonryWall:e,initBoardControlModal:t,initWallImageModals:f,initUserDropdown:r,initStatusDropdown:u,setKanbanHeights:v,initIdeaKanban:i}}();leantime.insightsCanvasController=leantime.canvasController.createController("insights",{nbRows:1});leantime.lbmCanvasController=leantime.canvasController.createController("lbm",{nbRows:2});leantime.leanCanvasController=leantime.canvasController.createController("lean",{nbRows:3});leantime.minempathyCanvasController=leantime.canvasController.createController("minempathy",{nbRows:3});leantime.obmCanvasController=leantime.canvasController.createController("obm",{nbRows:3});leantime.projectsController=function(){function l(){document.querySelectorAll("#sortableTicketKanban .column").forEach(function(_){var L=_.querySelectorAll(".moveable").length,y=_.querySelector(".count");y&&(y.textContent=L)})}var n=function(){jQuery(".projectDateFrom, .projectDateTo").datepicker({dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader")})},d=function(){jQuery(".projectTabs").tabs()},c=function(){var _={sizes:{minW:450,minH:350},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(L){L.style.display=""}),n(),jQuery(".duplicateProjectModal, .formModal").nyroModal(_)},beforeClose:function(){location.reload()}}};jQuery(".duplicateProjectModal").nyroModal(_)},e=function(_){jQuery("#progressbar").progressbar({value:_})},t=function(){document.addEventListener("DOMContentLoaded",function(){jQuery("#allProjectsTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")}},dom:'<"top">rt<"bottom"ilp><"clear">',searching:!1,displayLength:100})})},f=function(_){var L=1,y=typeof _=="string"?document.querySelector(_):_;y.querySelectorAll("input.sorter").forEach(function(C){C.value=L,L++}),y._sortableInstance&&y._sortableInstance.destroy(),y._sortableInstance=new Sortable(y,{animation:150,onEnd:function(){L=1,y.querySelectorAll("input.sorter").forEach(function(C){C.value=L,L++})}})},s=function(){document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("#todosettings select.colorChosen").forEach(function(_){new SlimSelect({select:_,settings:{searchHighlight:!1}})})})},a=function(_){var L=document.querySelector("#todostatus-"+_);L&&L.parentElement&&L.parentElement.remove()},r=function(_){var L=-1;document.querySelectorAll("#todosettings ul .statusList").forEach(function(j){var R=j.querySelector(".labelKey");if(R){var I=R.value;parseInt(I)>=parseInt(L)&&(L=I)}});var y=parseInt(L)+1,C=document.querySelector(".newStatusTpl"),x=C.innerHTML.replaceAll("XXNEWKEYXX",y),H=document.querySelector("#todoStatusList");H.insertAdjacentHTML("beforeend","<li>"+x+"</li>"),document.querySelectorAll("#todosettings select.colorChosen").forEach(function(j){j.slim&&j.slim.destroy()}),leantime.projectsController.initSelectFields();var b=document.querySelector("#todoStatusList");b&&b._sortableInstance&&b._sortableInstance.destroy(),leantime.projectsController.initTodoStatusSortable("#todoStatusList")},u=null,v=function(_){if(i(),_.files&&_.files[0]){var L=new FileReader,y=document.querySelector("#projectAvatar");L.onload=function(C){u=new Croppie(y,{enableExif:!0,viewport:{width:200,height:200,type:"rectangle"},boundary:{width:250,height:250}}),u.bind({url:C.currentTarget.result});var x=document.querySelector("#previousImage");x&&(x.style.display="none")},L.readAsDataURL(_.files[0])}},i=function(){document.querySelector("#profileImg"),u&&(u.destroy(),u=null);var _=document.querySelector("#previousImage");_&&(_.style.display="")},g=function(){var _=document.querySelector("#save-picture");_&&_.classList.add("running");var L=document.querySelector("#profileImg");L&&L.setAttribute("src",leantime.appUrl+"/images/loaders/loader28.gif"),u.result({type:"blob",circle:!1}).then(function(y){var C=new FormData;C.append("file",y),fetch(leantime.appUrl+"/api/projects",{method:"POST",body:C,credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(x){_&&_.classList.remove("running"),location.reload()}).catch(function(x){console.log(x)})})},o=function(_,L,y){function C(x){return String(x).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}document.addEventListener("DOMContentLoaded",function(){if(y===!1)var x=new Gantt("#gantt",_,{header_height:55,column_width:20,step:24,view_modes:["Day","Week","Month"],bar_height:40,static_progress_indicator:!0,bar_corner_radius:10,arrow_curve:10,padding:20,view_mode:"Month",date_format:leantime.i18n.__("language.momentJSDate"),language:"en",additional_rows:5,custom_popup_html:function(b){b._end;var j='<div class="details-container" style="min-width:600px;"> ';return b.projectName!==void 0&&(j+="<h3><b>"+b.name+"</b></h3>"),j+="<h4>"+C(b.name)+"</a></h4><br /> ",j+="</div>",j},on_click:function(b){},on_date_change:function(b,j,R){var I=b.id.split("-");let X=0,ee="";I.length>1?I[0]=="ticket"?(X=I[1],ee="ticket"):I[0]=="pgm"&&(X=I[1],ee="project"):X=I,ee=="ticket"?leantime.ticketsRepository.updateMilestoneDates(X,j,R,b._index+1):fetch(leantime.appUrl+"/api/projects",{method:"PATCH",body:new URLSearchParams({id:X,start:j,end:R,sortIndex:b._index+1}),credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}})},on_sort_change:function(b){for(var j={action:"ganttSort",payload:{}},R=0;R<b.length;R++)j.payload[b[R].id]=b[R]._index+1;fetch(leantime.appUrl+"/api/projects",{method:"POST",body:new URLSearchParams(p(j)),credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}})},on_progress_change:function(b,j){},on_view_change:function(b){leantime.usersRepository.updateUserViewSettings("projectGantt",b)},on_popup_show:function(b){}});else var x=new Gantt("#gantt",_,{readonlyGantt:!0,resizing:!1,progress:!1,is_draggable:!1,custom_popup_html:function(j){task._end;var R='<div class="details-container" style="min-width:600px;"> ';return task.projectName!==void 0&&(R+="<h3><b>"+j.name+"</b></h3>"),R+="<h4>"+C(j.name)+"</a></h4><br /> ",R+="</div>",R},on_click:function(j){},on_date_change:function(j,R,I){},on_progress_change:function(j,R){},on_view_change:function(j){leantime.usersRepository.updateUserViewSettings("projectGantt",j)}});var H=document.querySelector("#ganttTimeControl");H&&H.addEventListener("click",function(b){var j=b.target.closest("a");if(j){var R=j.getAttribute("data-value");x.change_view_mode(R),H.querySelectorAll("a").forEach(function(X){X.classList.remove("active")}),j.classList.add("active");var I=j.textContent;document.querySelectorAll(".viewText").forEach(function(X){X.textContent=I})}}),x.change_view_mode(L)})};function p(_,L){var y={};for(var C in _)if(_.hasOwnProperty(C)){var x=L?L+"["+C+"]":C;typeof _[C]=="object"&&_[C]!==null?Object.assign(y,p(_[C],x)):y[x]=_[C]}return y}var h=function(){document.addEventListener("DOMContentLoaded",function(){l();var _=document.querySelector(".filterBar .row-fluid");_&&(_.style.opacity="1");var L=document.documentElement.scrollHeight-250;document.querySelectorAll("#sortableProjectKanban .column .contentInner").forEach(function(y){y.offsetHeight>L&&(L=y.offsetHeight)}),L=L+50,document.querySelectorAll("#sortableProjectKanban .column .contentInner").forEach(function(y){y.style.minHeight=L+"px"})})},E=function(_){document.querySelectorAll("#sortableProjectKanban .projectBox").forEach(function(C){C.addEventListener("mouseenter",function(){this.style.background="var(--kanban-card-hover)"}),C.addEventListener("mouseleave",function(){this.style.background="var(--kanban-card-bg)"})});function L(C){var x=C.querySelectorAll(":scope > .moveable"),H=[];return x.forEach(function(b){if(b.id){var j=b.id.indexOf("_");j!==-1&&H.push(b.id.substring(0,j)+"[]="+b.id.substring(j+1))}}),H.join("&")}document.querySelectorAll("#sortableProjectKanban .contentInner").forEach(function(C){C._sortableInstance&&C._sortableInstance.destroy(),C._sortableInstance=new Sortable(C,{group:"project-kanban",draggable:".moveable",ghostClass:"ui-state-highlight",filter:".portlet-toggle, input, a, select, textarea",preventOnFilter:!1,animation:150,delay:25,delayOnTouchOnly:!0,onStart:function(x){x.item.classList.add("tilt"),y(x.item)},onEnd:function(x){x.item.classList.remove("tilt"),x.item._moveHandler&&(document.removeEventListener("mousemove",x.item._moveHandler),delete x.item._moveHandler),l();for(var H={action:"sortIndex",payload:{},handler:x.item.id},b=0;b<_.length;b++){var j=document.querySelector(".contentInner.status_"+_[b]);j&&(H.payload[_[b]]=L(j))}fetch(leantime.appUrl+"/api/projects",{method:"POST",body:new URLSearchParams(p(H)),credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}})}})});function y(C){var x=C.getBoundingClientRect().left,H=function(b){b.pageX>=x?(C.classList.add("right"),C.classList.remove("left")):(C.classList.add("left"),C.classList.remove("right")),x=b.pageX};document.addEventListener("mousemove",H),C._moveHandler=H}document.querySelectorAll(".portlet").forEach(function(C){C.classList.add("ui-widget","ui-widget-content","ui-helper-clearfix","ui-corner-all");var x=C.querySelector(".portlet-header");x&&(x.classList.add("ui-widget-header","ui-corner-all"),x.insertAdjacentHTML("afterbegin","<span class='ui-icon ui-icon-minusthick portlet-toggle'></span>"))}),document.querySelectorAll(".portlet-toggle").forEach(function(C){C.addEventListener("click",function(){this.classList.toggle("ui-icon-minusthick"),this.classList.toggle("ui-icon-plusthick");var x=this.closest(".portlet").querySelector(".portlet-content");x&&(x.style.display=x.style.display==="none"?"":"none")})})},k=function(_,L){L.classList.add("go"),L.classList.contains("isFavorite")?leantime.reactionsController.removeReaction("project",_,"favorite",function(){var y=L.querySelector("i");y&&(y.classList.remove("fa-solid"),y.classList.add("fa-regular")),L.classList.remove("isFavorite")}):leantime.reactionsController.addReactions("project",_,"favorite",function(){var y=L.querySelector("i");y&&(y.classList.remove("fa-regular"),y.classList.add("fa-solid")),L.classList.add("isFavorite")})};return{initDates:n,initProjectTabs:d,initProgressBar:e,initProjectTable:t,initDuplicateProjectModal:c,initTodoStatusSortable:f,initSelectFields:s,removeStatus:a,addToDoStatus:r,saveCroppie:g,clearCroppie:i,readURL:v,initGanttChart:o,setUpKanbanColumns:h,initProjectsKanban:E,favoriteProject:k}}();leantime.retrosCanvasController=leantime.canvasController.createController("retros",{nbRows:1});leantime.risksCanvasController=leantime.canvasController.createController("risks",{nbRows:2});leantime.sbCanvasController=leantime.canvasController.createController("sb",{rowSelectors:["stakeholderRow","financialsRow","culturechangeRow"]});leantime.smCanvasController=leantime.canvasController.createController("sm");leantime.sqCanvasController=leantime.canvasController.createController("sq");leantime.swotCanvasController=leantime.canvasController.createController("swot",{nbRows:2});leantime.kanbanController=function(){var l=function(i){var g=i.closest(".quickaddContainer"),o=g.querySelector("[data-quickadd-form]"),p=o.querySelector("[data-quickadd-input]"),h=g.querySelector(".quickAddLink"),E=o.classList.contains("active");E?(o.classList.remove("active"),o.style.display="none",o.dataset.submitting="false",h.style.display="",h.setAttribute("aria-expanded","false")):(o.classList.add("active"),o.style.display="block",o.dataset.submitting="false",h.style.display="none",h.setAttribute("aria-expanded","true"),p.focus())},n=function(){document.addEventListener("keydown",function(i){var g=i.target;if(g.matches("[data-quickadd-input]")){var o=g.closest("[data-quickadd-form]");if(o.dataset.submitting==="true"){i.preventDefault();return}var p=o.querySelector("[data-stay-open-input]");if(i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),o.dataset.submitting="true",p.value="0",o.submit()),i.key==="Enter"&&i.shiftKey&&(i.preventDefault(),o.dataset.submitting="true",p.value="1",o.submit()),i.key==="Escape"){i.preventDefault();var h=o.closest(".quickaddContainer"),E=h.querySelector(".quickAddLink");l(E),g.value=""}}})},d=function(){document.addEventListener("click",function(i){var g=document.querySelectorAll("[data-quickadd-form].active");g.forEach(function(o){var p=o.closest(".quickaddContainer"),h=p.querySelector(".quickAddLink"),E=o.querySelector("[data-quickadd-input]"),k=o.contains(i.target)||h.contains(i.target);if(o.dataset.submitting!=="true")if(!k&&E.value.trim()!==""){var _=o.querySelector("[data-stay-open-input]");_.value="0",o.dataset.submitting="true",o.submit()}else k||l(h)})})},c=function(i){var g=i.querySelectorAll(".column .contentInner");if(g.length!==0){g.forEach(function(p){p.style.minHeight="",p.style.height=""});var o=0;g.forEach(function(p){var h=p.offsetHeight;h>o&&(o=h)}),o>0&&g.forEach(function(p){p.style.minHeight=o+"px"})}},e=function(i){var g=i.querySelectorAll(".column .contentInner");g.forEach(function(o){o.style.minHeight="",o.style.height=""})},t=function(){requestAnimationFrame(function(){requestAnimationFrame(function(){var i=document.querySelectorAll(".kanban-swimlane-content:not(.collapsed)");i.forEach(function(g){c(g)})})})},f=function(i){var g=document.getElementById("swimlane-row-"+i),o=document.querySelector('.kanban-swimlane-sidebar[data-swimlane-id="'+i+'"]'),p=document.getElementById("swimlane-content-"+i);if(!g||!o||!p){console.error("Swimlane elements not found for ID:",i);return}var h=o.getAttribute("aria-expanded")==="true",E=!h;o.setAttribute("aria-expanded",E.toString());var k=o.querySelector(".kanban-lane-chevron i");k&&(k.className=E?"fa fa-chevron-down":"fa fa-chevron-right"),g.setAttribute("data-expanded",E.toString()),E?(p.classList.remove("collapsed"),c(p)):(p.classList.add("collapsed"),c(p)),fetch(leantime.appUrl+"/api/submenu",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({submenu:"swimlane_"+i,state:E?"open":"closed"})})},s=function(){document.addEventListener("keydown",function(i){var g=i.target.closest("[data-swimlane-id]");if(g){var o=g.getAttribute("data-swimlane-id");if((i.key==="Enter"||i.key===" ")&&(i.preventDefault(),f(o)),i.key==="ArrowDown"||i.key==="ArrowUp"){i.preventDefault();var p=Array.from(document.querySelectorAll("[data-swimlane-id]")),h=p.indexOf(g);i.key==="ArrowDown"&&h<p.length-1?p[h+1].focus():i.key==="ArrowUp"&&h>0&&p[h-1].focus()}}})},a=function(){if(!(typeof tippy>"u")){var i={allowHTML:!0,placement:"top",arrow:!0,theme:"light-border",trigger:"mouseenter focus",delay:[500,0]},g=[".status-segment[data-tippy-content]",".time-indicator[data-tippy-content]",".kanban-lane-count[data-tippy-content]",".tshirt-icon[data-tippy-content]",".thermometer-icon[data-tippy-content]",".user-avatar[data-tippy-content]",".type-icon[data-tippy-content]",".sprint-icon[data-tippy-content]",".milestone-icon[data-tippy-content]",".swimlane-header-label[data-tippy-content]"];g.forEach(function(o){var p=document.querySelectorAll(o);p.length>0&&tippy(p,i)})}},r=function(){"ontouchstart"in window&&document.querySelectorAll(".widgettitle").forEach(function(i){i.addEventListener("click",function(g){g.target.closest(".dropdown-toggle, .dropdown-menu")||this.classList.toggle("count-visible")})})},u=function(){var i=document.querySelectorAll(".kanban-swimlane-content.collapsed");i.forEach(function(g){c(g)})},v=function(){var i=document.querySelectorAll(".kanban-swimlane-row");if(i.length!==0&&!(window.innerWidth<=768)){var g=120,o=function(){i.forEach(function(p){var h=p.querySelector(".kanban-swimlane-sidebar"),E=p.querySelector(".kanban-swimlane-sidebar-inner"),k=p.querySelector(".kanban-swimlane-sentinel");if(!(!h||!E||!k)){var _=k.getBoundingClientRect(),L=h.getBoundingClientRect(),y=_.top<g&&L.bottom>g+100;if(y){var C=g-L.top,x=L.height-E.offsetHeight-12;C=Math.min(C,Math.max(0,x)),h.classList.add("is-sticky"),E.style.transform="translateY("+C+"px)"}else h.classList.remove("is-sticky"),E.style.transform=""}})};window.addEventListener("scroll",o,{passive:!0}),o()}};return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){n(),d(),s(),a(),v(),r(),u(),t()}):(n(),d(),s(),a(),v(),r(),u(),t()),{toggleQuickAdd:l,initQuickAddKeyboard:n,initClickOutsideSave:d,toggleSwimlane:f,initSwimlaneKeyboard:s,initProgressBarTooltips:a,equalizeColumnHeights:c,resetColumnHeights:e,initCollapsedColumnHeights:u,initExpandedColumnHeights:t,initStickySwimlaneSidebars:v,initMobileColumnCountToggle:r}}();leantime.timesheetsController=function(){var l=function(d){document.addEventListener("DOMContentLoaded",function(){var c=document.querySelector("#allTimesheetsTable");if(c){var e=jQuery("#allTimesheetsTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")},buttons:{colvis:leantime.i18n.__("datatables.buttons.colvis"),csv:leantime.i18n.__("datatables.buttons.download")}},dom:'<"top">rt<"bottom"ilp><"clear">',searching:!1,stateSave:!0,displayLength:100}),t=new jQuery.fn.dataTable.Buttons(e,{buttons:[{extend:"csvHtml5",title:leantime.i18n.__("label.filename_fileexport"),charset:"utf-8",bom:!0,exportOptions:{format:{body:function(s,a,r,u){return typeof u.dataset.order<"u"&&(s=u.dataset.order),s}}}},{extend:"colvis",columns:":not(.noVis)"}]}),f=document.querySelector("#tableButtons");f&&f.appendChild(t.container()[0]),jQuery("#allTimesheetsTable").on("column-visibility.dt",function(s,a,r,u){e.draw(!1)})}})},n=function(){var d={sizes:{minW:700,minH:1e3},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(c){c.style.display=""})},afterShowCont:function(){jQuery(".editTimeModal").nyroModal(d)},beforeClose:function(){location.reload()}},titleFromIframe:!0};jQuery(".editTimeModal").nyroModal(d)};return{initTimesheetsTable:l,initEditTimeModal:n}}();leantime.valueCanvasController=leantime.canvasController.createController("value",{nbRows:3});leantime.wikiController=function(){var l=function(n,d){jQuery(n).jstree({core:{expand_selected_onload:!0,themes:{dots:!1}},state:{key:"tree_state"},types:{default:{icon:"far fa-file-alt"}},plugins:["wholerow","types","state"]}),jQuery(n).on("ready.jstree",function(c,e){jQuery(this).jstree("deselect_all"),jQuery(this).jstree("select_node","treenode_"+d,!0),jQuery(this).jstree("save_state")}),jQuery(n).on("activate_node.jstree",function(c,e){jQuery(this).jstree("save_state"),!(e==null||e.node==null||e.node.id==null)&&(window.location.href=e.node.a_attr.href)})};return{initTree:l}}();(function(){var l={duration:3200,close:"",location:"default",style:"success",size:"medium"},n={success:{bg:"var(--green)",color:"#fff",border:"var(--green)"},error:{bg:"var(--red)",color:"#fff",border:"var(--red)"},warning:{bg:"var(--yellow)",color:"#333",border:"var(--yellow)"},notice:{bg:"var(--accent1)",color:"#fff",border:"var(--accent1)"},default:{bg:"var(--secondary-background)",color:"var(--primary-font-color)",border:"var(--main-border-color)"}},d=!1;function c(){if(!d){d=!0;var a=document.createElement("style");a.textContent="#growls-default {  position: fixed; top: 70px; right: 20px; z-index: 100060;  display: flex; flex-direction: column; gap: 8px;  pointer-events: none; max-width: 380px;}.lt-toast {  pointer-events: auto; padding: 12px 36px 12px 16px; border-radius: var(--box-radius, 8px);  box-shadow: var(--regular-shadow, 0 2px 8px rgba(0,0,0,.15)); font-size: var(--font-size-s, 13px);  line-height: 1.4; position: relative; overflow: hidden;  opacity: 0; transform: translateX(30px);  transition: opacity .25s ease, transform .25s ease;}.lt-toast.lt-toast-visible {  opacity: 1; transform: translateX(0);}.lt-toast.lt-toast-outgoing {  opacity: 0; transform: translateX(30px);}.lt-toast-close {  position: absolute; top: 8px; right: 10px; cursor: pointer;  font-size: 18px; line-height: 1; opacity: .7;}.lt-toast-close:hover { opacity: 1; }.lt-toast-title {  font-weight: 600; margin-bottom: 2px;}.lt-toast-message { word-break: break-word; }",document.head.appendChild(a)}}function e(a){var r="growls-"+a,u=document.getElementById(r);return u||(u=document.createElement("div"),u.id=r,document.body.appendChild(u)),u}function t(a){c(),a=a||{};var r={};for(var u in l)r[u]=l[u];for(var v in a)r[v]=a[v];var i=n[r.style]||n.default,g=e(r.location),o=document.createElement("div");o.className="lt-toast",o.style.background=i.bg,o.style.color=i.color,o.style.borderLeft="4px solid "+i.border,o.innerHTML='<div class="lt-toast-close">'+r.close+"</div>"+(r.title?'<div class="lt-toast-title">'+r.title+"</div>":"")+'<div class="lt-toast-message">'+(r.message||"")+"</div>",g.appendChild(o);var p=o.querySelector(".lt-toast-close");p.addEventListener("click",function(_){_.stopPropagation(),k(o)}),o.addEventListener("contextmenu",function(_){_.preventDefault(),k(o)});var h=null;o.addEventListener("mouseenter",function(){h&&(clearTimeout(h),h=null)}),o.addEventListener("mouseleave",function(){E()}),o.offsetHeight,o.classList.add("lt-toast-visible");function E(){h=setTimeout(function(){k(o)},r.duration)}function k(_){h&&(clearTimeout(h),h=null),_.classList.remove("lt-toast-visible"),_.classList.add("lt-toast-outgoing"),_.addEventListener("transitionend",function(){_.parentNode&&_.parentNode.removeChild(_)}),setTimeout(function(){_.parentNode&&_.parentNode.removeChild(_)},500)}E()}var f=window.leantime||(window.leantime={});f.toast={show:t};var s=function(a){return t(a)};s.error=function(a){return a=a||{},a.style="error",a.title=a.title||"Error!",t(a)},s.notice=function(a){return a=a||{},a.style="notice",a.title=a.title||"Notice!",t(a)},s.warning=function(a){return a=a||{},a.style="warning",a.title=a.title||"Warning!",t(a)},window._growlShim=s})();window.leantime=window.leantime||{};window.leantime.companyColor=(document.querySelector("meta[name=theme-color]")||{}).content||null;window.leantime.colorScheme=(document.querySelector("meta[name=color-scheme]")||{}).content||null;window.leantime.theme=(document.querySelector("meta[name=theme]")||{}).content||null;window.leantime.appUrl=(document.querySelector("meta[name=identifier-URL]")||{}).content||null;window.leantime.version=(document.querySelector("meta[name=leantime-version]")||{}).content||null;var $=window.leantime;$.replaceSVGColors=function(){$.companyColor!="#1b75bb"&&document.querySelectorAll("svg > *").forEach(function(l){l.getAttribute("fill")=="#1b75bb"&&l.setAttribute("fill",$.companyColor)})};$.handleAsyncResponse=function(l){l!==void 0&&l.result!==void 0&&l.result.html!==void 0&&document.body.insertAdjacentHTML("beforeend",l.result.html)};document.addEventListener("DOMContentLoaded",function(){$.replaceSVGColors(),document.querySelectorAll(".confetti").forEach(function(d){d.addEventListener("click",function(){confetti.start()})}),tippy("[data-tippy-content]");var l=document.querySelector(".login-alert .alert");if(l&&l.textContent!==""){var n=document.querySelector(".login-alert");n&&(n.style.display="")}document.addEventListener("scroll",function(){document.documentElement.dataset.scroll=window.scrollY})});htmx.onLoad(function(l){tippy("[data-tippy-content]"),$.replaceSVGColors()});window.addEventListener("HTMX.ShowNotification",function(l){fetch($.appUrl+"/notifications/getLatestGrowl",{credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(n){return n.text()}).then(function(n){var d=JSON.parse(n);d.notification&&d.notification!=="undefined"&&$.toast.show({message:d.notification,style:d.notificationType})})});document.addEventListener("click",function(l){var n=l.target.closest('[data-toggle="dropdown"]');if(document.querySelectorAll(".dropdown.open, .btn-group.open").forEach(function(c){(!n||!c.contains(n))&&c.classList.remove("open")}),n){l.preventDefault(),l.stopPropagation();var d=n.closest(".dropdown, .btn-group");d&&d.classList.toggle("open")}});document.addEventListener("keydown",function(l){l.key==="Escape"&&document.querySelectorAll(".dropdown.open, .btn-group.open").forEach(function(n){n.classList.remove("open")})});(function(){var l=document.createElement("style");l.textContent=".modal.in {  display: block !important; position: fixed; top: 0; left: 0; right: 0; bottom: 0;  z-index: 100050; overflow-x: hidden; overflow-y: auto;}.modal .modal-dialog {  position: relative; margin: 60px auto; max-width: 600px;}.modal .modal-dialog.modal-lg { max-width: 900px; }.modal .modal-content {  background: var(--secondary-background, #fff); border-radius: var(--box-radius, 8px);  box-shadow: var(--large-shadow, 0 4px 20px rgba(0,0,0,.2)); padding: 20px;}.modal .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }.modal .modal-header .close { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--primary-font-color); }.modal .modal-body { margin-bottom: 15px; }.modal .modal-footer { display: flex; justify-content: flex-end; gap: 8px; }",document.head.appendChild(l);var n=null;function d(e){e&&(e.style.display="block",e.offsetHeight,e.classList.add("in"),document.body.classList.add("modal-open"),n||(n=document.createElement("div"),n.className="modal-backdrop fade in",n.style.cssText="display:block;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:100049;",document.body.appendChild(n),n.addEventListener("click",function(){var t=document.querySelector(".modal.in");t&&c(t)})))}function c(e){e&&(e.classList.remove("in"),e.style.display="none",document.body.classList.remove("modal-open"),n&&n.parentNode&&(n.parentNode.removeChild(n),n=null))}document.addEventListener("click",function(e){var t=e.target.closest('[data-dismiss="modal"]');if(t){var f=t.closest(".modal");f&&c(f)}}),document.addEventListener("keydown",function(e){if(e.key==="Escape"){var t=document.querySelector(".modal.in");t&&c(t)}}),typeof jQuery<"u"&&(jQuery.fn.modal=function(e){return this.each(function(){e==="show"?d(this):e==="hide"?c(this):e==="toggle"&&(this.classList.contains("in")?c(this):d(this))}),this}),window.leantime=window.leantime||{},leantime.bootstrapModal={show:d,hide:c}})();(function(){function l(n,d){d=d||{};var c=n.querySelectorAll(":scope > ul > li > a"),e=[];if(c.forEach(function(f){var s=f.getAttribute("href");if(s&&s.charAt(0)==="#"){var a=n.querySelector(s);a&&e.push(a)}}),e.length!==0){var t=d.active||0;(typeof t!="number"||t<0||t>=e.length)&&(t=0),e.forEach(function(f,s){f.style.display=s===t?"":"none"}),c.forEach(function(f,s){s===t?f.parentElement.classList.add("ui-tabs-active","ui-state-active","active"):f.parentElement.classList.remove("ui-tabs-active","ui-state-active","active")}),c.forEach(function(f,s){f.addEventListener("click",function(a){a.preventDefault(),e.forEach(function(r){r.style.display="none"}),c.forEach(function(r){r.parentElement.classList.remove("ui-tabs-active","ui-state-active","active")}),e[s]&&(e[s].style.display=""),f.parentElement.classList.add("ui-tabs-active","ui-state-active","active")})}),d.create&&d.create.call(n,{},{tab:c[t],panel:e[t]})}}typeof jQuery<"u"&&(jQuery.fn.tabs=function(n){return this.each(function(){l(this,n)}),this})})();(function(){typeof jQuery>"u"||(jQuery.fn.chosen=function(l){return this.each(function(){var n=this;if(n.tagName==="SELECT"){if(n._slimSelect){try{n._slimSelect.destroy()}catch{}n._slimSelect=null}if(l!=="destroy"&&typeof SlimSelect<"u")try{n._slimSelect=new SlimSelect({select:n,showSearch:n.options&&n.options.length>8,allowDeselect:!n.hasAttribute("required")})}catch{}}}),this})})();leantime.snippets=function(){var l=function(a){var r=document.getElementById(a);r.select(),r.setSelectionRange(0,99999),navigator.clipboard.writeText(r.value),leantime.toast.show({message:leantime.i18n.__("short_notifications.url_copied"),style:"success"})},n=function(a){navigator.clipboard.writeText(a),leantime.toast.show({message:leantime.i18n.__("short_notifications.url_copied"),style:"success"})},d=function(){document.querySelectorAll(".confetti").forEach(function(a){a.addEventListener("click",function(){confetti.start()})})},c=function(a){var r=document.getElementById("accordion_toggle_"+a),u=r?r.querySelector("i.fa"):null,v="accordion_content-"+a,i="closed",g=document.getElementById("accordion_content-"+a);u&&u.classList.contains("fa-angle-right")?(u.classList.remove("fa-angle-right"),u.classList.add("fa-angle-down"),g&&(g.style.display=""),i="open"):u&&(u.classList.remove("fa-angle-down"),u.classList.add("fa-angle-right"),g&&(g.style.display="none"),i="closed");var o=new FormData;o.append("submenu",v),o.append("state",i),fetch(leantime.appUrl+"/api/submenu",{method:"PATCH",body:o,credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"}})},e=function(a){var r=document.getElementById("themeStyleSheet"),u=r.getAttribute("href");a=="light"?(u=u.replace("dark.css","light.css"),r.setAttribute("href",u)):a=="dark"&&(u=u.replace("light.css","dark.css"),r.setAttribute("href",u))},t=function(a){var r=document.getElementById("themeStyleSheet"),u=r.getAttribute("href");a=="minimal"?(u=u.replace("default","minimal"),r.setAttribute("href",u)):a=="default"&&(u=u.replace("minimal","default"),r.setAttribute("href",u))},f=function(a){document.getElementById("fontStyleSetter").innerHTML=":root { --primary-font-family: '"+a+"', 'Helvetica Neue', Helvetica, sans-serif; }"},s=function(a,r){document.getElementById("colorSchemeSetter").innerHTML=":root { --accent1: "+a+"; --accent2: "+r+"}"};return{copyUrl:l,copyToClipboard:n,initConfettiClick:d,accordionToggle:c,toggleTheme:e,toggleFont:f,toggleColors:s,toggleBg:t}}();leantime.modals=function(){var l=!1;function n(){return document.getElementById("global-modal")}function d(){return document.getElementById("global-modal-content")}function c(){return document.getElementById("global-modal-box")}function e(){var y=document.getElementById("modal-blur-overlay");return y||(y=document.createElement("div"),y.id="modal-blur-overlay",y.addEventListener("click",function(){leantime.modals.closeModal()}),document.body.appendChild(y)),y}function t(){e().classList.add("active");var y=document.querySelector(".mainwrapper");y&&y.setAttribute("inert","")}function f(){e().classList.remove("active");var y=document.querySelector(".mainwrapper");y&&y.removeAttribute("inert")}function s(y){return/showTicket|ideaDialog|articleDialog/.test(y)}function a(){var y=d();y&&(y.innerHTML='<div style="display:flex;justify-content:center;align-items:center;padding:60px 40px;"><span class="tw:loading tw:loading-spinner tw:loading-lg"></span></div>')}function r(y){for(var C=y.querySelectorAll("script"),x=0;x<C.length;x++){for(var H=C[x],b=document.createElement("script"),j=0;j<H.attributes.length;j++)b.setAttribute(H.attributes[j].name,H.attributes[j].value);b.textContent=H.textContent,H.parentNode.replaceChild(b,H)}}function u(y){if(/<html[\s>]/i.test(y)||/<!DOCTYPE/i.test(y)){var C=new DOMParser().parseFromString(y,"text/html"),x=C.querySelector(".primaryContent");return x?x.innerHTML:C.body?C.body.innerHTML:y}return y}function v(y){y.querySelectorAll(".showDialogOnLoad").forEach(function(C){C.style.display=""}),window.htmx&&window.htmx.process(y),window.tippy&&tippy(y.querySelectorAll("[data-tippy-content]"))}function i(y){var C=y.headers.get("HX-Trigger");if(C&&C.indexOf("HTMX.closemodal")!==-1)return C.indexOf("HTMX.ShowNotification")!==-1&&window.dispatchEvent(new CustomEvent("HTMX.ShowNotification")),h(),Promise.resolve(null);var x=y.headers.get("HX-Redirect");return x?(h(),window.location.href=x,Promise.resolve(null)):y.text()}function g(){var y=d();if(y&&window.leantime&&window.leantime.tiptapController&&window.leantime.tiptapController.registry)try{window.leantime.tiptapController.registry.destroyWithin(y)}catch{}}function o(y){if(y!==null){var C=d();C&&(g(),C.innerHTML=u(y),r(C),v(C))}}function p(y){var C=n(),x=c();if(C){s(y)?(x.style.maxWidth="1024px",x.style.width="95vw",x.style.minHeight="80vh"):(x.style.maxWidth="48rem",x.style.width="",x.style.minHeight=""),a(),C.open||(t(),C.show()),l=!0;var H=leantime.appUrl.replace(/\/$/,""),b=y.indexOf("http")===0?y:H+y;fetch(b,{credentials:"include",headers:{"is-modal":"true","X-Requested-With":"XMLHttpRequest"}}).then(i).then(o).catch(function(j){console.error("modalManager: load error",j);var R=d();R&&(R.innerHTML='<div style="padding:24px;text-align:center;"><p>Could not load content.</p></div>')})}}function h(){var y=n();if(y&&l){l=!1,g(),f();try{history.pushState("",document.title,window.location.pathname+window.location.search)}catch{}if(y.open&&y.close(),typeof window.globalModalCallback=="function"){var C=window.globalModalCallback;window.globalModalCallback=null,C()}else location.reload()}}var E=function(){var y=window.location.hash.substring(1);if(y){var C=y.split("/");C.length>2&&C[1]!=="tab"&&p(y)}},k=function(){h()},_=function(y){typeof y=="function"&&(window.globalModalCallback=y)},L=function(y){var C=leantime.appUrl.replace(/\/$/,""),x=y;y.indexOf(C)===0&&(x=y.substring(C.length)),p(x)};return{openModal:E,setCustomModalCallback:_,closeModal:k,openByUrl:L,renderContent:o}}();document.addEventListener("DOMContentLoaded",function(){leantime.modals.openModal(),document.addEventListener("click",function(n){var d=n.target.closest('a[href^="#/"], a.formModal, a.ticketModal');if(d){var c=d.getAttribute("href");if(c){if(c.indexOf("#/")===0){n.preventDefault(),n.stopPropagation(),window.globalModalCallback=function(){location.reload()};var e=c.substring(1);try{history.pushState("",document.title,window.location.pathname+window.location.search+c)}catch{}leantime.modals.openByUrl(e)}else if(d.classList.contains("formModal")||d.classList.contains("ticketModal")){if(c.indexOf("javascript:")===0)return;n.preventDefault(),n.stopPropagation(),window.globalModalCallback=function(){location.reload()},leantime.modals.openByUrl(c)}}}},!0);var l=document.getElementById("global-modal");l&&(l.addEventListener("keydown",function(n){n.key==="Escape"&&(n.preventDefault(),leantime.modals.closeModal())}),l.addEventListener("cancel",function(n){n.preventDefault(),leantime.modals.closeModal()}),l.addEventListener("close",function(){leantime.modals.closeModal()})),document.addEventListener("submit",function(n){var d=n.target;if(!(!d||!d.closest||!d.closest("#global-modal-content"))&&d.getAttribute("method")!=="dialog"&&!(d.hasAttribute("hx-post")||d.hasAttribute("hx-get")||d.hasAttribute("hx-put")||d.hasAttribute("hx-delete"))){n.preventDefault();var c=(d.getAttribute("method")||"GET").toUpperCase(),e=d.getAttribute("action")||window.location.href;document.getElementById("global-modal-content");var t={method:c,credentials:"include",headers:{"is-modal":"true","X-Requested-With":"XMLHttpRequest"}};if(c==="POST")t.body=new FormData(d);else{var f=new URLSearchParams(new FormData(d));e+=(e.indexOf("?")===-1?"?":"&")+f.toString()}fetch(e,t).then(function(s){var a=s.headers.get("HX-Trigger");if(a&&a.indexOf("HTMX.closemodal")!==-1)return a.indexOf("HTMX.ShowNotification")!==-1&&window.dispatchEvent(new CustomEvent("HTMX.ShowNotification")),leantime.modals.closeModal(),null;var r=s.headers.get("HX-Redirect");return r?(leantime.modals.closeModal(),window.location.href=r,null):s.text()}).then(function(s){leantime.modals.renderContent(s)}).catch(function(s){console.error("modalManager: form submit error",s)})}},!0)});window.addEventListener("hashchange",function(){leantime.modals.openModal()});window.addEventListener("closeModal",function(){leantime.modals.closeModal()});document.addEventListener("HTMX.closemodal",function(){leantime.modals.closeModal()});leantime.modals.nmManual=function(l,n){typeof n=="function"&&(n=n()),n&&n.callbacks&&typeof n.callbacks.beforeClose=="function"&&(window.globalModalCallback=n.callbacks.beforeClose),leantime.modals.openByUrl(l)};leantime.modals.nmTop=function(){return{close:function(){leantime.modals.closeModal()},elts:{cont:document.getElementById("global-modal-box"),bg:document.querySelector("#global-modal .tw\\:modal-backdrop"),load:document.querySelector("#global-modal .tw\\:loading"),all:document.getElementById("global-modal")}}};leantime.modals.initNyroModal=function(l,n){l instanceof HTMLElement&&(l=[l]),Array.prototype.forEach.call(l,function(d){if(!d.dataset.modalManagerInit){d.dataset.modalManagerInit="true",n&&n.callbacks&&(d._modalManagerOpts=n);var c=d.getAttribute("href");c&&d.addEventListener("click",function(e){if(e.preventDefault(),e.stopPropagation(),n&&n.callbacks&&typeof n.callbacks.beforeClose=="function"&&(window.globalModalCallback=n.callbacks.beforeClose),c.indexOf("#")===0){var t=c.substring(1);try{history.pushState("",document.title,window.location.pathname+window.location.search+c)}catch{}leantime.modals.openByUrl(t)}else leantime.modals.openByUrl(c)})}})};typeof jQuery<"u"&&(jQuery.nmManual=leantime.modals.nmManual,jQuery.nmTop=leantime.modals.nmTop,jQuery.fn.nyroModal=function(l){return leantime.modals.initNyroModal(this.toArray(),l),this});leantime.dateController=function(){function l(c){var e=leantime.i18n.__("language.dayNames").split(",");leantime.i18n.__("language.dayNamesShort").split(",");var t=leantime.i18n.__("language.dayNamesMin").split(","),f=leantime.i18n.__("language.monthNames").split(","),s=leantime.i18n.__("language.monthNamesShort").split(","),a=parseInt(leantime.i18n.__("language.firstDayOfWeek"),10)||0;return{dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","flatpickr"),locale:{firstDayOfWeek:a,weekdays:{shorthand:t,longhand:e},months:{shorthand:s,longhand:f}},allowInput:!0,onChange:c?function(r,u,v){c.call(v.input,u,v)}:void 0}}var n=function(c,e,t){var f=typeof c=="string"?document.querySelector(c):c,s=typeof e=="string"?document.querySelector(e):e;if(!(!f||!s)&&!(f.hasAttribute("readonly")||s.hasAttribute("readonly"))){var a=l();a.onChange=function(i){i.length>0&&(v.set("minDate",i[0]),s.value||v.setDate(i[0],!0))};var r=l();r.onChange=function(i){i.length>0&&u.set("maxDate",i[0])};var u=flatpickr(f,a),v=flatpickr(s,r)}},d=function(c,e){var t=typeof c=="string"?document.querySelectorAll(c):c?[c]:[];t.forEach(function(f){if(f&&!f.hasAttribute("readonly")){var s=(f.value||"").trim(),a=s&&!/\d/.test(s);a&&(f.setAttribute("placeholder",s),f.value=""),flatpickr(f,l(e))}})};return{initDateRangePicker:n,initDatePicker:d,getBaseDatePickerConfig:l}}();(function(){if(!(typeof jQuery>"u")){var l=new WeakMap;jQuery.datepicker=jQuery.datepicker||{},jQuery.datepicker.setDefaults=function(){},jQuery.datepicker.parseDate=function(n,d){if(!d)return null;var c=leantime.dateHelper.getFormatFromSettings("dateformat","flatpickr");return flatpickr.parseDate(d,c)},jQuery.datepicker.formatDate=function(n,d){if(!d)return"";var c=leantime.dateHelper.getFormatFromSettings("dateformat","flatpickr");return flatpickr.formatDate(d,c)},jQuery.fn.datepicker,jQuery.fn.datepicker=function(n,d){return this.each(function(){var c=this;if(typeof n=="string"){var e=l.get(c);if(!e)return;if(n==="option"||n==="setDate")if(d==="minDate"||n==="setDate"){var t=arguments.length>2?arguments[2]:d;n==="setDate"?e.setDate(t,!0):e.set("minDate",t)}else d==="maxDate"&&e.set("maxDate",arguments[2]);return}if(!c.hasAttribute("readonly")){var f=leantime.dateController.getBaseDatePickerConfig();n&&n.onSelect&&(f.onChange=function(a,r,u){n.onSelect.call(c,r,u)});var s=flatpickr(c,f);l.set(c,s)}})}}})();leantime.dateHelper=function(){var l={jquery:{},luxon:{},flatpickr:{}};l.jquery={d:"dd",D:"D",j:"d",l:"DD",N:"",S:"",w:"",z:"o",W:"",F:"MM",m:"mm",M:"M",n:"m",t:"",L:"",o:"yy",Y:"yy",y:"y",a:"",A:"",B:"",g:"",G:"",h:"",H:"",i:"",s:"",u:"",e:"",I:"",O:"",P:"",T:"",Z:"",c:"",r:"",U:"@"},l.flatpickr={d:"d",D:"D",j:"j",l:"l",N:"",S:"",w:"w",z:"",W:"W",F:"F",m:"m",M:"M",n:"n",t:"",L:"",o:"Y",Y:"Y",y:"y",a:"K",A:"K",B:"",g:"G",G:"H",h:"h",H:"H",i:"i",s:"S",u:"",e:"",I:"",O:"",P:"",T:"",Z:"Z",c:"",r:"",U:"U"},l.luxon={d:"dd",D:"ccc",j:"d",l:"cccc",N:"c",S:"",w:"c",z:"o",W:"WW",F:"MMMM",m:"LL",M:"LLL",n:"L",t:"",L:"",o:"kk",Y:"yyyy",y:"yy",a:"a",A:"a",B:"",g:"h",G:"H",h:"hh",H:"HH",i:"mm",s:"ss",u:"SSS",v:"SSS",e:"z",I:"",O:"ZZ",P:"ZZ",T:"ZZZ",Z:"",c:"",r:"",U:"X"};var n=function(c,e){let t=l[e],f="";return c.split("").forEach(function(s){t[s]!==void 0?f=f+""+t[s]:f=f+""+s}),f},d=function(c,e){let t=leantime.i18n.__("language."+c);return n(t,e)};return{mapFormat:n,getFormatFromSettings:d}}();leantime.authController=function(){var l=function(n){typeof n===void 0&&(n="body"),jQuery(n).find("input").not(".filterBar input").prop("readonly",!0),jQuery(n).find("input").not(".filterBar input").prop("disabled",!0),jQuery(n).find("select").not(".filterBar select, .mainSprintSelector").prop("readonly",!0),jQuery(n).find("select").not(".filterBar select, .mainSprintSelector").prop("disabled",!0),jQuery(n).find("textarea").not(".filterBar textarea").prop("disabled",!0),jQuery(n).find("a.delete").remove(),jQuery(n).find(".quickAddLink").hide(),jQuery(n).find(".tiptap-editor").length&&window.leantime&&window.leantime.tiptapController&&jQuery(n).find(".tiptap-editor").each(function(){var d=leantime.tiptapController.registry.get(this);d&&d.setEditable(!1)}),jQuery(n).find(".tiptap-toolbar").hide(),jQuery(n).find(".ticketDropdown a").removeAttr("data-toggle"),jQuery("#mainToggler").hide(),jQuery(".commentBox").hide(),jQuery(".deleteComment, .replyButton").hide(),jQuery(n).find(".dropdown i").removeClass("fa-caret-down")};return{makeInputReadonly:l}}();leantime.commentsController=function(){var l=function(){jQuery(".commentBox").show(),jQuery("#comments .replies .commentBox").hide(),jQuery(".deleteComment, .replyButton").show(),jQuery(".commentReply .tiptap-wrapper").each(function(){var d=jQuery(this).find(".tiptap-editor")[0];if(d&&window.leantime&&window.leantime.tiptapController){var c=leantime.tiptapController.registry.get(d);c&&c.setEditable(!0)}}),jQuery(".commentReply .tiptap-toolbar").show(),jQuery(".commenterFields input").prop("readonly",!1),jQuery(".commenterFields input").prop("disabled",!1),jQuery(".commenterFields textarea").prop("readonly",!1),jQuery(".commenterFields textarea").prop("disabled",!1)},n=function(d){d==0?jQuery("#mainToggler").hide():jQuery("#mainToggler").show(),window.leantime&&window.leantime.tiptapController&&window.leantime.tiptapController.registry&&jQuery(".commentBox .tiptap-editor").each(function(){leantime.tiptapController.registry.destroy(this)}),jQuery(".commentBox .tiptap-wrapper").remove(),jQuery(".commentBox textarea").remove(),jQuery(".commentBox").hide("fast",function(){}),jQuery("#comment"+d+" .commentReply").prepend('<textarea rows="5" cols="75" name="text" class="tiptapSimple"></textarea>'),window.leantime&&window.leantime.tiptapController&&leantime.tiptapController.initSimpleEditor(),jQuery("#comment"+d).show("fast"),jQuery("#father").val(d)};return{enableCommenterForms:l,toggleCommentBoxes:n}}();leantime.ticketsController=function(){function l(){let T=[];jQuery(".sortableTicketList").each(function(D){jQuery(this).find(".column").each(function(m){T[m]===void 0&&(T[m]=0);var w=jQuery(this).find(".moveable").length;T[m]+=w})}),jQuery(".widgettitle .count").each(function(D){jQuery(this).text(T[D])})}function n(){jQuery(".kanban-swimlane-row").each(function(){var T=jQuery(this),D=T.attr("id");if(D){D.replace("swimlane-row-","");var m=T.find(".kanban-swimlane-content"),w=m.find(".moveable").length,Q=T.find(".kanban-swimlane-sidebar");Q.find(".kanban-lane-count").text(w);var S=Q.attr("aria-label")||"",M=S.replace(/\d+ tasks/,w+" tasks");Q.attr("aria-label",M)}}),d()}function d(){jQuery(".kanban-swimlane-row").each(function(){var T=jQuery(this),D=T.find(".kanban-swimlane-content"),m=T.find(".micro-progress-bar .progress-segments");if(m.length){var w={},Q=0;D.find(".contentInner").each(function(){var M=jQuery(this),q=M.attr("class")||"",U=q.match(/status_(-?\d+)/);if(U){var B=U[1],F=M.find(".moveable").length;F>0&&(w[B]=F,Q+=F)}});var S=m.find(".status-segment");if(Q===0){S.css("flex","0 1 0%").find(".segment-count").text(""),S.attr("data-tippy-content","");return}S.each(function(){var M=jQuery(this),q=M.attr("class");if(q){var U=q.match(/status-(-?\d+)/);if(U){var B=U[1],F=w[B]||0,A=F/Q*100;M.css("flex",A+" 1 0%");var W=M.find(".segment-count");W.length&&W.text(F>0?F:"");var P=M.attr("data-tippy-content")||"",N=P.match(/^([^:]+):/),Y=N?N[1]:"Status "+B;M.attr("data-tippy-content",F>0?Y+": "+F:"")}}})}})}var c=function(T,D){var m=jQuery("#ticket_"+T);if(!m.length){console.warn("Card not found for ticket ID:",T);return}var w=m.closest(".contentInner"),Q=w.attr("class")||"",S=Q.match(/status_(\d+)/);if(!S){console.warn("Could not determine status for ticket:",T),location.reload();return}var M=S[1],q=jQuery("#kanboard-"+D+" .contentInner.status_"+M);if(!q.length){console.warn("Target swimlane not found:",D,M),location.reload();return}w[0]!==q[0]&&(m.addClass("card-moving-out"),setTimeout(function(){m.detach().appendTo(q),m.removeClass("card-moving-out").addClass("card-moving-in"),l(),n(),q.sortable&&q.sortable("refresh"),setTimeout(function(){m.removeClass("card-moving-in")},300)},200))},e=function(T,D){var m=jQuery(T).val();leantime.ticketsRepository.updateRemainingHours(D,m,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.remaining_hours_updated"),style:"success"})})},t=function(T,D){var m=jQuery(T).val();leantime.ticketsRepository.updatePlannedHours(D,m,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.planned_hours_updated"),style:"success"})})},f=function(){jQuery(".filterBar").toggle()},s=function(T,D,m){function w(Q){return String(Q).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}jQuery(document).ready(function(){if(m===!1)var Q=new Gantt("#gantt",T,{header_height:55,column_width:20,step:24,view_modes:["Day","Week","Month"],bar_height:40,static_progress_indicator:!0,bar_corner_radius:10,arrow_curve:10,padding:20,view_mode:"Month",date_format:leantime.i18n.__("language.momentJSDate"),language:leantime.i18n.__("language.code").slice(0,2),additional_rows:5,custom_popup_html:function(S){var M=S._end,q=jQuery.datepicker.formatDate(leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),new Date(M)),U='<div class="details-container" style="min-width:600px;"> ';return S.projectName!==void 0&&(U+="<h3><b>"+S.projectName+"</b></h3>"),U+="<small>"+S.type+" #"+S.id+" </small>",S.type==="milestone"?U+='<h4><a href="#/tickets/editMilestone/'+S.id+'" >'+w(S.name)+"</a></h4><br /> <p>"+leantime.i18n.__("text.expected_to_finish_by")+" <strong>"+q+"</strong><br /> "+Math.round(S.progress)+'%</p> <a href="#/tickets/editMilestone/'+S.id+'" ><span class="fa fa-map"></span> '+leantime.i18n.__("links.edit_milestone")+'</a> | <a href="'+leantime.appUrl+"/tickets/showKanban?milestone="+S.id+'"><span class="fa-pushpin"></span> '+leantime.i18n.__("links.view_todos")+"</a> ":U+='<h4><a href="#/tickets/showTicket/'+S.id+'">'+w(S.name)+'</a></h4><br /> <a href="#/tickets/showTicket/'+S.id+'"><span class="fa fa-thumb-tack"></span> '+leantime.i18n.__("links.edit_todo")+"</a> ",U+="</div>",U},on_click:function(S){},on_date_change:function(S,M,q){leantime.ticketsRepository.updateMilestoneDates(S.id,M,q,S._index+1)},on_sort_change:function(S){for(var M={action:"ganttSort",payload:{}},q=0;q<S.length;q++)M.payload[S[q].id]=S[q]._index+1;jQuery.ajax({type:"POST",url:leantime.appUrl+"/api/tickets",data:M})},on_progress_change:function(S,M){},on_view_change:function(S){leantime.usersRepository.updateUserViewSettings("roadmap",S)},on_popup_show:function(S){}});else var Q=new Gantt("#gantt",T,{readonlyGantt:!0,resizing:!1,progress:!1,is_draggable:!1,custom_popup_html:function(M){var q=M._end,U=jQuery.datepicker.formatDate(leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),new Date(q)),B='<div class="details-container" style="min-width:600px;"> ';return M.projectName!==void 0&&(B+="<h3><b>"+M.projectName+"</b></h3>"),B+="<small>"+M.type+" #"+M.id+" </small>",M.type==="milestone"?B+="<h4>"+w(M.name)+"</h4><br /> <p>"+leantime.i18n.__("text.expected_to_finish_by")+" <strong>"+U+"</strong><br /> "+Math.round(M.progress)+'%</p> <a href="'+leantime.appUrl+"/tickets/showKanban?milestone="+M.id+'"><span class="fa-pushpin"></span> '+leantime.i18n.__("links.view_todos")+"</a> ":B+='<h4><a href="#/tickets/showTicket/'+M.id+'">'+w(M.name)+'</a></h4><br /> <a href="#/tickets/showTicket/'+M.id+'"><span class="fa fa-thumb-tack"></span> '+leantime.i18n.__("links.edit_todo")+"</a> ",B+="</div>",B},on_click:function(M){},on_date_change:function(M,q,U){},on_progress_change:function(M,q){},on_view_change:function(M){leantime.usersRepository.updateUserViewSettings("roadmap",M)}});jQuery("#ganttTimeControl").on("click","a",function(){var S=jQuery(this),M=S.attr("data-value");Q.change_view_mode(M),S.parent().parent().find("a").removeClass("active"),S.addClass("active");var q=S.text();jQuery(".viewText").text(q)}),Q.change_view_mode(D)})},a=function(){Date.prototype.addDays=function(Q){return this.setDate(this.getDate()+Q),this},jQuery.datepicker.setDefaults({beforeShow:function(Q){if(jQuery(Q).attr("readonly"))return!1}});var T=leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),D=jQuery("#sprintStart").datepicker({numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){m.datepicker("option","minDate",w(this));var Q=w(this).addDays(13);m.datepicker("setDate",Q)}),m=jQuery("#sprintEnd").datepicker({defaultDate:"+1w",numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){D.datepicker("option","maxDate",w(this))});function w(Q){var S;try{S=jQuery.datepicker.parseDate(T,Q.value)}catch(M){S=null,console.log(M)}return S}},r=function(){var T=leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),D=jQuery("#milestoneEditFrom").datepicker({numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){m.datepicker("option","minDate",w(this))}),m=jQuery("#milestoneEditTo").datepicker({defaultDate:"+1w",numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){D.datepicker("option","maxDate",w(this))});function w(Q){var S;try{S=jQuery.datepicker.parseDate(T,Q.value)}catch(M){S=null,console.log(M)}return S}},u=function(){var T=leantime.dateHelper.getFormatFromSettings("dateformat","jquery");jQuery(".milestoneEditFromAsync").datepicker({numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){var m=jQuery(this).val(),w=jQuery(this).attr("data-id"),Q=jQuery(".toDateTicket-"+w);Q.datepicker("option","minDate",D(this)),jQuery(".toDateTicket-"+w).val(),leantime.ticketsRepository.updateEditFromDates(w,m,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.date_updated"),style:"success"})})}),jQuery(".milestoneEditToAsync").datepicker({defaultDate:"+1w",numberOfMonths:1,dateFormat:leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),dayNames:leantime.i18n.__("language.dayNames").split(","),dayNamesMin:leantime.i18n.__("language.dayNamesMin").split(","),dayNamesShort:leantime.i18n.__("language.dayNamesShort").split(","),monthNames:leantime.i18n.__("language.monthNames").split(","),currentText:leantime.i18n.__("language.currentText"),closeText:leantime.i18n.__("language.closeText"),buttonText:leantime.i18n.__("language.buttonText"),isRTL:leantime.i18n.__("language.isRTL")==="true"?1:0,nextText:leantime.i18n.__("language.nextText"),prevText:leantime.i18n.__("language.prevText"),weekHeader:leantime.i18n.__("language.weekHeader"),firstDay:leantime.i18n.__("language.firstDayOfWeek")}).on("change",function(){var m=jQuery(this).attr("data-id"),w=jQuery(".fromDateTicket-"+m);w.datepicker("option","maxDate",D(this));var Q=jQuery(this).val();jQuery(".fromDateTicket-"+m).val(),leantime.ticketsRepository.updateEditToDates(m,Q,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.date_updated"),style:"success"})})});function D(m){var w;try{w=jQuery.datepicker.parseDate(T,m.value)}catch(Q){w=null,console.log(Q)}return w}},v=function(){jQuery('[data-toggle="tooltip"]').tooltip()},i=function(){var T={"0.5":"< 2min",1:"XS",2:"S",3:"M",5:"L",8:"XL",13:"XXL"};jQuery(".effortDropdown .dropdown-menu a").unbind().on("click",function(){var D=jQuery(this).attr("data-value").split("_");if(D.length===2){var m=D[0],w=D[1];jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:m,storypoints:w}}).done(function(){jQuery("#effortDropdownMenuLink"+m+" span.text").text(T[w]),jQuery.growl({message:leantime.i18n.__("short_notifications.effort_updated"),style:"success"}),leantime.kanbanGroupBy==="storypoints"&&c(m,w)})}else console.log("Ticket Controller: Effort data value not set correctly")})},g=function(){var T={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Lowest"};jQuery(".priorityDropdown .dropdown-menu a").unbind().on("click",function(){var D=jQuery(this).attr("data-value").split("_");if(D.length===2){var m=D[0],w=D[1];jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:m,priority:w}}).done(function(){jQuery("#priorityDropdownMenuLink"+m+" span.text").text(T[w]),jQuery("#priorityDropdownMenuLink"+m).removeClass("priority-bg-1 priority-bg-2 priority-bg-3 priority-bg-4 priority-bg-5"),jQuery("#priorityDropdownMenuLink"+m).addClass("priority-bg-"+w),jQuery("#priorityDropdownMenuLink"+m).parents(".ticketBox").removeClass("priority-border-1 priority-border-2 priority-border-3 priority-border-4 priority-border-5"),jQuery("#priorityDropdownMenuLink"+m).parents(".ticketBox").addClass("priority-border-"+w),jQuery.growl({message:leantime.i18n.__("short_notifications.priority_updated"),style:"success"}),leantime.kanbanGroupBy==="priority"&&c(m,w)})}else console.log("Ticket Controller: Priority data value not set correctly")})},o=function(){jQuery(".milestoneDropdown .dropdown-menu a").unbind().on("click",function(){var T=jQuery(this).attr("data-value").split("_"),D=jQuery(this).attr("data-label");if(T.length===3){var m=T[0],w=T[1],Q=T[2];jQuery("#milestoneDropdownMenuLink"+m+" span.text").append(" ..."),jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:m,milestoneid:w}}).done(function(){jQuery("#milestoneDropdownMenuLink"+m+" span.text").text(D),jQuery("#milestoneDropdownMenuLink"+m).css("backgroundColor",Q),jQuery.growl({message:leantime.i18n.__("short_notifications.milestone_updated"),style:"success"}),leantime.kanbanGroupBy==="milestoneid"&&c(m,w)})}})},p=function(){jQuery(".statusDropdown .dropdown-menu a").unbind().on("click",function(){var T=jQuery(this).attr("data-value").split("_"),D=jQuery(this).attr("data-label");if(T.length==3){var m=T[0],w=T[1],Q=T[2];jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:m,status:w}}).done(function(S){jQuery("#statusDropdownMenuLink"+m+" span.text").text(D),jQuery("#statusDropdownMenuLink"+m).removeClass().addClass(Q+" dropdown-toggle f-left status "),jQuery.growl({message:leantime.i18n.__("short_notifications.status_updated"),style:"success"}),leantime.handleAsyncResponse(S)})}})},h=function(){jQuery(".userDropdown .dropdown-menu a").unbind().on("click",function(){var T=jQuery(this).attr("data-value").split("_"),D=jQuery(this).attr("data-label");if(T.length===3){var m=T[0],w=T[1];T[2],jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:m,editorId:w}}).done(function(){jQuery("#userDropdownMenuLink"+m+" span.text span#userImage"+m+" img").attr("src",leantime.appUrl+"/api/users?profileImage="+w),jQuery("#userDropdownMenuLink"+m+" span.text span#user"+m).text(D),jQuery.growl({message:leantime.i18n.__("short_notifications.user_updated"),style:"success"}),leantime.kanbanGroupBy==="editorId"&&c(m,w)})}})},E=function(){jQuery(".asyncInputUpdate").on("change",function(){var T=jQuery(this).attr("data-label").split("-");if(T.length==2){var D=T[0],m=T[1],w=jQuery(this).val();jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:m,[D]:w}}).done(function(){jQuery.growl({message:leantime.i18n.__("notifications.subtask_saved"),style:"success"})})}})},k=function(){jQuery(".sprintDropdown .dropdown-menu a").unbind().on("click",function(){var T=jQuery(this).attr("data-value").split("_"),D=jQuery(this).attr("data-label");if(T.length==2){var m=T[0],w=T[1];jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:{id:m,sprint:w}}).done(function(){jQuery("#sprintDropdownMenuLink"+m+" span.text").text(D),jQuery.growl({message:leantime.i18n.__("short_notifications.sprint_updated"),style:"success"}),leantime.kanbanGroupBy==="sprint"&&c(m,w)})}})},_=function(){var T=["#821219","#BB1B25","#75BB1B","#4B7811","#fdab3d","#1bbbb1","#006d9f","#124F7D","#082236","#5F0F40","#bb1b75","#F26CA7","#BB611B","#aaaaaa","#4c4c4c"];jQuery("input.simpleColorPicker").simpleColorPicker({colors:T,onChangeColor:function(m){jQuery(this).css("background",m),jQuery(this).css("color","#fff")}});var D=jQuery("input.simpleColorPicker").val();D!=""&&jQuery("input.simpleColorPicker").css("background",D)},L=function(){jQuery(".date-picker-form-control .reset-button").on("click",function(){const T=jQuery(this).attr("data-id");jQuery("#due-date-picker-"+T).val(leantime.i18n.__("text.anytime")),leantime.ticketsRepository.updateDueDates(T,null,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.duedate_updated"),style:"success"})})}),leantime.dateController.initDatePicker(".quickDueDates, .duedates",function(T,D){var m=D.currentDay,w=D.currentMonth,Q=D.currentYear,S=new Date(Q,w,m),M=jQuery.datepicker.formatDate(leantime.dateHelper.getFormatFromSettings("dateformat","jquery"),S),q=jQuery(this).attr("data-id");leantime.ticketsRepository.updateDueDates(q,M,function(){jQuery.growl({message:leantime.i18n.__("short_notifications.duedate_updated"),style:"success"})})})},y=function(T,D,m,w){var Q=document.getElementById(w).getContext("2d");new Chart(Q,{type:"line",data:{labels:T,datasets:[{label:leantime.i18n.__("label.booked_hours"),backgroundColor:"rgba(201,48,44, 0.5)",borderColor:"rgb(201,48,44)",data:D},{label:leantime.i18n.__("label.planned_hours"),backgroundColor:"rgba(54, 162, 235, 0.5)",borderColor:"rgb(54, 162, 235)",data:m}]},options:{scales:{x:{display:!0,title:{display:!0,text:leantime.i18n.__("label.booked_hours")},type:"time",time:{unit:"day"}},y:{display:!0,title:{display:!0,text:leantime.i18n.__("label.planned_hours")},ticks:{beginAtZero:!0}}}}})},C=function(){jQuery(document).ready(function(){let T=new URL(window.location.href),D=T.searchParams.get("tab"),m=0;D&&(m=jQuery(".ticketTabs").find('a[href="#'+D+'"]').parent().index()),jQuery(".ticketTabs").tabs({create:function(w,Q){jQuery(".ticketTabs").css("visibility","visible")},activate:function(w,Q){T=new URL(window.location.href),T.searchParams.set("tab",Q.newPanel[0].id),window.history.replaceState(null,null,T)},load:function(){},enable:function(){},active:m})})},x=function(T){jQuery("#ticketSearch").on("submit",function(D){D.preventDefault();var m=jQuery("#projectIdInput").val(),w=jQuery("#userSelect").val(),Q=jQuery("#milestoneSelect").val(),S=jQuery("#termInput").val(),M=jQuery("#sprintSelect").val(),q=jQuery("#typeSelect").val(),U=jQuery("#prioritySelect").val(),B=jQuery("#statusSelect").val(),F=jQuery("#sortBySelect").val(),A=jQuery("input[name='groupBy']:checked").val(),W=jQuery("input[name='showTasks']:checked").val(),P="?search=true";m!=""&&m!=null&&(P=P+"&projectId="+m),w!=""&&w!=null&&(P=P+"&users="+w),Q!=""&&Q!=null&&(P=P+"&milestone="+Q),S!=""&&S!=null&&(P=P+"&term="+S),M!=""&&M!=null&&(P=P+"&sprint="+M),q!=""&&q!=null&&(P=P+"&type="+q),U!=""&&U!=null&&(P=P+"&priority="+U),B!=""&&B!=null&&(P=P+"&status="+B),F!=""&&F!=null&&(P=P+"&sort="+F),A!=""&&A!=null&&(P=P+"&groupBy="+A),W!=""&&W!=null&&(P=P+"&showTasks="+W);var N=T+P;window.location.href=N})},H=function(T){var D=jQuery("#projectIdInput").val(),m=jQuery("#userSelect").val(),w=jQuery("#milestoneSelect").val(),Q=jQuery("#termInput").val(),S=jQuery("#sprintSelect").val(),M=jQuery("#typeSelect").val(),q=jQuery("#prioritySelect").val(),U=jQuery("#statusSelect").val(),B=jQuery("#sortBySelect").val(),F=jQuery("input[name='groupBy']:checked").val(),A="?search=true";D!=""&&D!=null&&(A=A+"&projectId="+D),m!=""&&m!=null&&(A=A+"&users="+m),w!=""&&w!=null&&(A=A+"&milestone="+w),Q!=""&&Q!=null&&(A=A+"&term="+Q),S!=""&&S!=null&&(A=A+"&sprint="+S),M!=""&&M!=null&&(A=A+"&type="+M),q!=""&&q!=null&&(A=A+"&priority="+q),U!=""&&U!=null&&(A=A+"&status="+U),B!=""&&B!=null&&(A=A+"&sort="+B),F!=""&&F!=null&&(A=A+"&groupBy="+F);var W=T+A;window.location.href=W},b=function(){jQuery(document).ready(function(){l(),n(),jQuery(".filterBar .row-fluid").css("opacity","1"),jQuery(".sortableTicketList").each(function(){let T=jQuery(this).attr("id");var D=jQuery(this).closest(".kanban-swimlane-row");if(D.length&&D.attr("data-expanded")==="false")return;let m=250;jQuery(this).find(".column .contentInner").each(function(){jQuery(this).height()>m&&(m=jQuery(this).height())}),jQuery("#"+T+" .column .contentInner").css("height",m)})})},j=function(T){var D=T;jQuery(".sortableTicketList.kanbanBoard .ticketBox").hover(function(){jQuery(this).css("background","var(--kanban-card-hover)")},function(){jQuery(this).css("background","var(--kanban-card-bg)")}),jQuery(".sortableTicketList").each(function(){var w=this;jQuery(w).find(".contentInner").sortable({connectWith:".contentInner",items:"> .moveable",tolerance:"intersect",placeholder:"ui-state-highlight",forcePlaceholderSize:!0,cancel:".portlet-toggle,:input,a,input",distance:10,start:function(Q,S){S.item.addClass("tilt"),m(S.item);var M=S.item.closest(".sortableTicketList.kanbanBoard");S.item.data("originalSwimlaneId",M.attr("id"))},stop:function(Q,S){S.item.removeClass("tilt"),jQuery("html").unbind("mousemove",S.item.data("move_handler")),S.item.removeData("move_handler"),l(),n(),jQuery(".sortableTicketList").find(".contentInner").each(function(){var Z=jQuery(this),fe=Z.find(".moveable").length>0;if(fe){Z.removeClass("empty-column"),Z.attr("data-empty-text","");var He=Z.attr("aria-label")||"";Z.attr("aria-label",He.replace("Empty column","")+" column items")}else Z.addClass("empty-column"),Z.attr("data-empty-text","Empty"),Z.attr("aria-label","Empty column")});var M=S.item.closest(".sortableTicketList.kanbanBoard"),q=M.attr("id"),U=S.item.data("originalSwimlaneId");if(U&&q&&U!==q){var B=S.item[0].id.replace("ticket_",""),F=q.replace("kanboard-",""),A={milestoneid:"milestoneid",editorId:"editorId",priority:"priority",storypoints:"storypoints",sprint:"sprint",dueDate:"dateToFinish"},W=leantime.kanbanGroupBy,P=A[W];if(W==="dueDate"){var N=new Date;switch(N.setHours(12,0,0,0),F){case"0":var Y=new Date(N);Y.setDate(Y.getDate()-1),F=Y.toISOString().split("T")[0];break;case"1":var ie=new Date(N),z=6-ie.getDay();z<0&&(z=0),ie.setDate(ie.getDate()+z),F=ie.toISOString().split("T")[0];break;case"2":var G=new Date(N),xe=6-G.getDay()+7;G.setDate(G.getDate()+xe),F=G.toISOString().split("T")[0];break;case"3":var K=new Date(N);K.setDate(K.getDate()+21),F=K.toISOString().split("T")[0];break;case"4":F="";break}}if(P&&B){var V=jQuery("#ticket_"+B);if(W==="milestoneid"){var te=jQuery("#swimlane-row-"+F+" .swimlane-header-label"),Te=te.text()||leantime.i18n.__("label.no_milestone"),pe=V.find(".milestoneDropdown .dropdown-toggle .text");pe.length&&pe.text(Te);var ce=V.find('.milestoneDropdown .dropdown-menu a[data-value^="'+B+"_"+F+'_"]'),ae="#b0b0b0";if(ce.length&&F!=="0"&&F!==""){var ge=ce.attr("data-value");if(ge){var he=ge.split("_");he.length>=3&&(ae=he.slice(2).join("_"))}if(!ae||ae==="#b0b0b0"){var ye=ce.attr("style");if(ye){var ve=ye.match(/background-color:\s*([^;]+)/i);ve&&(ae=ve[1].trim())}}}V.find(".milestoneDropdown .dropdown-toggle").css("background-color",ae)}else if(W==="priority"){V.removeClass(function(Z,fe){return(fe.match(/(^|\s)priority-border-\S+/g)||[]).join(" ")}).addClass("priority-border-"+F);var Le={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Lowest"},re=jQuery("#priorityDropdownMenuLink"+B);re.length&&(re.find("span.text").text(Le[F]||F),re.removeClass("priority-bg-1 priority-bg-2 priority-bg-3 priority-bg-4 priority-bg-5"),re.addClass("priority-bg-"+F))}else if(W==="editorId"){var ue=jQuery("#userDropdownMenuLink"+B);if(ue.length){ue.find("span.text span img").attr("src",leantime.appUrl+"/api/users?profileImage="+F);var te=jQuery("#swimlane-row-"+F+" .swimlane-header-label"),je=te.text()||leantime.i18n.__("label.not_assigned");ue.find("span.text span#user"+B).text(je)}}else if(W==="storypoints"){var De={"0.5":"< 2min",1:"XS",2:"S",3:"M",5:"L",8:"XL",13:"XXL"},be=jQuery("#effortDropdownMenuLink"+B);be.length&&be.find("span.text").text(De[F]||F)}else if(W==="sprint"){var we=jQuery("#sprintDropdownMenuLink"+B);if(we.length){var te=jQuery("#swimlane-row-"+F+" .swimlane-header-label"),Me=te.text()||leantime.i18n.__("label.backlog");we.find("span.text").text(Me)}}else if(W==="dueDate"){var le=V.find(".dues .fa-calendar").parent();if(le.length&&F){var me=F.split("-"),Ee=me[1]+"/"+me[2]+"/"+me[0];le.contents().filter(function(){return this.nodeType===3}).first().replaceWith(" "+Ee)}else le.length&&!F&&le.contents().filter(function(){return this.nodeType===3}).first().replaceWith(" No due date")}jQuery.growl({message:"To-Do Updated",style:"success"});var _e={id:B};_e[P]=F,jQuery.ajax({type:"PATCH",url:leantime.appUrl+"/api/tickets",data:_e}).fail(function(){jQuery.growl({message:leantime.i18n.__("short_notifications.not_saved")||"Error updating ticket",style:"error"}),location.reload()})}}S.item.removeData("originalSwimlaneId");for(var ke=S.item.closest(".sortableTicketList"),Se={action:"kanbanSort",payload:{},handler:S.item[0].id},ne=0;ne<D.length;ne++)ke.find(".contentInner.status_"+D[ne]).length&&(Se.payload[D[ne]]=ke.find(".contentInner.status_"+D[ne]).sortable("serialize"));jQuery.ajax({type:"POST",url:leantime.appUrl+"/api/tickets",data:Se}).done(function(Z){leantime.handleAsyncResponse(Z)})}})});function m(w){var Q=w.position().left,S=function(M){M.pageX+5>Q?(w.addClass("right"),w.removeClass("left")):M.pageX<Q+5?(w.addClass("left"),w.removeClass("right")):(w.removeClass("left"),w.removeClass("right")),Q=M.pageX};jQuery("html").bind("mousemove",S),w.data("move_handler",S)}jQuery(".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all").find(".portlet-header").addClass("ui-widget-header ui-corner-all").prepend("<span class='ui-icon ui-icon-minusthick portlet-toggle'></span>"),jQuery(".portlet-toggle").click(function(){var w=jQuery(this);w.toggleClass("ui-icon-minusthick ui-icon-plusthick"),w.closest(".portlet").find(".portlet-content").toggle()})},R=function(T){function D(m){return!isNaN(parseFloat(m))&&isFinite(m)}jQuery(document).ready(function(){var m=[],w=jQuery(".ticketTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")},buttons:{colvis:leantime.i18n.__("datatables.buttons.colvis"),csv:leantime.i18n.__("datatables.buttons.download")}},dom:'<"top">rt<"bottom">p<"clear">',searching:!1,stateSave:!0,displayLength:100,order:m,columnDefs:[{visible:!1,targets:10},{visible:!1,targets:11},{target:"no-sort",orderable:!1}],footerCallback:function(Q,S,M,q,U){var B=this.api(),F=B.column(10).data().reduce(function(P,N){return D(P)===!1&&(P=jQuery(P).val()),D(N)===!1&&(N=jQuery(N).val()),isNaN(P)&&(P=0),isNaN(N)&&(N=0),parseFloat(P)+parseFloat(N)},0),A=B.column(11).data().reduce(function(P,N){return D(P)===!1&&(P=jQuery(P).val()),D(N)===!1&&(N=jQuery(N).val()),isNaN(P)&&(P=0),isNaN(N)&&(N=0),parseFloat(P)+parseFloat(N)},0),W=B.column(12).data().reduce(function(P,N){return parseFloat(P)+parseFloat(N)},0);jQuery(B.column(9).footer()).html("Total"),jQuery(B.column(10).footer()).html(F),jQuery(B.column(11).footer()).html(A),jQuery(B.column(12).footer()).html(W)}});new jQuery.fn.dataTable.Buttons(w.table(0),{buttons:[{extend:"csvHtml5",title:leantime.i18n.__("label.filename_fileexport"),charset:"utf-8",bom:!0,exportOptions:{format:{body:function(Q,S,M,q){return typeof jQuery(q).data("order")<"u"&&(Q=jQuery(q).data("order")),Q}}}},{extend:"colvis",columns:":not(.noVis)"}]}).container().appendTo(jQuery("#tableButtons")),w.table(0).on("column-visibility",function(Q,S,M,q){for(var U=1;U<w.tables().context.length;U++)w.tables(U).column(M).visible(q);w.draw()}),jQuery(".ticketTable input").on("change",function(Q,S,M,q){jQuery(this).parent().attr("data-order",jQuery(this).val()),w.draw()})})},I=function(T){jQuery(document).ready(function(){var D=[];jQuery(".listStyleTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")},buttons:{colvis:leantime.i18n.__("datatables.buttons.colvis"),csv:leantime.i18n.__("datatables.buttons.download")}},dom:'<"top">rt<"bottom"<"center"p>><"clear">',searching:!1,stateSave:!0,displayLength:25,order:D,fnDrawCallback:function(m){m._iDisplayLength>m.fnRecordsDisplay()?jQuery(m.nTableWrapper).find(".dataTables_paginate").hide():jQuery(m.nTableWrapper).find(".dataTables_paginate").show()}})})},X=function(T){jQuery(document).ready(function(){var D=[],m=jQuery(".ticketTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")},buttons:{colvis:leantime.i18n.__("datatables.buttons.colvis"),csv:leantime.i18n.__("datatables.buttons.download")}},dom:'<"top">rt<"bottom"><"clear">',searching:!1,stateSave:!0,displayLength:100,order:D,columnDefs:[{visible:!1,targets:7},{visible:!1,targets:8},{target:"no-sort",orderable:!1}]});new jQuery.fn.dataTable.Buttons(m.table(0),{buttons:[{extend:"csvHtml5",title:leantime.i18n.__("label.filename_fileexport"),charset:"utf-8",bom:!0,exportOptions:{format:{body:function(w,Q,S,M){return typeof jQuery(M).data("order")<"u"&&(w=jQuery(M).data("order")),w}}}},{extend:"colvis",columns:":not(.noVis)"}]}).container().appendTo(jQuery("#tableButtons")),m.table(0).on("column-visibility",function(w,Q,S,M){for(var q=1;q<m.tables().context.length;q++)m.tables(q).column(S).visible(M);m.draw()}),jQuery(".ticketTable input").on("change",function(w,Q,S,M){jQuery(this).parent().attr("data-order",jQuery(this).val()),m.draw()})})},ee=function(T,D){window.leantime&&window.leantime.tiptapController&&window.leantime.tiptapController.registry&&leantime.tiptapController.registry.destroyAll(),jQuery(".ticketRows").removeClass("active"),jQuery("#row-"+T).addClass("active"),jQuery(D).html("<div class='center'><img src='"+leantime.appUrl+"/dist/images/svg/loading-animation.svg' width='100px' /></div>");function m(w){jQuery(w).find("form").each(function(){jQuery(this).on("submit",function(Q){Q.preventDefault(),window.leantime&&window.leantime.tiptapController&&window.leantime.tiptapController.registry&&leantime.tiptapController.registry.destroyAll(),jQuery(w).html("<div class='center'><img src='"+leantime.appUrl+"/dist/images/svg/loading-animation.svg' width='100px'/></div>");var S=jQuery(this).serialize();jQuery.ajax({url:jQuery(this).attr("action"),data:S,type:"post",success:function(M){jQuery(w).html(M),m(w)},error:function(){}})})})}jQuery.get(leantime.appUrl+"/tickets/showTicket/"+T,function(w){jQuery(D).html(w),m(D)})},oe=function(){jQuery("#tags").tagsInput({autocomplete_url:leantime.appUrl+"/api/tags"}),jQuery("#tags_tag").on("focusout",function(){let T=jQuery(this).val();T!=""&&jQuery("#tags").addTag(T)})},de=function(T,D){var m="Discussion on To-Do #"+D+`:
\r`+jQuery("#commentText-"+T).text();jQuery('li a[href*="timesheet"]').click(),jQuery("#timesheet #description").val(m)};return{toggleFilterBar:f,initGanttChart:s,updateRemainingHours:e,updatePlannedHours:t,initTimeSheetChart:y,initTicketTabs:C,initTicketSearchSubmit:x,initTicketKanban:j,initTicketsTable:R,initEffortDropdown:i,initPriorityDropdown:g,initMilestoneDropdown:o,initStatusDropdown:p,initUserDropdown:h,initSprintDropdown:k,initToolTips:v,initTagsInput:oe,initMilestoneDatesAsyncUpdate:u,initAsyncInputChange:E,initDueDateTimePickers:L,setUpKanbanColumns:b,addCommentTimesheetContent:de,initMilestoneTable:X,initMilestoneDates:r,initTicketsList:I,loadTicketToContainer:ee,initTicketSearchUrlBuilder:H,initSprintDates:a,initSimpleColorPicker:_}}();var J=window.leantime||(window.leantime={});J.ticketsRepository=function(){var l=function(f,s,a,r){let u=J.dateHelper.getFormatFromSettings("dateformat","luxon"),v=J.dateHelper.getFormatFromSettings("timeformat","luxon"),i=luxon.DateTime.fromSQL(s).toFormat(u),g=luxon.DateTime.fromSQL(s).toFormat(v),o=luxon.DateTime.fromSQL(a).toFormat(u),p=luxon.DateTime.fromSQL(a).toFormat(v);fetch(J.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:f,editFrom:i,editTo:o,timeFrom:g,timeTo:p,sortIndex:r})})},n=function(f,s,a){fetch(J.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:f,hourRemaining:s})}).then(function(){a()})},d=function(f,s,a){fetch(J.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:f,planHours:s})}).then(function(){a()})},c=function(f,s,a){fetch(J.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:f,dateToFinish:s})}).then(function(){a()})},e=function(f,s,a){fetch(J.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:f,editFrom:s})}).then(function(){a()})},t=function(f,s,a){fetch(J.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id:f,editTo:s})}).then(function(){a()})};return{updateMilestoneDates:l,updateRemainingHours:n,updatePlannedHours:d,updateDueDates:c,updateEditFromDates:e,updateEditToDates:t}}();leantime.dashboardController=function(){var l={};leantime.theme=="dark"?l={red:"rgb(201,48,44)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(90,182,90)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(56, 56, 56)"}:l={red:"rgb(201,48,44)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(90,182,90)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"};var n="",d=function(){var r=moment().startOf("week").add(5,"days"),u=document.querySelector("#dateToFinish");u&&(u.value=r.format("YYYY-MM-DD"))},c=function(r,u,v){var i={type:"doughnut",data:{datasets:[{data:[u,v],backgroundColor:[leantime.dashboardController.chartColors.green,leantime.dashboardController.chartColors.grey],label:leantime.i18n.__("label.project_done")}],labels:[u+"% Done",v+"% Open"]},options:{maintainAspectRatio:!1,responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!1,text:""}},animation:{animateScale:!0,animateRotate:!0}}},g=document.getElementById(r).getContext("2d");new Chart(g,i)},e=function(r,u,v){moment.locale(leantime.i18n.__("language.code"));var i={type:"line",data:{labels:r,datasets:[{label:leantime.i18n.__("label.ideal"),backgroundColor:leantime.dashboardController.chartColors.blue,borderColor:leantime.dashboardController.chartColors.blue,data:u,fill:!1,lineTension:0},{label:"Actual",backgroundColor:leantime.dashboardController.chartColors.red,borderColor:leantime.dashboardController.chartColors.red,data:v,fill:!1,lineTension:0}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!0},plugins:{legend:{position:"bottom"},title:{display:!1,text:"Line Chart"},tooltips:{mode:"index",intersect:!1}},scales:{x:{display:!0,title:{display:!0,text:leantime.i18n.__("label.date")},type:"time",time:{unit:"day"}},y:{display:!0,title:{display:!0,text:leantime.i18n.__("label.num_tickets")},ticks:{beginAtZero:!0}}}}},g=document.getElementById("sprintBurndown").getContext("2d");return n=new Chart(g,i),n},t=function(r,u,v,i,g){var o=document.getElementById(r);o&&o.addEventListener("click",function(p){g.data.datasets[0].data=v,g.data.datasets[1].data=i,g.options.scales.y.title.text=u,document.querySelectorAll(".chartButtons").forEach(function(h){h.classList.remove("active")}),o.classList.add("active"),g.update()})},f=function(r,u){moment.locale(leantime.i18n.__("language.code"));var v={type:"line",data:{labels:r,datasets:[{label:leantime.i18n.__("label.done_todos"),backgroundColor:leantime.dashboardController.chartColors.green,borderColor:leantime.dashboardController.chartColors.green,data:u.done.data,fill:!0,lineTension:0,pointRadius:0},{label:leantime.i18n.__("label.progress_todos"),backgroundColor:leantime.dashboardController.chartColors.yellow,borderColor:leantime.dashboardController.chartColors.yellow,data:u.progress.data,fill:!0,lineTension:0,pointRadius:0},{label:leantime.i18n.__("label.new_todos"),backgroundColor:leantime.dashboardController.chartColors.red,borderColor:leantime.dashboardController.chartColors.red,data:u.open.data,fill:!0,lineTension:0,pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!0},elements:{point:{pointStyle:"line",radius:"0"}},plugins:{tooltips:{mode:"index",intersect:!1},legend:{position:"bottom"},title:{display:!1,text:"Line Chart"}},scales:{x:{display:!0,title:{display:!0,text:leantime.i18n.__("label.date")},type:"time",time:{unit:"day"}},y:{display:!0,title:{display:!0,text:leantime.i18n.__("label.num_tickets")},ticks:{beginAtZero:!0},stacked:!0}}}},i=document.getElementById("backlogBurndown").getContext("2d");return n=new Chart(i,v),n},s=function(r,u,v,i){var g=document.getElementById(r);g&&g.addEventListener("click",function(o){i.data.datasets[0].data=u.done.data,i.data.datasets[1].data=u.progress.data,i.data.datasets[2].data=u.open.data,i.options.scales.y.title.text=v,document.querySelectorAll(".backlogChartButtons").forEach(function(p){p.classList.remove("active")}),g.classList.add("active"),i.update()})},a=function(){document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".duedates").forEach(function(r){leantime.dateController.initDatePicker(r,function(u){var v=u;v==""&&(this.value=leantime.i18n.__("text.anytime"));var i=moment(v,leantime.i18n.__("language.momentJSDate")).format("YYYY-MM-DD HH:mm:ss"),g=this.getAttribute("data-id"),o=i;leantime.ticketsRepository.updateDueDates(g,o,function(){leantime.toast.show({message:leantime.i18n.__("short_notifications.duedate_updated")})})})})})};return{chartColors:l,initBurndown:e,initChartButtonClick:t,initBacklogBurndown:f,initBacklogChartButtonClick:s,initProgressChart:c,prepareHiddenDueDate:d,initDueDateTimePickers:a}}();leantime.usersController=function(){var l=null,n=function(a){if(d(),a.files&&a.files[0]){var r=new FileReader,u=document.querySelector("#profileImg");r.onload=function(v){l=new Croppie(u,{enableExif:!0,viewport:{width:175,height:175,type:"circle"},boundary:{width:200,height:200}}),l.bind({url:v.currentTarget.result});var i=document.querySelector("#previousImage");i&&(i.style.display="none")},r.readAsDataURL(a.files[0])}},d=function(){l&&(l.destroy(),l=null);var a=document.querySelector("#previousImage");a&&(a.style.display="")},c=function(){var a=document.querySelector("#save-picture");a&&a.classList.add("running");var r=document.querySelector("#profileImg");r&&r.setAttribute("src",leantime.appUrl+"/images/loaders/loader28.gif"),l&&l.result({type:"blob",circle:!0}).then(function(u){leantime.usersService.saveUserPhoto(u)})},e=function(){document.addEventListener("DOMContentLoaded",function(){jQuery("#allUsersTable").DataTable({language:{decimal:leantime.i18n.__("datatables.decimal"),emptyTable:leantime.i18n.__("datatables.emptyTable"),info:leantime.i18n.__("datatables.info"),infoEmpty:leantime.i18n.__("datatables.infoEmpty"),infoFiltered:leantime.i18n.__("datatables.infoFiltered"),infoPostFix:leantime.i18n.__("datatables.infoPostFix"),thousands:leantime.i18n.__("datatables.thousands"),lengthMenu:leantime.i18n.__("datatables.lengthMenu"),loadingRecords:leantime.i18n.__("datatables.loadingRecords"),processing:leantime.i18n.__("datatables.processing"),search:leantime.i18n.__("datatables.search"),zeroRecords:leantime.i18n.__("datatables.zeroRecords"),paginate:{first:leantime.i18n.__("datatables.first"),last:leantime.i18n.__("datatables.last"),next:leantime.i18n.__("datatables.next"),previous:leantime.i18n.__("datatables.previous")},aria:{sortAscending:leantime.i18n.__("datatables.sortAscending"),sortDescending:leantime.i18n.__("datatables.sortDescending")}},dom:'<"top">rt<"bottom"ilp><"clear">',searching:!1,displayLength:100})})},t=function(){var a={sizes:{minW:400,minH:350},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(r){r.style.display=""}),jQuery(".userImportModal").nyroModal(a)}}};jQuery(".userImportModal").nyroModal(a)},f=function(){var a={sizes:{minW:900,minH:250},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(r){r.style.display=""}),jQuery(".userEditModal").nyroModal(a)},beforeClose:function(){location.reload()}}};jQuery(".userEditModal").nyroModal(a)},s=function(a){let r,u=document.getElementById(a),v=document.getElementById("pwStrength"),i=new RegExp("(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,})"),g=new RegExp("((?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{6,}))|((?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9])(?=.{8,}))");function o(p){i.test(p)?(v.style.backgroundColor="#107530",v.textContent=leantime.i18n.__("label.strong")):g.test(p)?(v.style.backgroundColor="#C5850D",v.textContent=leantime.i18n.__("label.medium")):(v.style.backgroundColor="#CC6B6B",v.textContent=leantime.i18n.__("label.weak"))}u.addEventListener("input",()=>{v.style.display="block",clearTimeout(r),r=setTimeout(()=>o(u.value),500),u.value.length!==0?v.style.display!="block":v.style.display="none"})};return{readURL:n,clearCroppie:d,saveCroppie:c,initUserTable:e,_initModals:t,checkPWStrength:s,initUserEditModal:f}}();leantime.usersRepository=function(){var l=function(d){var c=new FormData;c.append("file",d),fetch(leantime.appUrl+"/api/users",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"},body:c}).then(function(e){var t=document.querySelector("#save-picture");t&&t.classList.remove("running"),location.reload()}).catch(function(e){console.log(e)})},n=function(d,c){fetch(leantime.appUrl+"/api/users",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({patchViewSettings:d,value:c})})};return{saveUserPhoto:l,updateUserViewSettings:n}}();leantime.usersService=function(){var l=function(n){leantime.usersRepository.saveUserPhoto(n)};return{saveUserPhoto:l}}();leantime.reactionsController=function(){return{addReactions:function(d,c,e,t){fetch(leantime.appUrl+"/api/reactions",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"add",module:d,moduleId:c,reaction:e})}).then(function(){t()})},removeReaction:function(d,c,e,t){fetch(leantime.appUrl+"/api/reactions",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"remove",module:d,moduleId:c,reaction:e})}).then(function(){t()})}}}();leantime.helperController=function(){var l=function(u,v){v?leantime.helperRepository.updateUserModalSettings(u,!0):leantime.helperRepository.updateUserModalSettings(u,!1)},n=function(){return leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal(),leantime.tourFactory.startTour("myWorkDashboard")},d=function(){leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal()},c=function(){return leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal(),leantime.helperRepository.updateUserModalSettings("projectDashboard"),leantime.tourFactory.startTour("projectDashboard")},e=function(){return jQuery.nmTop()&&jQuery.nmTop().close(),leantime.helperRepository.updateUserModalSettings("kanbanBoard"),leantime.tourFactory.startTour("kanbanBoard")},t=function(){return jQuery.nmTop()&&jQuery.nmTop().close(),leantime.helperRepository.updateUserModalSettings("milestoneView"),leantime.tourFactory.startTour("milestoneView")},f=function(){return leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal(),leantime.helperRepository.updateUserModalSettings("goals"),leantime.tourFactory.startTour("goalsView")},s=function(){document.addEventListener("DOMContentLoaded",function(){var u={sizes:{minW:700,minH:250},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){document.querySelectorAll(".showDialogOnLoad").forEach(function(v){v.style.display=""}),jQuery(".onboardingModal").nyroModal(u)},beforeClose:function(){location.reload()}}};jQuery(".onboardingModal").nyroModal(u),jQuery.nmManual(leantime.appUrl+"/help/firstLogin",u)})},a=function(u,v,i){document.addEventListener("DOMContentLoaded",function(){jQuery.nmManual(leantime.appUrl+"/help/showOnboardingDialog?module="+u,{sizes:{minW:v||200,minH:i||500},resizable:!0,autoSizable:!0,callbacks:{beforeShowCont:function(){leantime.replaceSVGColors()},afterShowCont:function(){htmx.process("#global-modal-content")}}})})},r=function(u){leantime.helperRepository.updateUserModalSettings(u),leantime.modals.setCustomModalCallback(function(){}),leantime.modals.closeModal()};return{showHelperModal:a,hideAndKeepHidden:r,setDontShowAgain:l,closeModal:d,startMyWorkDashboardTour:n,startProjectDashboardTour:c,startKanbanTour:e,startMilestoneTour:t,startGoalTour:f,firstLoginModal:s}}();var se=window.leantime||(window.leantime={});se.helperRepository=function(){var l=function(c,e=!1){fetch(se.appUrl+"/api/users",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({settings:c,permanent:e?1:0,patchModalSettings:1})})},n=function(){fetch(se.appUrl+"/api/sessions",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({tourActive:1})})},d=function(){fetch(se.appUrl+"/api/sessions",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({tourActive:0})})};return{updateUserModalSettings:l,startingTour:n,stopTour:d}}();leantime.tourFactory=function(){var l=function(t){return new Shepherd.Tour({useModalOverlay:!0,defaultStepOptions:{classes:"shepherd-theme-arrows",scrollTo:!1,cancelIcon:{enabled:!0}},tourName:t})},n=function(t){leantime.helperRepository.updateUserModalSettings(t),typeof _paq<"u"&&_paq.push(["trackEvent","Tour","Completed",t])},d=function(t){return{myWorkDashboard:[{id:"welcome-step",title:" Welcome to the Dashboard Tour",text:"Let's start with a few basics to get you up to speed on the navigation and different elements inside Leantime."},{id:"top-nav-step",title:"Work Modes",text:"The top navigation shows you the current 'work mode' you're in. You can be inside a project, your personal work area, or in the company mode.",attachTo:{element:".work-modes",on:"bottom"}},{id:"menu-step",title:"Left Navigation",text:"The left navigation breaks down the current work mode and gives you access to different areas. Everything presented here is part of the currently selected work mode above.",attachTo:{element:".leftpanel",on:"right"}},{id:"my-menu",title:"My Profile Bar",text:"Here you'll find links to your account as well as notifications and latest news about Leantime.",attachTo:{element:".headmenu.pull-right",on:"bottom"}},{id:"dashboard-widgets",title:"Your Dashboard Widgets",text:"Your dashboard is broken up into various widgets showing you focused information about your work.",attachTo:{element:".primaryContent",on:"top"}},{id:"dashboard-widgets-dandd",title:"Customize Your Dashboard",text:"Widgets can be resized and moved around using the drag and drop functionality.",attachTo:{element:"#widget_wrapper_todos .grid-handler-top",on:"bottom"}},{id:"my-todo-widget",title:"My To-Dos",text:"The My To-Do widget shows you all the tasks that are currently assigned to you.",attachTo:{element:"#widget_wrapper_todos",on:"top"}},{id:"my-todo-widget2",title:"Group To-Dos",text:"You can use the dropdowns here to filter your tasks by project or group them by priority, status, project, or dates.",attachTo:{element:"#yourToDoContainer > .clear",on:"bottom"}},{id:"my-todo-widget4",title:"Sort To-Dos",text:"Each To-Do can be dragged and dropped to change its order. You can also drag and drop a task to the calendar to schedule it.",attachTo:{element:"#yourToDoContainer .sortable-item:first-child",on:"bottom"}},{id:"my-todo-widget-timer",title:"Start the Timer",text:"When you're ready to start working on a task, just click the start timer button.",attachTo:{element:"#yourToDoContainer .sortable-item:first-child .timerContainer",on:"bottom"}},{id:"my-todo-widget-complete",title:"Complete a Task",text:"Once a task is complete, you can mark it as done by clicking the status dropdown.",attachTo:{element:"#yourToDoContainer .sortable-item:first-child .statusDropdown",on:"bottom"}},{id:"my-todo-widget-add",title:"Add More Tasks",text:"You can add more tasks by clicking the plus button in each section, or by using the 3-dot menu next to each task.",attachTo:{element:"#yourToDoContainer .fa-circle-plus",on:"bottom"}},{id:"finish",title:"Congratulations!",text:"You've completed the My Work dashboard tour. Head to <a href='"+leantime.appUrl+"/dashboard/show'>your project</a> to learn more about project management in Leantime."}],projectDashboard:[{id:"left-nav",title:"Project Menu",text:"The project menu organizes your project into different sections: <strong>Data Room</strong> - to host all your files and information, <strong>Think</strong> - to strategize, ideate and define, <strong>Make</strong> - to manage goals, milestones and tasks.",attachTo:{element:".leftmenu ul",on:"left"}},{id:"project-selector",title:"Project Selector",text:"Use the project selector to jump between projects. The left menu shows everything related to your current project.",attachTo:{element:".bigProjectSelector",on:"bottom"}},{id:"project-checklist",title:"Checklist",text:"The project checklist is a quick reference to see if your project contains all the necessary information for successful execution.",attachTo:{element:"#progressForm",on:"bottom"}},{id:"project-status",title:"Quick Status Updates",text:"You can use status updates to quickly share the progress of your project with your team using red, yellow and green colors. The status will be visible across the application.",attachTo:{element:".project-updates",on:"left"}},{id:"project-progress",title:"Progress",text:"The project progress indicator shows you how much work you have completed. It accounts for various task sizes, team velocity, and project milestones.",attachTo:{element:".project-progress",on:"left"}},{id:"latest-tasks",title:"Latest Tasks",text:"The list of latest tasks shows you the most recent tasks added to your project and can be used as a project inbox.",attachTo:{element:".latest-todos",on:"left"}},{id:"teams",title:"Team",text:"The team box shows you the members of this project.",attachTo:{element:".team-container",on:"top"}},{id:"finished",title:"Congratulations!",text:"You've completed the project dashboard tour. Head to the <a href='"+leantime.appUrl+"/tickets/showKanban'>To-Dos</a> to learn more about the various ways to manage your tasks in Leantime."}],kanbanBoard:[{id:"kanban-overview",title:"Your Kanban Board",text:"This is your Kanban board. It helps you visualize your work and limit work-in-progress.",attachTo:{element:".kanban-board-wrapper",on:"top"}},{id:"kanban-columns",title:"Work Flow",text:"Tasks move from left to right as they progress. Drag and drop cards to update their status.",attachTo:{element:".column",on:"right"}},{id:"kanban-columns2",title:"Flexible Columns",text:"Using the 3-dot menu, you can add or remove columns and rename them.",attachTo:{element:".column .widgettitle .inlineDropDownContainer",on:"right"}},{id:"kanban-filter",title:"Filter Tasks",text:"You can filter your tasks by various fields like priority, status, project, or dates.",attachTo:{element:".filterWrapper > .btn",on:"bottom"}},{id:"kanban-group",title:"Swimlanes",text:"Additionally, you can group your tasks to create Kanban swimlanes. This helps you visualize your work by team members, priority, or milestones.",attachTo:{element:".filterWrapper > .btn-group",on:"bottom"}},{id:"kanban-sprints",title:"Sprints",text:"If you manage your work in sprints, you can use the dropdown here to select, create, and update sprints.",attachTo:{element:".pageheader .dropdown",on:"bottom"}},{id:"kanban-congrats",title:"Congratulations!",text:"This concludes the Kanban tour. Head to the <a href='"+leantime.appUrl+"/tickets/showKanban'>Milestones</a> to learn how to create and manage milestones in Leantime."}],milestoneView:[{id:"milestone-overview",title:"Milestones",text:"Milestones help you track major outcomes and project phases.",attachTo:{element:".gantt-wrapper",on:"top"}},{id:"milestone-drag",title:"Drag & Sort",text:"Each bar represents one milestone. You can drag them along the timeline, reorder, and resize them. Everything you do on this screen updates the timing of your milestones.",attachTo:{element:".gantt-wrapper",on:"top"}},{id:"milestone-filter",title:"Filter",text:"You can filter your milestones and also view tasks that are part of them.",attachTo:{element:".filterWrapper > .btn",on:"bottom"}},{id:"milestone-timeframes",title:"Timeframes",text:"You can change the timeframe of the timeline view to see more of the year or dive deep into a daily breakdown.",attachTo:{element:".col-md-4 .pull-right",on:"bottom"}},{id:"milestone-congrats",title:"Congratulations!",text:"This concludes the milestone tour. Head to the <a href='"+leantime.appUrl+"/goalcanvas/dashboard'>Goals</a> to learn how to create and manage goals in Leantime."}],goalsView:[{id:"goals-overview",title:"Goals",text:"Goals help you track measurable impact on your projects."},{id:"goal-parts",title:"Objectives & Metrics",text:"Each goal is made up of an Objective (what you're trying to accomplish) and a Metric (how you'll measure it).",attachTo:{element:".ticketBox",on:"top"}},{id:"goal-progress",title:"Goal Progress",text:"As you update your goal metrics, the progress bar will show you how far along you are.",attachTo:{element:".ticketBox > .row > .col-md-12 .progress",on:"bottom"}},{id:"milestone-connection",title:"Milestones & Goals",text:"You can connect goals to milestones to track the task-level progress of your goals. This helps identify gaps in your project plan.",attachTo:{element:".ticketBox.fixed",on:"bottom"}},{id:"milestone-congrats",title:"Congratulations!",text:"This concludes the goals tour. Milestones, Goals, and To-Dos are the basic building blocks in Leantime. Use them to break down your work into manageable chunks. Head to the <a href='"+leantime.appUrl+"/tickets/showKanban'>Kanban Board</a> to review your tasks."}]}[t]||[]},c=function(t){const f=l(t),s=d(t);return s.forEach((a,r)=>{const u=r===0,v=r===s.length-1,i=[];u||i.push({text:leantime.i18n.__("tour.back"),classes:"shepherd-button-secondary",action:f.back}),v?i.push({text:leantime.i18n.__("tour.finish"),action:function(){n(t),confetti(),f.complete()}}):i.push({text:leantime.i18n.__("tour.next"),action:f.next}),v||i.unshift({text:leantime.i18n.__("tour.cancel"),classes:"shepherd-button-secondary",action:f.cancel}),f.addStep({...a,buttons:i})}),f.on("complete",function(){n(t)}),f},e=function(t){const f=c(t);return f.start(),f};return{createTour:l,buildTour:c,startTour:e,getTourDefinition:d}}();leantime.confettiHelper=function(){var l=function(d){const e={...{particleCount:100,spread:70,origin:{y:.6},disableForReducedMotion:!0},...d};typeof confetti=="function"?confetti(e):console.error("Confetti library not loaded")},n=function(){l({particleCount:150,spread:90,origin:{y:.8},colors:["#26a69a","#00bcd4","#4caf50","#8bc34a","#cddc39"]}),setTimeout(function(){l({particleCount:80,spread:120,origin:{y:.7},colors:["#ff9800","#ff5722","#f44336","#e91e63","#9c27b0"]})},500)};return{triggerConfetti:l,celebrateSuccess:n}}();leantime.firstTaskController=function(){var l=function(){var n=document.querySelector("#firstTaskOnboarding");if(n){n.addEventListener("submit",function(c){c.preventDefault();var e=document.querySelector("#firstTask"),t=e.value.trim();if(t==="")return e.classList.add("error"),!1;e.classList.remove("error"),leantime.confettiHelper.celebrateSuccess(),setTimeout(function(){n.submit()},1500)});var d=document.querySelector("#firstTask");d&&d.addEventListener("input",function(){this.classList.remove("error")})}};return{initFirstTaskForm:l}}();document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){leantime.firstTaskController.initFirstTaskForm()}):leantime.firstTaskController.initFirstTaskForm();leantime.menuController=function(){var l=function(t){if(t!==""){var f=document.querySelector("#submenu-"+t),s=document.querySelector("#submenu-icon-"+t),a="";f&&(f.style.display==="none"||getComputedStyle(f).display==="none"?(f.style.display="block",s&&(s.classList.remove("fa-angle-right"),s.classList.add("fa-angle-down")),a="open"):(f.style.display="none",s&&(s.classList.remove("fa-angle-down"),s.classList.add("fa-angle-right")),a="closed"),fetch(leantime.appUrl+"/api/submenu",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({submenu:t,state:a})}))}},n=function(){document.querySelectorAll(".project-select").forEach(function(r){new SlimSelect({select:r})}),document.addEventListener("click",function(r){r.target.closest(".projectselector.dropdown-menu")&&r.stopPropagation()});var t=document.querySelector(".projectSelectorTabs");if(t){var f=t.querySelectorAll("ul > li > a"),s=localStorage.getItem("currentMenuTab"),a=0;s&&f.forEach(function(r,u){r.getAttribute("href")==="#"+s&&(a=u)}),f.forEach(function(r,u){var v=r.getAttribute("href");if(!(!v||v.charAt(0)!=="#")){var i=document.querySelector(v);i&&(u===a?(i.style.display="",r.parentElement.classList.add("ui-tabs-active")):(i.style.display="none",r.parentElement.classList.remove("ui-tabs-active")),r.addEventListener("click",function(g){g.preventDefault(),f.forEach(function(p){var h=p.getAttribute("href");if(h&&h.charAt(0)==="#"){var E=document.querySelector(h);E&&(E.style.display="none")}p.parentElement.classList.remove("ui-tabs-active")}),i&&(i.style.display=""),r.parentElement.classList.add("ui-tabs-active");var o=v.replace("#","");localStorage.setItem("currentMenuTab",o)}))}})}},d=function(){if(window.innerWidth<576){var t=document.querySelector(".mainwrapper");t&&(t.classList.remove("menuopen"),t.classList.add("menuclosed"))}var f=document.querySelector(".barmenu");f&&f.addEventListener("click",function(){var s=document.querySelector(".mainwrapper");s&&(s.classList.contains("menuopen")?(s.classList.remove("menuopen"),s.classList.add("menuclosed"),leantime.menuRepository.updateUserMenuSettings("closed")):(s.classList.remove("menuclosed"),s.classList.add("menuopen"),leantime.menuRepository.updateUserMenuSettings("open")))})},c=function(t,f="",s){var a=document.querySelector("#"+s+"-toggler-"+t),r=document.querySelector("#"+s+"-projectSelectorlist-group-"+t);if(a)if(f==="closed"?(a.classList.remove("closed","open"),a.classList.add("open")):f==="open"&&(a.classList.remove("open","closed"),a.classList.add("closed")),a.classList.contains("open")){a.classList.remove("open"),a.classList.add("closed");var u=a.querySelector("i");u&&(u.classList.remove("fa-angle-down"),u.classList.add("fa-angle-right")),r&&(r.classList.add("closed"),r.classList.remove("open")),e(t,"closed",s)}else{a.classList.remove("closed"),a.classList.add("open");var u=a.querySelector("i");u&&(u.classList.remove("fa-angle-right"),u.classList.add("fa-angle-down")),r&&(r.classList.add("open"),r.classList.remove("closed")),e(t,"open",s)}};let e=function(t,f,s){fetch(leantime.appUrl+"/api/submenu",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({submenu:s+"-projectSelectorlist-group-"+t,state:f})})};return{toggleSubmenu:l,initProjectSelector:n,initLeftMenuHamburgerButton:d,updateGroupDropdownSetting:e,toggleProjectDropDownList:c}}();var Ce=window.leantime||(window.leantime={});Ce.menuRepository=function(){var l=function(n){fetch(Ce.appUrl+"/api/sessions",{method:"PATCH",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({menuState:n})})};return{updateUserMenuSettings:l}}();leantime.settingController=function(){var l,n=function(e){if(d(),e.files&&e.files[0]){var t=new FileReader,f=jQuery("#logoImg");t.onload=function(s){l=f.croppie({enableExif:!0,enforceBoundary:!1,viewport:{width:220,height:40,type:"square"},boundary:{width:400,height:200}}),l.croppie("bind",{url:s.currentTarget.result});var a=document.querySelector("#previousImage");a&&(a.style.display="none")},t.readAsDataURL(e.files[0])}},d=function(){jQuery("#logoImg").croppie("destroy");var e=document.querySelector("#previousImage");e&&(e.style.display="")},c=function(){var e=document.querySelector("#save-logo");e&&e.classList.add("running");var t=document.querySelector("#logoImg");t&&t.setAttribute("src",leantime.appUrl+"/images/loaders/loader28.gif"),l.croppie("result",{type:"blob",circle:!1,size:"original",quality:1}).then(function(f){leantime.settingService.saveLogo(f)})};return{readURL:n,clearCroppie:d,saveCroppie:c}}();leantime.settingRepository=function(){var l=function(n){var d=new FormData;d.append("file",n),fetch(leantime.appUrl+"/api/setting",{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"},body:d}).then(function(c){var e=document.querySelector("#save-logo");e&&e.classList.remove("running"),location.reload()}).catch(function(c){console.log(c)})};return{saveLogo:l}}();leantime.settingService=function(){var l=function(n){leantime.settingRepository.saveLogo(n)};return{saveLogo:l}}();leantime.widgetController=function(){var l=[],n=function(a,r){let u=a.gridX||0,v=a.gridY||0,i=a.gridWidth||2,g=a.gridHeight||2;if(r.willItFit({x:u,y:v,width:i,height:g}))return{x:u,y:v};let o=Math.max(...r.engine.nodes.map(p=>p.y+p.h),0);for(let p=0;p<=o+1;p++)for(let h=0;h<=12-i;h++)if(r.willItFit({newX:h,newY:p,width:i,height:g}))return{x:h,y:p};return{x:0,y:o+1}};GridStack.renderCB=function(a,r){r.content&&typeof DOMPurify<"u"&&(a.innerHTML=DOMPurify.sanitize(r.content))};var d=function(){l=GridStack.init({margin:"0px 15px 15px 0px",handle:".grid-handler-top",minRow:2,cellHeight:"30px",float:!0,draggable:{handle:".grid-handler-top",appendTo:"body"},lazyLoad:!1,columnOpts:{breakpointForWindow:!0,breakpoints:[{w:700,c:1},{w:950,c:6}]}}),l.on("dragstop",function(r,u){c()}),l.on("resizestop",function(r,u){c()}),document.querySelectorAll(".grid-stack-item").forEach(function(r){var u=r.querySelector(".removeWidget");u&&u.addEventListener("click",function(){e(this.closest(".grid-stack-item"))});var v=r.querySelector(".fitContent");v&&v.addEventListener("click",function(){t(this.closest(".grid-stack-item"))})});var a=document.querySelector("#gridBoard");a&&(a.style.opacity="1")},c=function(){let a=l.save();a.sort((v,i)=>v.y===i.y?v.x-i.x:v.y-i.y);let r=null;arguments.length>0&&arguments[0].action==="toggleWidget"&&(r={widgetId:arguments[0].widgetId,visible:arguments[0].visible}),a.forEach(function(v){var i=document.createElement("div");i.innerHTML=v.content;var g=i.querySelector("[hx-get]");v.id=g?g.getAttribute("id"):null,v.widgetUrl=g?g.getAttribute("hx-get"):null,v.widgetTrigger=g?g.getAttribute("hx-trigger"):null,v.x==null&&(v.x=0),v.gridX=v.x,v.y==null&&(v.y=0),v.gridY=v.y,v.w==null&&(v.w=1),v.gridWidth=v.w,v.h==null&&(v.h=1),v.gridHeight=v.h,v.content=""});var u=new URLSearchParams;u.append("action","saveGrid"),a.forEach(function(v,i){Object.keys(v).forEach(function(g){var o=v[g];o!=null&&u.append("data["+i+"]["+g+"]",o)})}),r&&Object.keys(r).forEach(function(v){u.append("visibilityData["+v+"]",r[v])}),fetch(leantime.appUrl+"/widgets/widgetManager",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:u})},e=function(a){a.remove(),l.removeWidget(a,!0),c()},t=function(a){document.querySelector(".grid-stack").gridstack.resizeToContent(a,!1),c()},f=function(a,r,u){let v=document.querySelector(".grid-stack").gridstack,i=r.checked;if(n(u,v),i){const o=document.createElement("div");o.className="grid-stack-item";const p=document.createElement("div");p.className=`grid-stack-item-content tw:p-none ${u.widgetBackground=="default"?"maincontentinner":u.background}`,p.innerHTML=s(u),o.appendChild(p),v.el.appendChild(o),v.makeWidget(o,{x:u.gridX||0,y:u.gridY||50,w:u.gridWidth||2,h:u.gridHeight||2}),htmx.process(o),c({action:"toggleWidget",widgetId:a,visible:i})}else{var g=document.getElementById(a);g&&e(g.closest(".grid-stack-item"))}},s=function(a){return'<div class="widgetInner">        <div class="'+(a.widgetBackground=="default"?"tw:pb-l":"")+`">
            <div class="stickyHeader" style="padding:15px; height:50px;  width:100%;">
               <div class="grid-handler-top tw:h-[40px] tw:cursor-grab tw:float-left tw:mr-sm">
                    <i class="fa-solid fa-grip-vertical"></i>
                </div>
           `+(a.name!=""?'<h5 class="subtitle tw:pb-m tw:float-left tw:mr-sm">'+a.name+"</h5>":"")+`
            <div class="inlineDropDownContainer tw:float-right">
                <a href="javascript:void(0);" class="dropdown-toggle ticketDropDown editHeadline" data-toggle="dropdown">
                    <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="javascript:void(0)" class="fitContent"><i class="fa-solid fa-up-right-and-down-left-from-center"></i> Resize to fit content</a></li>
                        <li><a href="javascript:void(0)" class="removeWidget"><i class="fa fa-eye-slash"></i> Hide</a></li>
                </ul>
            </div>

        </div>
 <div class="widgetContent tw:px-l">
             <div hx-get="`+a.widgetUrl+'" hx-trigger="'+a.widgetTrigger+'" hx-target="this" hx-swap="innerHTML" id="'+a.id+`"></div>
        </div>
       </div>
        <div class="clear"></div>
    </div>
`};return{resizeWidget:t,removeWidget:e,saveGrid:c,initGrid:d,toggleWidgetVisibility:f}}();leantime.calendarController=function(){var l=function(e){var t=new Date;t.getDate(),t.getMonth(),t.getFullYear();var f=document.body.offsetHeight-260,s=document.querySelector("#calendar"),a=new FullCalendar.Calendar(s,{timeZone:leantime.i18n.__("usersettings.timezone"),height:f,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listDay"},titleFormat:{year:"numeric",month:"long"},dayHeaderFormat:{weekday:"short"},eventTimeFormat:leantime.dateHelper.getFormatFromSettings("timeformat","luxon"),direction:leantime.i18n.__("language.isRTL")=="false"?"ltr":"rtl",firstDay:parseInt(leantime.i18n.__("language.firstDayOfWeek"),10),locale:leantime.i18n.__("language.code"),buttonText:{today:leantime.i18n.__("buttons.today"),month:leantime.i18n.__("buttons.month"),week:leantime.i18n.__("buttons.week"),day:leantime.i18n.__("buttons.day")},selectable:!0,select:function(r){var u=prompt(leantime.i18n.__("label.event_title"));u&&a.addEvent({title:u,start:r.start,end:r.end,allDay:r.allDay}),a.unselect()},events:e,eventColor:"#0866c6"});a.render()},n=function(){document.addEventListener("DOMContentLoaded",function(){Date.prototype.addDays=function(r){return this.setDate(this.getDate()+r),this};var e=leantime.dateHelper.getFormatFromSettings("dateformat","flatpickr"),t=document.querySelector("#event_date_from"),f=document.querySelector("#event_date_to"),s=flatpickr(t,{dateFormat:e,locale:{firstDayOfWeek:parseInt(leantime.i18n.__("language.firstDayOfWeek"),10)},allowInput:!0,onOpen:function(r,u,v){if(v.element.hasAttribute("readonly"))return v.close(),!1},onChange:function(r,u){r.length>0&&a.set("minDate",r[0]),f.value===""&&a.setDate(r[0],!0)}}),a=flatpickr(f,{dateFormat:e,locale:{firstDayOfWeek:parseInt(leantime.i18n.__("language.firstDayOfWeek"),10)},allowInput:!0,onChange:function(r){r.length>0&&s.set("maxDate",r[0])}})})},d=function(){var e={sizes:{minW:400,minH:350},resizable:!0,autoSizable:!0,callbacks:{afterShowCont:function(){jQuery(".formModal").nyroModal(e)},beforeClose:function(){location.reload()}},titleFromIframe:!0};jQuery(".exportModal").nyroModal(e)},c=function(e,t){let f=document.querySelector(e),s=leantime.dateHelper.getFormatFromSettings("dateformat","luxon"),a=leantime.dateHelper.getFormatFromSettings("timeformat","luxon");const r=new FullCalendar.Calendar(f,{timeZone:leantime.i18n.__("usersettings.timezone"),height:"calc(100% - 65px)",stickyHeaderDates:!0,initialView:t,eventStartEditable:!0,dayHeaderFormat:s,eventTimeFormat:a,slotLabelFormat:a,views:{multiMonthOneMonth:{type:"multiMonth",duration:{months:1},multiMonthTitleFormat:{month:"long",year:"numeric"},dayHeaderFormat:{weekday:"short"}},timeGridDay:{dayHeaders:!1},listWeek:{listDayFormat:{weekday:"long"},listDaySideFormat:leantime.dateHelper.getFormatFromSettings("dateformat","luxon")}},droppable:!0,eventSources,editable:!0,headerToolbar:!1,nowIndicator:!0,eventDrop:function(i){i.event.extendedProps.enitityType=="ticket"?fetch(leantime.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:i.event.extendedProps.enitityId,editFrom:luxon.DateTime.fromJSDate(i.event.start).toFormat(s),timeFrom:luxon.DateTime.fromJSDate(i.event.start).toFormat(a),editTo:luxon.DateTime.fromJSDate(i.event.end).toFormat(s),timeTo:luxon.DateTime.fromJSDate(i.event.end).toFormat(a)})}):i.event.extendedProps.enitityType=="event"&&fetch(leantime.appUrl+"/api/calendar",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:i.event.extendedProps.enitityId,dateFrom:i.event.startStr,dateTo:i.event.endStr})})},eventResize:function(i){i.event.extendedProps.enitityType=="ticket"?fetch(leantime.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:i.event.extendedProps.enitityId,editFrom:luxon.DateTime.fromJSDate(i.event.start).toFormat(s),timeFrom:luxon.DateTime.fromJSDate(i.event.start).toFormat(a),editTo:luxon.DateTime.fromJSDate(i.event.end).toFormat(s),timeTo:luxon.DateTime.fromJSDate(i.event.end).toFormat(a)})}):i.event.extendedProps.enitityType=="event"&&fetch(leantime.appUrl+"/api/calendar",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:i.event.extendedProps.enitityId,dateFrom:i.event.startStr,dateTo:i.event.endStr})})},eventReceive:function(i){fetch(leantime.appUrl+"/api/tickets",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({id:i.event.id,editFrom:luxon.DateTime.fromJSDate(i.event.start).toFormat(s),timeFrom:luxon.DateTime.fromJSDate(i.event.start).toFormat(a),editTo:luxon.DateTime.fromJSDate(i.event.end).toFormat(s),timeTo:luxon.DateTime.fromJSDate(i.event.end).toFormat(a)})})},eventDragStart:function(i){},eventDidMount:function(i){i.isDraggable===!1&&i.el.classList.add("locked"),i.event.extendedProps.location!=null&&i.event.extendedProps.location!=""&&i.event.extendedProps.location.indexOf("http")==0&&(i.el.setAttribute("href",i.event.extendedProps.location),i.el.setAttribute("target","_blank"))}});document.addEventListener("DOMContentLoaded",function(){var i=document.querySelector("#yourToDoContainer");i&&u(i),v(),r.scrollToTime(Date.now())});function u(i){var g=i;g&&new FullCalendar.ThirdPartyDraggable(g,{itemSelector:".draggable-todo",mirrorClass:"dragging-mirror",eventDragMinDistance:10,mirrorSelector:function(o){return o.closest(".ticketBox")},eventData:function(o){let p=JSON.parse(o.dataset.event);return{id:p.id,title:p.title,color:p.color,enitityType:"ticket",duration:"01:00",url:p.url}}}),r.scrollToTime(Date.now())}function v(){r.setOption("locale",leantime.i18n.__("language.code")),r.render(),r.scrollToTime(Date.now());var i=document.querySelector(".minCalendar .fc-prev-button");i&&i.addEventListener("click",function(){r.prev(),r.getCurrentData()});var g=document.querySelector(".minCalendar .fc-next-button");g&&g.addEventListener("click",function(){r.next()});var o=document.querySelector(".minCalendar .fc-today-button");o&&o.addEventListener("click",function(){r.today()}),document.querySelectorAll(".minCalendar .calendarViewSelect").forEach(function(p){p.addEventListener("click",function(h){console.log(this.dataset.value),r.changeView(this.dataset.value),fetch(leantime.appUrl+"/api/submenu",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams({submenu:"dashboardCalendarView",state:this.dataset.value})})})}),document.querySelectorAll(".day-button").forEach(function(p){p.addEventListener("click",function(){var h=this.dataset.date;r.gotoDate(h),document.querySelectorAll(".day-button").forEach(function(E){E.classList.remove("active")}),this.classList.add("active")})})}htmx.onLoad(function(i){return i.id=="yourToDoContainer"&&u(i),f})};return{initCalendar:l,initEventDatepickers:n,initExportModal:d,initWidgetCalendar:c}}();
